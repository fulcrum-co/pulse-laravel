import{a as Cr,g as ya,R as Er,b as wa,r as j,j as u,c as ba}from"./client-HjWmCGNu.js";function se(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=se(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var va={value:()=>{}};function Kt(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Dt(n)}function Dt(e){this._=e}function Na(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Dt.prototype=Kt.prototype={constructor:Dt,on:function(e,t){var n=this._,o=Na(e+"",n),r,s=-1,i=o.length;if(arguments.length<2){for(;++s<i;)if((r=(e=o[s]).type)&&(r=_a(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<i;)if(r=(e=o[s]).type)n[r]=go(n[r],e.name,t);else if(t==null)for(r in n)n[r]=go(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Dt(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,s;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],o=0,r=s.length;o<r;++o)s[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,s=o.length;r<s;++r)o[r].value.apply(t,n)}};function _a(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function go(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=va,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Sn="http://www.w3.org/1999/xhtml";const po={svg:"http://www.w3.org/2000/svg",xhtml:Sn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),po.hasOwnProperty(t)?{space:po[t],local:e}:e}function Ca(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Sn&&t.documentElement.namespaceURI===Sn?t.createElement(e):t.createElementNS(n,e)}}function Ea(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Sr(e){var t=Qt(e);return(t.local?Ea:Ca)(t)}function Sa(){}function On(e){return e==null?Sa:function(){return this.querySelector(e)}}function ka(e){typeof e!="function"&&(e=On(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=new Array(i),c,l,d=0;d<i;++d)(c=s[d])&&(l=e.call(c,c.__data__,d,s))&&("__data__"in c&&(l.__data__=c.__data__),a[d]=l);return new ue(o,this._parents)}function ja(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ma(){return[]}function kr(e){return e==null?Ma:function(){return this.querySelectorAll(e)}}function Ia(e){return function(){return ja(e.apply(this,arguments))}}function Aa(e){typeof e=="function"?e=Ia(e):e=kr(e);for(var t=this._groups,n=t.length,o=[],r=[],s=0;s<n;++s)for(var i=t[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&(o.push(e.call(c,c.__data__,l,i)),r.push(c));return new ue(o,r)}function jr(e){return function(){return this.matches(e)}}function Mr(e){return function(t){return t.matches(e)}}var $a=Array.prototype.find;function Ta(e){return function(){return $a.call(this.children,e)}}function Pa(){return this.firstElementChild}function Da(e){return this.select(e==null?Pa:Ta(typeof e=="function"?e:Mr(e)))}var La=Array.prototype.filter;function za(){return Array.from(this.children)}function Ha(e){return function(){return La.call(this.children,e)}}function Ra(e){return this.selectAll(e==null?za:Ha(typeof e=="function"?e:Mr(e)))}function Ba(e){typeof e!="function"&&(e=jr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new ue(o,this._parents)}function Ir(e){return new Array(e.length)}function Oa(){return new ue(this._enter||this._groups.map(Ir),this._parents)}function Bt(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Bt.prototype={constructor:Bt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Va(e){return function(){return e}}function Fa(e,t,n,o,r,s){for(var i=0,a,c=t.length,l=s.length;i<l;++i)(a=t[i])?(a.__data__=s[i],o[i]=a):n[i]=new Bt(e,s[i]);for(;i<c;++i)(a=t[i])&&(r[i]=a)}function Wa(e,t,n,o,r,s,i){var a,c,l=new Map,d=t.length,f=s.length,h=new Array(d),p;for(a=0;a<d;++a)(c=t[a])&&(h[a]=p=i.call(c,c.__data__,a,t)+"",l.has(p)?r[a]=c:l.set(p,c));for(a=0;a<f;++a)p=i.call(e,s[a],a,s)+"",(c=l.get(p))?(o[a]=c,c.__data__=s[a],l.delete(p)):n[a]=new Bt(e,s[a]);for(a=0;a<d;++a)(c=t[a])&&l.get(h[a])===c&&(r[a]=c)}function Ya(e){return e.__data__}function Xa(e,t){if(!arguments.length)return Array.from(this,Ya);var n=t?Wa:Fa,o=this._parents,r=this._groups;typeof e!="function"&&(e=Va(e));for(var s=r.length,i=new Array(s),a=new Array(s),c=new Array(s),l=0;l<s;++l){var d=o[l],f=r[l],h=f.length,p=Za(e.call(d,d&&d.__data__,l,o)),m=p.length,b=a[l]=new Array(m),v=i[l]=new Array(m),x=c[l]=new Array(h);n(d,f,b,v,x,p,t);for(var w=0,g=0,y,E;w<m;++w)if(y=b[w]){for(w>=g&&(g=w+1);!(E=v[g])&&++g<m;);y._next=E||null}}return i=new ue(i,o),i._enter=a,i._exit=c,i}function Za(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function qa(){return new ue(this._exit||this._groups.map(Ir),this._parents)}function Ua(e,t,n){var o=this.enter(),r=this,s=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?s.remove():n(s),o&&r?o.merge(r).order():r}function Ga(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,s=o.length,i=Math.min(r,s),a=new Array(r),c=0;c<i;++c)for(var l=n[c],d=o[c],f=l.length,h=a[c]=new Array(f),p,m=0;m<f;++m)(p=l[m]||d[m])&&(h[m]=p);for(;c<r;++c)a[c]=n[c];return new ue(a,this._parents)}function Ka(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,s=o[r],i;--r>=0;)(i=o[r])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Qa(e){e||(e=Ja);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var n=this._groups,o=n.length,r=new Array(o),s=0;s<o;++s){for(var i=n[s],a=i.length,c=r[s]=new Array(a),l,d=0;d<a;++d)(l=i[d])&&(c[d]=l);c.sort(t)}return new ue(r,this._parents).order()}function Ja(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ec(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function tc(){return Array.from(this)}function nc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,s=o.length;r<s;++r){var i=o[r];if(i)return i}return null}function oc(){let e=0;for(const t of this)++e;return e}function rc(){return!this.node()}function sc(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],s=0,i=r.length,a;s<i;++s)(a=r[s])&&e.call(a,a.__data__,s,r);return this}function ic(e){return function(){this.removeAttribute(e)}}function ac(e){return function(){this.removeAttributeNS(e.space,e.local)}}function cc(e,t){return function(){this.setAttribute(e,t)}}function lc(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function uc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function dc(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function fc(e,t){var n=Qt(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?ac:ic:typeof t=="function"?n.local?dc:uc:n.local?lc:cc)(n,t))}function Ar(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function hc(e){return function(){this.style.removeProperty(e)}}function gc(e,t,n){return function(){this.style.setProperty(e,t,n)}}function pc(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function mc(e,t,n){return arguments.length>1?this.each((t==null?hc:typeof t=="function"?pc:gc)(e,t,n??"")):Xe(this.node(),e)}function Xe(e,t){return e.style.getPropertyValue(t)||Ar(e).getComputedStyle(e,null).getPropertyValue(t)}function xc(e){return function(){delete this[e]}}function yc(e,t){return function(){this[e]=t}}function wc(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function bc(e,t){return arguments.length>1?this.each((t==null?xc:typeof t=="function"?wc:yc)(e,t)):this.node()[e]}function $r(e){return e.trim().split(/^|\s+/)}function Vn(e){return e.classList||new Tr(e)}function Tr(e){this._node=e,this._names=$r(e.getAttribute("class")||"")}Tr.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Pr(e,t){for(var n=Vn(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function Dr(e,t){for(var n=Vn(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function vc(e){return function(){Pr(this,e)}}function Nc(e){return function(){Dr(this,e)}}function _c(e,t){return function(){(t.apply(this,arguments)?Pr:Dr)(this,e)}}function Cc(e,t){var n=$r(e+"");if(arguments.length<2){for(var o=Vn(this.node()),r=-1,s=n.length;++r<s;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?_c:t?vc:Nc)(n,t))}function Ec(){this.textContent=""}function Sc(e){return function(){this.textContent=e}}function kc(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function jc(e){return arguments.length?this.each(e==null?Ec:(typeof e=="function"?kc:Sc)(e)):this.node().textContent}function Mc(){this.innerHTML=""}function Ic(e){return function(){this.innerHTML=e}}function Ac(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function $c(e){return arguments.length?this.each(e==null?Mc:(typeof e=="function"?Ac:Ic)(e)):this.node().innerHTML}function Tc(){this.nextSibling&&this.parentNode.appendChild(this)}function Pc(){return this.each(Tc)}function Dc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Lc(){return this.each(Dc)}function zc(e){var t=typeof e=="function"?e:Sr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Hc(){return null}function Rc(e,t){var n=typeof e=="function"?e:Sr(e),o=t==null?Hc:typeof t=="function"?t:On(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function Bc(){var e=this.parentNode;e&&e.removeChild(this)}function Oc(){return this.each(Bc)}function Vc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Fc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Wc(e){return this.select(e?Fc:Vc)}function Yc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Xc(e){return function(t){e.call(this,t,this.__data__)}}function Zc(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function qc(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,s;n<r;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++o]=s;++o?t.length=o:delete this.__on}}}function Uc(e,t,n){return function(){var o=this.__on,r,s=Xc(t);if(o){for(var i=0,a=o.length;i<a;++i)if((r=o[i]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=t;return}}this.addEventListener(e.type,s,n),r={type:e.type,name:e.name,value:t,listener:s,options:n},o?o.push(r):this.__on=[r]}}function Gc(e,t,n){var o=Zc(e+""),r,s=o.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,d;c<l;++c)for(r=0,d=a[c];r<s;++r)if((i=o[r]).type===d.type&&i.name===d.name)return d.value}return}for(a=t?Uc:qc,r=0;r<s;++r)this.each(a(o[r],t,n));return this}function Lr(e,t,n){var o=Ar(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Kc(e,t){return function(){return Lr(this,e,t)}}function Qc(e,t){return function(){return Lr(this,e,t.apply(this,arguments))}}function Jc(e,t){return this.each((typeof t=="function"?Qc:Kc)(e,t))}function*el(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,s=o.length,i;r<s;++r)(i=o[r])&&(yield i)}var zr=[null];function ue(e,t){this._groups=e,this._parents=t}function yt(){return new ue([[document.documentElement]],zr)}function tl(){return this}ue.prototype=yt.prototype={constructor:ue,select:ka,selectAll:Aa,selectChild:Da,selectChildren:Ra,filter:Ba,data:Xa,enter:Oa,exit:qa,join:Ua,merge:Ga,selection:tl,order:Ka,sort:Qa,call:ec,nodes:tc,node:nc,size:oc,empty:rc,each:sc,attr:fc,style:mc,property:bc,classed:Cc,text:jc,html:$c,raise:Pc,lower:Lc,append:zc,insert:Rc,remove:Oc,clone:Wc,datum:Yc,on:Gc,dispatch:Jc,[Symbol.iterator]:el};function le(e){return typeof e=="string"?new ue([[document.querySelector(e)]],[document.documentElement]):new ue([[e]],zr)}function nl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function de(e,t){if(e=nl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const ol={passive:!1},lt={capture:!0,passive:!1};function hn(e){e.stopImmediatePropagation()}function We(e){e.preventDefault(),e.stopImmediatePropagation()}function Hr(e){var t=e.document.documentElement,n=le(e).on("dragstart.drag",We,lt);"onselectstart"in t?n.on("selectstart.drag",We,lt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Rr(e,t){var n=e.document.documentElement,o=le(e).on("dragstart.drag",null);t&&(o.on("click.drag",We,lt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const St=e=>()=>e;function kn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:s,x:i,y:a,dx:c,dy:l,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:d}})}kn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function rl(e){return!e.ctrlKey&&!e.button}function sl(){return this.parentNode}function il(e,t){return t??{x:e.x,y:e.y}}function al(){return navigator.maxTouchPoints||"ontouchstart"in this}function Br(){var e=rl,t=sl,n=il,o=al,r={},s=Kt("start","drag","end"),i=0,a,c,l,d,f=0;function h(y){y.on("mousedown.drag",p).filter(o).on("touchstart.drag",v).on("touchmove.drag",x,ol).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(y,E){if(!(d||!e.call(this,y,E))){var _=g(this,t.call(this,y,E),y,E,"mouse");_&&(le(y.view).on("mousemove.drag",m,lt).on("mouseup.drag",b,lt),Hr(y.view),hn(y),l=!1,a=y.clientX,c=y.clientY,_("start",y))}}function m(y){if(We(y),!l){var E=y.clientX-a,_=y.clientY-c;l=E*E+_*_>f}r.mouse("drag",y)}function b(y){le(y.view).on("mousemove.drag mouseup.drag",null),Rr(y.view,l),We(y),r.mouse("end",y)}function v(y,E){if(e.call(this,y,E)){var _=y.changedTouches,k=t.call(this,y,E),P=_.length,T,B;for(T=0;T<P;++T)(B=g(this,k,y,E,_[T].identifier,_[T]))&&(hn(y),B("start",y,_[T]))}}function x(y){var E=y.changedTouches,_=E.length,k,P;for(k=0;k<_;++k)(P=r[E[k].identifier])&&(We(y),P("drag",y,E[k]))}function w(y){var E=y.changedTouches,_=E.length,k,P;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),k=0;k<_;++k)(P=r[E[k].identifier])&&(hn(y),P("end",y,E[k]))}function g(y,E,_,k,P,T){var B=s.copy(),A=de(T||_,E),L,D,N;if((N=n.call(y,new kn("beforestart",{sourceEvent:_,target:h,identifier:P,active:i,x:A[0],y:A[1],dx:0,dy:0,dispatch:B}),k))!=null)return L=N.x-A[0]||0,D=N.y-A[1]||0,function S(C,I,M){var $=A,z;switch(C){case"start":r[P]=S,z=i++;break;case"end":delete r[P],--i;case"drag":A=de(M||I,E),z=i;break}B.call(C,y,new kn(C,{sourceEvent:I,subject:N,target:h,identifier:P,active:z,x:A[0]+L,y:A[1]+D,dx:A[0]-$[0],dy:A[1]-$[1],dispatch:B}),k)}}return h.filter=function(y){return arguments.length?(e=typeof y=="function"?y:St(!!y),h):e},h.container=function(y){return arguments.length?(t=typeof y=="function"?y:St(y),h):t},h.subject=function(y){return arguments.length?(n=typeof y=="function"?y:St(y),h):n},h.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:St(!!y),h):o},h.on=function(){var y=s.on.apply(s,arguments);return y===s?h:y},h.clickDistance=function(y){return arguments.length?(f=(y=+y)*y,h):Math.sqrt(f)},h}function Fn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Or(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function wt(){}var ut=.7,Ot=1/ut,Ye="\\s*([+-]?\\d+)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",cl=/^#([0-9a-f]{3,8})$/,ll=new RegExp(`^rgb\\(${Ye},${Ye},${Ye}\\)$`),ul=new RegExp(`^rgb\\(${xe},${xe},${xe}\\)$`),dl=new RegExp(`^rgba\\(${Ye},${Ye},${Ye},${dt}\\)$`),fl=new RegExp(`^rgba\\(${xe},${xe},${xe},${dt}\\)$`),hl=new RegExp(`^hsl\\(${dt},${xe},${xe}\\)$`),gl=new RegExp(`^hsla\\(${dt},${xe},${xe},${dt}\\)$`),mo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Fn(wt,De,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:xo,formatHex:xo,formatHex8:pl,formatHsl:ml,formatRgb:yo,toString:yo});function xo(){return this.rgb().formatHex()}function pl(){return this.rgb().formatHex8()}function ml(){return Vr(this).formatHsl()}function yo(){return this.rgb().formatRgb()}function De(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=cl.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?wo(t):n===3?new ae(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?kt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?kt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ll.exec(e))?new ae(t[1],t[2],t[3],1):(t=ul.exec(e))?new ae(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=dl.exec(e))?kt(t[1],t[2],t[3],t[4]):(t=fl.exec(e))?kt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=hl.exec(e))?No(t[1],t[2]/100,t[3]/100,1):(t=gl.exec(e))?No(t[1],t[2]/100,t[3]/100,t[4]):mo.hasOwnProperty(e)?wo(mo[e]):e==="transparent"?new ae(NaN,NaN,NaN,0):null}function wo(e){return new ae(e>>16&255,e>>8&255,e&255,1)}function kt(e,t,n,o){return o<=0&&(e=t=n=NaN),new ae(e,t,n,o)}function xl(e){return e instanceof wt||(e=De(e)),e?(e=e.rgb(),new ae(e.r,e.g,e.b,e.opacity)):new ae}function jn(e,t,n,o){return arguments.length===1?xl(e):new ae(e,t,n,o??1)}function ae(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}Fn(ae,jn,Or(wt,{brighter(e){return e=e==null?Ot:Math.pow(Ot,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ut:Math.pow(ut,e),new ae(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ae(Te(this.r),Te(this.g),Te(this.b),Vt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bo,formatHex:bo,formatHex8:yl,formatRgb:vo,toString:vo}));function bo(){return`#${$e(this.r)}${$e(this.g)}${$e(this.b)}`}function yl(){return`#${$e(this.r)}${$e(this.g)}${$e(this.b)}${$e((isNaN(this.opacity)?1:this.opacity)*255)}`}function vo(){const e=Vt(this.opacity);return`${e===1?"rgb(":"rgba("}${Te(this.r)}, ${Te(this.g)}, ${Te(this.b)}${e===1?")":`, ${e})`}`}function Vt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Te(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $e(e){return e=Te(e),(e<16?"0":"")+e.toString(16)}function No(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fe(e,t,n,o)}function Vr(e){if(e instanceof fe)return new fe(e.h,e.s,e.l,e.opacity);if(e instanceof wt||(e=De(e)),!e)return new fe;if(e instanceof fe)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),s=Math.max(t,n,o),i=NaN,a=s-r,c=(s+r)/2;return a?(t===s?i=(n-o)/a+(n<o)*6:n===s?i=(o-t)/a+2:i=(t-n)/a+4,a/=c<.5?s+r:2-s-r,i*=60):a=c>0&&c<1?0:i,new fe(i,a,c,e.opacity)}function wl(e,t,n,o){return arguments.length===1?Vr(e):new fe(e,t,n,o??1)}function fe(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}Fn(fe,wl,Or(wt,{brighter(e){return e=e==null?Ot:Math.pow(Ot,e),new fe(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ut:Math.pow(ut,e),new fe(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new ae(gn(e>=240?e-240:e+120,r,o),gn(e,r,o),gn(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new fe(_o(this.h),jt(this.s),jt(this.l),Vt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Vt(this.opacity);return`${e===1?"hsl(":"hsla("}${_o(this.h)}, ${jt(this.s)*100}%, ${jt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function _o(e){return e=(e||0)%360,e<0?e+360:e}function jt(e){return Math.max(0,Math.min(1,e||0))}function gn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Wn=e=>()=>e;function bl(e,t){return function(n){return e+n*t}}function vl(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function Nl(e){return(e=+e)==1?Fr:function(t,n){return n-t?vl(t,n,e):Wn(isNaN(t)?n:t)}}function Fr(e,t){var n=t-e;return n?bl(e,n):Wn(isNaN(e)?t:e)}const Ft=(function e(t){var n=Nl(t);function o(r,s){var i=n((r=jn(r)).r,(s=jn(s)).r),a=n(r.g,s.g),c=n(r.b,s.b),l=Fr(r.opacity,s.opacity);return function(d){return r.r=i(d),r.g=a(d),r.b=c(d),r.opacity=l(d),r+""}}return o.gamma=e,o})(1);function _l(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),r;return function(s){for(r=0;r<n;++r)o[r]=e[r]*(1-s)+t[r]*s;return o}}function Cl(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function El(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,r=new Array(o),s=new Array(n),i;for(i=0;i<o;++i)r[i]=at(e[i],t[i]);for(;i<n;++i)s[i]=t[i];return function(a){for(i=0;i<o;++i)s[i]=r[i](a);return s}}function Sl(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function me(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function kl(e,t){var n={},o={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=at(e[r],t[r]):o[r]=t[r];return function(s){for(r in n)o[r]=n[r](s);return o}}var Mn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pn=new RegExp(Mn.source,"g");function jl(e){return function(){return e}}function Ml(e){return function(t){return e(t)+""}}function Wr(e,t){var n=Mn.lastIndex=pn.lastIndex=0,o,r,s,i=-1,a=[],c=[];for(e=e+"",t=t+"";(o=Mn.exec(e))&&(r=pn.exec(t));)(s=r.index)>n&&(s=t.slice(n,s),a[i]?a[i]+=s:a[++i]=s),(o=o[0])===(r=r[0])?a[i]?a[i]+=r:a[++i]=r:(a[++i]=null,c.push({i,x:me(o,r)})),n=pn.lastIndex;return n<t.length&&(s=t.slice(n),a[i]?a[i]+=s:a[++i]=s),a.length<2?c[0]?Ml(c[0].x):jl(t):(t=c.length,function(l){for(var d=0,f;d<t;++d)a[(f=c[d]).i]=f.x(l);return a.join("")})}function at(e,t){var n=typeof t,o;return t==null||n==="boolean"?Wn(t):(n==="number"?me:n==="string"?(o=De(t))?(t=o,Ft):Wr:t instanceof De?Ft:t instanceof Date?Sl:Cl(t)?_l:Array.isArray(t)?El:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?kl:me)(e,t)}var Co=180/Math.PI,In={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Yr(e,t,n,o,r,s){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*o)&&(n-=e*c,o-=t*c),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,c/=a),e*o<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:r,translateY:s,rotate:Math.atan2(t,e)*Co,skewX:Math.atan(c)*Co,scaleX:i,scaleY:a}}var Mt;function Il(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?In:Yr(t.a,t.b,t.c,t.d,t.e,t.f)}function Al(e){return e==null||(Mt||(Mt=document.createElementNS("http://www.w3.org/2000/svg","g")),Mt.setAttribute("transform",e),!(e=Mt.transform.baseVal.consolidate()))?In:(e=e.matrix,Yr(e.a,e.b,e.c,e.d,e.e,e.f))}function Xr(e,t,n,o){function r(l){return l.length?l.pop()+" ":""}function s(l,d,f,h,p,m){if(l!==f||d!==h){var b=p.push("translate(",null,t,null,n);m.push({i:b-4,x:me(l,f)},{i:b-2,x:me(d,h)})}else(f||h)&&p.push("translate("+f+t+h+n)}function i(l,d,f,h){l!==d?(l-d>180?d+=360:d-l>180&&(l+=360),h.push({i:f.push(r(f)+"rotate(",null,o)-2,x:me(l,d)})):d&&f.push(r(f)+"rotate("+d+o)}function a(l,d,f,h){l!==d?h.push({i:f.push(r(f)+"skewX(",null,o)-2,x:me(l,d)}):d&&f.push(r(f)+"skewX("+d+o)}function c(l,d,f,h,p,m){if(l!==f||d!==h){var b=p.push(r(p)+"scale(",null,",",null,")");m.push({i:b-4,x:me(l,f)},{i:b-2,x:me(d,h)})}else(f!==1||h!==1)&&p.push(r(p)+"scale("+f+","+h+")")}return function(l,d){var f=[],h=[];return l=e(l),d=e(d),s(l.translateX,l.translateY,d.translateX,d.translateY,f,h),i(l.rotate,d.rotate,f,h),a(l.skewX,d.skewX,f,h),c(l.scaleX,l.scaleY,d.scaleX,d.scaleY,f,h),l=d=null,function(p){for(var m=-1,b=h.length,v;++m<b;)f[(v=h[m]).i]=v.x(p);return f.join("")}}}var $l=Xr(Il,"px, ","px)","deg)"),Tl=Xr(Al,", ",")",")"),Pl=1e-12;function Eo(e){return((e=Math.exp(e))+1/e)/2}function Dl(e){return((e=Math.exp(e))-1/e)/2}function Ll(e){return((e=Math.exp(2*e))-1)/(e+1)}const Lt=(function e(t,n,o){function r(s,i){var a=s[0],c=s[1],l=s[2],d=i[0],f=i[1],h=i[2],p=d-a,m=f-c,b=p*p+m*m,v,x;if(b<Pl)x=Math.log(h/l)/t,v=function(k){return[a+k*p,c+k*m,l*Math.exp(t*k*x)]};else{var w=Math.sqrt(b),g=(h*h-l*l+o*b)/(2*l*n*w),y=(h*h-l*l-o*b)/(2*h*n*w),E=Math.log(Math.sqrt(g*g+1)-g),_=Math.log(Math.sqrt(y*y+1)-y);x=(_-E)/t,v=function(k){var P=k*x,T=Eo(E),B=l/(n*w)*(T*Ll(t*P+E)-Dl(E));return[a+B*p,c+B*m,l*T/Eo(t*P+E)]}}return v.duration=x*1e3*t/Math.SQRT2,v}return r.rho=function(s){var i=Math.max(.001,+s),a=i*i,c=a*a;return e(i,a,c)},r})(Math.SQRT2,2,4);var Ze=0,st=0,ot=0,Zr=1e3,Wt,it,Yt=0,Le=0,Jt=0,ft=typeof performance=="object"&&performance.now?performance:Date,qr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Yn(){return Le||(qr(zl),Le=ft.now()+Jt)}function zl(){Le=0}function Xt(){this._call=this._time=this._next=null}Xt.prototype=Ur.prototype={constructor:Xt,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Yn():+n)+(t==null?0:+t),!this._next&&it!==this&&(it?it._next=this:Wt=this,it=this),this._call=e,this._time=n,An()},stop:function(){this._call&&(this._call=null,this._time=1/0,An())}};function Ur(e,t,n){var o=new Xt;return o.restart(e,t,n),o}function Hl(){Yn(),++Ze;for(var e=Wt,t;e;)(t=Le-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ze}function So(){Le=(Yt=ft.now())+Jt,Ze=st=0;try{Hl()}finally{Ze=0,Bl(),Le=0}}function Rl(){var e=ft.now(),t=e-Yt;t>Zr&&(Jt-=t,Yt=e)}function Bl(){for(var e,t=Wt,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Wt=n);it=e,An(o)}function An(e){if(!Ze){st&&(st=clearTimeout(st));var t=e-Le;t>24?(e<1/0&&(st=setTimeout(So,e-ft.now()-Jt)),ot&&(ot=clearInterval(ot))):(ot||(Yt=ft.now(),ot=setInterval(Rl,Zr)),Ze=1,qr(So))}}function ko(e,t,n){var o=new Xt;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var Ol=Kt("start","end","cancel","interrupt"),Vl=[],Gr=0,jo=1,$n=2,zt=3,Mo=4,Tn=5,Ht=6;function en(e,t,n,o,r,s){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;Fl(e,n,{name:t,index:o,group:r,on:Ol,tween:Vl,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Gr})}function Xn(e,t){var n=pe(e,t);if(n.state>Gr)throw new Error("too late; already scheduled");return n}function we(e,t){var n=pe(e,t);if(n.state>zt)throw new Error("too late; already running");return n}function pe(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Fl(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=Ur(s,0,n.time);function s(l){n.state=jo,n.timer.restart(i,n.delay,n.time),n.delay<=l&&i(l-n.delay)}function i(l){var d,f,h,p;if(n.state!==jo)return c();for(d in o)if(p=o[d],p.name===n.name){if(p.state===zt)return ko(i);p.state===Mo?(p.state=Ht,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete o[d]):+d<t&&(p.state=Ht,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete o[d])}if(ko(function(){n.state===zt&&(n.state=Mo,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=$n,n.on.call("start",e,e.__data__,n.index,n.group),n.state===$n){for(n.state=zt,r=new Array(h=n.tween.length),d=0,f=-1;d<h;++d)(p=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(r[++f]=p);r.length=f+1}}function a(l){for(var d=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Tn,1),f=-1,h=r.length;++f<h;)r[f].call(e,d);n.state===Tn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Ht,n.timer.stop(),delete o[t];for(var l in o)return;delete e.__transition}}function Rt(e,t){var n=e.__transition,o,r,s=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((o=n[i]).name!==t){s=!1;continue}r=o.state>$n&&o.state<Tn,o.state=Ht,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[i]}s&&delete e.__transition}}function Wl(e){return this.each(function(){Rt(this,e)})}function Yl(e,t){var n,o;return function(){var r=we(this,e),s=r.tween;if(s!==n){o=n=s;for(var i=0,a=o.length;i<a;++i)if(o[i].name===t){o=o.slice(),o.splice(i,1);break}}r.tween=o}}function Xl(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var s=we(this,e),i=s.tween;if(i!==o){r=(o=i).slice();for(var a={name:t,value:n},c=0,l=r.length;c<l;++c)if(r[c].name===t){r[c]=a;break}c===l&&r.push(a)}s.tween=r}}function Zl(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=pe(this.node(),n).tween,r=0,s=o.length,i;r<s;++r)if((i=o[r]).name===e)return i.value;return null}return this.each((t==null?Yl:Xl)(n,e,t))}function Zn(e,t,n){var o=e._id;return e.each(function(){var r=we(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return pe(r,o).value[t]}}function Kr(e,t){var n;return(typeof t=="number"?me:t instanceof De?Ft:(n=De(t))?(t=n,Ft):Wr)(e,t)}function ql(e){return function(){this.removeAttribute(e)}}function Ul(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Gl(e,t,n){var o,r=n+"",s;return function(){var i=this.getAttribute(e);return i===r?null:i===o?s:s=t(o=i,n)}}function Kl(e,t,n){var o,r=n+"",s;return function(){var i=this.getAttributeNS(e.space,e.local);return i===r?null:i===o?s:s=t(o=i,n)}}function Ql(e,t,n){var o,r,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===o&&c===r?s:(r=c,s=t(o=i,a)))}}function Jl(e,t,n){var o,r,s;return function(){var i,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===o&&c===r?s:(r=c,s=t(o=i,a)))}}function eu(e,t){var n=Qt(e),o=n==="transform"?Tl:Kr;return this.attrTween(e,typeof t=="function"?(n.local?Jl:Ql)(n,o,Zn(this,"attr."+e,t)):t==null?(n.local?Ul:ql)(n):(n.local?Kl:Gl)(n,o,t))}function tu(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function nu(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ou(e,t){var n,o;function r(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&nu(e,s)),n}return r._value=t,r}function ru(e,t){var n,o;function r(){var s=t.apply(this,arguments);return s!==o&&(n=(o=s)&&tu(e,s)),n}return r._value=t,r}function su(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=Qt(e);return this.tween(n,(o.local?ou:ru)(o,t))}function iu(e,t){return function(){Xn(this,e).delay=+t.apply(this,arguments)}}function au(e,t){return t=+t,function(){Xn(this,e).delay=t}}function cu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?iu:au)(t,e)):pe(this.node(),t).delay}function lu(e,t){return function(){we(this,e).duration=+t.apply(this,arguments)}}function uu(e,t){return t=+t,function(){we(this,e).duration=t}}function du(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?lu:uu)(t,e)):pe(this.node(),t).duration}function fu(e,t){if(typeof t!="function")throw new Error;return function(){we(this,e).ease=t}}function hu(e){var t=this._id;return arguments.length?this.each(fu(t,e)):pe(this.node(),t).ease}function gu(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;we(this,e).ease=n}}function pu(e){if(typeof e!="function")throw new Error;return this.each(gu(this._id,e))}function mu(e){typeof e!="function"&&(e=jr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var s=t[r],i=s.length,a=o[r]=[],c,l=0;l<i;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new Ce(o,this._parents,this._name,this._id)}function xu(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,s=Math.min(o,r),i=new Array(o),a=0;a<s;++a)for(var c=t[a],l=n[a],d=c.length,f=i[a]=new Array(d),h,p=0;p<d;++p)(h=c[p]||l[p])&&(f[p]=h);for(;a<o;++a)i[a]=t[a];return new Ce(i,this._parents,this._name,this._id)}function yu(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function wu(e,t,n){var o,r,s=yu(t)?Xn:we;return function(){var i=s(this,e),a=i.on;a!==o&&(r=(o=a).copy()).on(t,n),i.on=r}}function bu(e,t){var n=this._id;return arguments.length<2?pe(this.node(),n).on.on(e):this.each(wu(n,e,t))}function vu(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Nu(){return this.on("end.remove",vu(this._id))}function _u(e){var t=this._name,n=this._id;typeof e!="function"&&(e=On(e));for(var o=this._groups,r=o.length,s=new Array(r),i=0;i<r;++i)for(var a=o[i],c=a.length,l=s[i]=new Array(c),d,f,h=0;h<c;++h)(d=a[h])&&(f=e.call(d,d.__data__,h,a))&&("__data__"in d&&(f.__data__=d.__data__),l[h]=f,en(l[h],t,n,h,l,pe(d,n)));return new Ce(s,this._parents,t,n)}function Cu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=kr(e));for(var o=this._groups,r=o.length,s=[],i=[],a=0;a<r;++a)for(var c=o[a],l=c.length,d,f=0;f<l;++f)if(d=c[f]){for(var h=e.call(d,d.__data__,f,c),p,m=pe(d,n),b=0,v=h.length;b<v;++b)(p=h[b])&&en(p,t,n,b,h,m);s.push(h),i.push(d)}return new Ce(s,i,t,n)}var Eu=yt.prototype.constructor;function Su(){return new Eu(this._groups,this._parents)}function ku(e,t){var n,o,r;return function(){var s=Xe(this,e),i=(this.style.removeProperty(e),Xe(this,e));return s===i?null:s===n&&i===o?r:r=t(n=s,o=i)}}function Qr(e){return function(){this.style.removeProperty(e)}}function ju(e,t,n){var o,r=n+"",s;return function(){var i=Xe(this,e);return i===r?null:i===o?s:s=t(o=i,n)}}function Mu(e,t,n){var o,r,s;return function(){var i=Xe(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Xe(this,e))),i===c?null:i===o&&c===r?s:(r=c,s=t(o=i,a))}}function Iu(e,t){var n,o,r,s="style."+t,i="end."+s,a;return function(){var c=we(this,e),l=c.on,d=c.value[s]==null?a||(a=Qr(t)):void 0;(l!==n||r!==d)&&(o=(n=l).copy()).on(i,r=d),c.on=o}}function Au(e,t,n){var o=(e+="")=="transform"?$l:Kr;return t==null?this.styleTween(e,ku(e,o)).on("end.style."+e,Qr(e)):typeof t=="function"?this.styleTween(e,Mu(e,o,Zn(this,"style."+e,t))).each(Iu(this._id,e)):this.styleTween(e,ju(e,o,t),n).on("end.style."+e,null)}function $u(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function Tu(e,t,n){var o,r;function s(){var i=t.apply(this,arguments);return i!==r&&(o=(r=i)&&$u(e,i,n)),o}return s._value=t,s}function Pu(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,Tu(e,t,n??""))}function Du(e){return function(){this.textContent=e}}function Lu(e){return function(){var t=e(this);this.textContent=t??""}}function zu(e){return this.tween("text",typeof e=="function"?Lu(Zn(this,"text",e)):Du(e==null?"":e+""))}function Hu(e){return function(t){this.textContent=e.call(this,t)}}function Ru(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Hu(r)),t}return o._value=e,o}function Bu(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Ru(e))}function Ou(){for(var e=this._name,t=this._id,n=Jr(),o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,c,l=0;l<a;++l)if(c=i[l]){var d=pe(c,t);en(c,e,n,l,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ce(o,this._parents,e,n)}function Vu(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(s,i){var a={value:i},c={value:function(){--r===0&&s()}};n.each(function(){var l=we(this,o),d=l.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),r===0&&s()})}var Fu=0;function Ce(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function Jr(){return++Fu}var ve=yt.prototype;Ce.prototype={constructor:Ce,select:_u,selectAll:Cu,selectChild:ve.selectChild,selectChildren:ve.selectChildren,filter:mu,merge:xu,selection:Su,transition:Ou,call:ve.call,nodes:ve.nodes,node:ve.node,size:ve.size,empty:ve.empty,each:ve.each,on:bu,attr:eu,attrTween:su,style:Au,styleTween:Pu,text:zu,textTween:Bu,remove:Nu,tween:Zl,delay:cu,duration:du,ease:hu,easeVarying:pu,end:Vu,[Symbol.iterator]:ve[Symbol.iterator]};function Wu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Yu={time:null,delay:0,duration:250,ease:Wu};function Xu(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Zu(e){var t,n;e instanceof Ce?(t=e._id,e=e._name):(t=Jr(),(n=Yu).time=Yn(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,s=0;s<r;++s)for(var i=o[s],a=i.length,c,l=0;l<a;++l)(c=i[l])&&en(c,e,t,l,i,n||Xu(c,t));return new Ce(o,this._parents,e,t)}yt.prototype.interrupt=Wl;yt.prototype.transition=Zu;const It=e=>()=>e;function qu(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function Ne(e,t,n){this.k=e,this.x=t,this.y=n}Ne.prototype={constructor:Ne,scale:function(e){return e===1?this:new Ne(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ne(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tn=new Ne(1,0,0);es.prototype=Ne.prototype;function es(e){for(;!e.__zoom;)if(!(e=e.parentNode))return tn;return e.__zoom}function mn(e){e.stopImmediatePropagation()}function rt(e){e.preventDefault(),e.stopImmediatePropagation()}function Uu(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Gu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Io(){return this.__zoom||tn}function Ku(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Qu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ju(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function ts(){var e=Uu,t=Gu,n=Ju,o=Ku,r=Qu,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Lt,l=Kt("start","zoom","end"),d,f,h,p=500,m=150,b=0,v=10;function x(N){N.property("__zoom",Io).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",B).filter(r).on("touchstart.zoom",A).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(N,S,C,I){var M=N.selection?N.selection():N;M.property("__zoom",Io),N!==M?E(N,S,C,I):M.interrupt().each(function(){_(this,arguments).event(I).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},x.scaleBy=function(N,S,C,I){x.scaleTo(N,function(){var M=this.__zoom.k,$=typeof S=="function"?S.apply(this,arguments):S;return M*$},C,I)},x.scaleTo=function(N,S,C,I){x.transform(N,function(){var M=t.apply(this,arguments),$=this.__zoom,z=C==null?y(M):typeof C=="function"?C.apply(this,arguments):C,R=$.invert(z),H=typeof S=="function"?S.apply(this,arguments):S;return n(g(w($,H),z,R),M,i)},C,I)},x.translateBy=function(N,S,C,I){x.transform(N,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof C=="function"?C.apply(this,arguments):C),t.apply(this,arguments),i)},null,I)},x.translateTo=function(N,S,C,I,M){x.transform(N,function(){var $=t.apply(this,arguments),z=this.__zoom,R=I==null?y($):typeof I=="function"?I.apply(this,arguments):I;return n(tn.translate(R[0],R[1]).scale(z.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof C=="function"?-C.apply(this,arguments):-C),$,i)},I,M)};function w(N,S){return S=Math.max(s[0],Math.min(s[1],S)),S===N.k?N:new Ne(S,N.x,N.y)}function g(N,S,C){var I=S[0]-C[0]*N.k,M=S[1]-C[1]*N.k;return I===N.x&&M===N.y?N:new Ne(N.k,I,M)}function y(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function E(N,S,C,I){N.on("start.zoom",function(){_(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){_(this,arguments).event(I).end()}).tween("zoom",function(){var M=this,$=arguments,z=_(M,$).event(I),R=t.apply(M,$),H=C==null?y(R):typeof C=="function"?C.apply(M,$):C,V=Math.max(R[1][0]-R[0][0],R[1][1]-R[0][1]),F=M.__zoom,Z=typeof S=="function"?S.apply(M,$):S,G=c(F.invert(H).concat(V/F.k),Z.invert(H).concat(V/Z.k));return function(X){if(X===1)X=Z;else{var O=G(X),Y=V/O[2];X=new Ne(Y,H[0]-O[0]*Y,H[1]-O[1]*Y)}z.zoom(null,X)}})}function _(N,S,C){return!C&&N.__zooming||new k(N,S)}function k(N,S){this.that=N,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(N,S),this.taps=0}k.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,S){return this.mouse&&N!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var S=le(this.that).datum();l.call(N,this.that,new qu(N,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:l}),S)}};function P(N,...S){if(!e.apply(this,arguments))return;var C=_(this,S).event(N),I=this.__zoom,M=Math.max(s[0],Math.min(s[1],I.k*Math.pow(2,o.apply(this,arguments)))),$=de(N);if(C.wheel)(C.mouse[0][0]!==$[0]||C.mouse[0][1]!==$[1])&&(C.mouse[1]=I.invert(C.mouse[0]=$)),clearTimeout(C.wheel);else{if(I.k===M)return;C.mouse=[$,I.invert($)],Rt(this),C.start()}rt(N),C.wheel=setTimeout(z,m),C.zoom("mouse",n(g(w(I,M),C.mouse[0],C.mouse[1]),C.extent,i));function z(){C.wheel=null,C.end()}}function T(N,...S){if(h||!e.apply(this,arguments))return;var C=N.currentTarget,I=_(this,S,!0).event(N),M=le(N.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",V,!0),$=de(N,C),z=N.clientX,R=N.clientY;Hr(N.view),mn(N),I.mouse=[$,this.__zoom.invert($)],Rt(this),I.start();function H(F){if(rt(F),!I.moved){var Z=F.clientX-z,G=F.clientY-R;I.moved=Z*Z+G*G>b}I.event(F).zoom("mouse",n(g(I.that.__zoom,I.mouse[0]=de(F,C),I.mouse[1]),I.extent,i))}function V(F){M.on("mousemove.zoom mouseup.zoom",null),Rr(F.view,I.moved),rt(F),I.event(F).end()}}function B(N,...S){if(e.apply(this,arguments)){var C=this.__zoom,I=de(N.changedTouches?N.changedTouches[0]:N,this),M=C.invert(I),$=C.k*(N.shiftKey?.5:2),z=n(g(w(C,$),I,M),t.apply(this,S),i);rt(N),a>0?le(this).transition().duration(a).call(E,z,I,N):le(this).call(x.transform,z,I,N)}}function A(N,...S){if(e.apply(this,arguments)){var C=N.touches,I=C.length,M=_(this,S,N.changedTouches.length===I).event(N),$,z,R,H;for(mn(N),z=0;z<I;++z)R=C[z],H=de(R,this),H=[H,this.__zoom.invert(H),R.identifier],M.touch0?!M.touch1&&M.touch0[2]!==H[2]&&(M.touch1=H,M.taps=0):(M.touch0=H,$=!0,M.taps=1+!!d);d&&(d=clearTimeout(d)),$&&(M.taps<2&&(f=H[0],d=setTimeout(function(){d=null},p)),Rt(this),M.start())}}function L(N,...S){if(this.__zooming){var C=_(this,S).event(N),I=N.changedTouches,M=I.length,$,z,R,H;for(rt(N),$=0;$<M;++$)z=I[$],R=de(z,this),C.touch0&&C.touch0[2]===z.identifier?C.touch0[0]=R:C.touch1&&C.touch1[2]===z.identifier&&(C.touch1[0]=R);if(z=C.that.__zoom,C.touch1){var V=C.touch0[0],F=C.touch0[1],Z=C.touch1[0],G=C.touch1[1],X=(X=Z[0]-V[0])*X+(X=Z[1]-V[1])*X,O=(O=G[0]-F[0])*O+(O=G[1]-F[1])*O;z=w(z,Math.sqrt(X/O)),R=[(V[0]+Z[0])/2,(V[1]+Z[1])/2],H=[(F[0]+G[0])/2,(F[1]+G[1])/2]}else if(C.touch0)R=C.touch0[0],H=C.touch0[1];else return;C.zoom("touch",n(g(z,R,H),C.extent,i))}}function D(N,...S){if(this.__zooming){var C=_(this,S).event(N),I=N.changedTouches,M=I.length,$,z;for(mn(N),h&&clearTimeout(h),h=setTimeout(function(){h=null},p),$=0;$<M;++$)z=I[$],C.touch0&&C.touch0[2]===z.identifier?delete C.touch0:C.touch1&&C.touch1[2]===z.identifier&&delete C.touch1;if(C.touch1&&!C.touch0&&(C.touch0=C.touch1,delete C.touch1),C.touch0)C.touch0[1]=this.__zoom.invert(C.touch0[0]);else if(C.end(),C.taps===2&&(z=de(z,this),Math.hypot(f[0]-z[0],f[1]-z[1])<v)){var R=le(this).on("dblclick.zoom");R&&R.apply(this,arguments)}}}return x.wheelDelta=function(N){return arguments.length?(o=typeof N=="function"?N:It(+N),x):o},x.filter=function(N){return arguments.length?(e=typeof N=="function"?N:It(!!N),x):e},x.touchable=function(N){return arguments.length?(r=typeof N=="function"?N:It(!!N),x):r},x.extent=function(N){return arguments.length?(t=typeof N=="function"?N:It([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),x):t},x.scaleExtent=function(N){return arguments.length?(s[0]=+N[0],s[1]=+N[1],x):[s[0],s[1]]},x.translateExtent=function(N){return arguments.length?(i[0][0]=+N[0][0],i[1][0]=+N[1][0],i[0][1]=+N[0][1],i[1][1]=+N[1][1],x):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},x.constrain=function(N){return arguments.length?(n=N,x):n},x.duration=function(N){return arguments.length?(a=+N,x):a},x.interpolate=function(N){return arguments.length?(c=N,x):c},x.on=function(){var N=l.on.apply(l,arguments);return N===l?x:N},x.clickDistance=function(N){return arguments.length?(b=(N=+N)*N,x):Math.sqrt(b)},x.tapDistance=function(N){return arguments.length?(v=+N,x):v},x}const ye={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},ht=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ns=["Enter"," ","Escape"],os={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var qe;(function(e){e.Strict="strict",e.Loose="loose"})(qe||(qe={}));var Pe;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Pe||(Pe={}));var gt;(function(e){e.Partial="partial",e.Full="full"})(gt||(gt={}));const rs={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Me;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Me||(Me={}));var Zt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Zt||(Zt={}));var W;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(W||(W={}));const Ao={[W.Left]:W.Right,[W.Right]:W.Left,[W.Top]:W.Bottom,[W.Bottom]:W.Top};function ss(e){return e===null?null:e?"valid":"invalid"}const is=e=>"id"in e&&"source"in e&&"target"in e,ed=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),qn=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),bt=(e,t=[0,0])=>{const{width:n,height:o}=Ee(e),r=e.origin??t,s=n*r[0],i=o*r[1];return{x:e.position.x-s,y:e.position.y-i}},td=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const s=typeof r=="string";let i=!t.nodeLookup&&!s?r:void 0;t.nodeLookup&&(i=s?t.nodeLookup.get(r):qn(r)?r:t.nodeLookup.get(r.id));const a=i?qt(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return nn(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return on(n)},vt=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(r=>{(t.filter===void 0||t.filter(r))&&(n=nn(n,qt(r)),o=!0)}),o?on(n):{x:0,y:0,width:0,height:0}},Un=(e,t,[n,o,r]=[0,0,1],s=!1,i=!1)=>{const a={..._t(t,[n,o,r]),width:t.width/r,height:t.height/r},c=[];for(const l of e.values()){const{measured:d,selectable:f=!0,hidden:h=!1}=l;if(i&&!f||h)continue;const p=d.width??l.width??l.initialWidth??null,m=d.height??l.height??l.initialHeight??null,b=pt(a,Ge(l)),v=(p??0)*(m??0),x=s&&b>0;(!l.internals.handleBounds||x||b>=v||l.dragging)&&c.push(l)}return c},nd=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function od(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function rd({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:s},i){if(e.size===0)return Promise.resolve(!0);const a=od(e,i),c=vt(a),l=Gn(c,t,n,i?.minZoom??r,i?.maxZoom??s,i?.padding??.1);return await o.setViewport(l,{duration:i?.duration,ease:i?.ease,interpolate:i?.interpolate}),Promise.resolve(!0)}function as({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:s}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},d=i.origin??o;let f=i.extent||r;if(i.extent==="parent"&&!i.expandParent)if(!a)s?.("005",ye.error005());else{const p=a.measured.width,m=a.measured.height;p&&m&&(f=[[c,l],[c+p,l+m]])}else a&&Ke(i.extent)&&(f=[[i.extent[0][0]+c,i.extent[0][1]+l],[i.extent[1][0]+c,i.extent[1][1]+l]]);const h=Ke(f)?ze(t,f,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&s?.("015",ye.error015()),{position:{x:h.x-c+(i.measured.width??0)*d[0],y:h.y-l+(i.measured.height??0)*d[1]},positionAbsolute:h}}async function sd({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const s=new Set(e.map(h=>h.id)),i=[];for(const h of n){if(h.deletable===!1)continue;const p=s.has(h.id),m=!p&&h.parentId&&i.find(b=>b.id===h.parentId);(p||m)&&i.push(h)}const a=new Set(t.map(h=>h.id)),c=o.filter(h=>h.deletable!==!1),d=nd(i,c);for(const h of c)a.has(h.id)&&!d.find(m=>m.id===h.id)&&d.push(h);if(!r)return{edges:d,nodes:i};const f=await r({nodes:i,edges:d});return typeof f=="boolean"?f?{edges:d,nodes:i}:{edges:[],nodes:[]}:f}const Ue=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ze=(e={x:0,y:0},t,n)=>({x:Ue(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Ue(e.y,t[0][1],t[1][1]-(n?.height??0))});function cs(e,t,n){const{width:o,height:r}=Ee(n),{x:s,y:i}=n.internals.positionAbsolute;return ze(e,[[s,i],[s+o,i+r]],t)}const $o=(e,t,n)=>e<t?Ue(Math.abs(e-t),1,t)/t:e>n?-Ue(Math.abs(e-n),1,t)/t:0,ls=(e,t,n=15,o=40)=>{const r=$o(e.x,o,t.width-o)*n,s=$o(e.y,o,t.height-o)*n;return[r,s]},nn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Pn=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),on=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Ge=(e,t=[0,0])=>{const{x:n,y:o}=qn(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},qt=(e,t=[0,0])=>{const{x:n,y:o}=qn(e)?e.internals.positionAbsolute:bt(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},us=(e,t)=>on(nn(Pn(e),Pn(t))),pt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},To=e=>he(e.width)&&he(e.height)&&he(e.x)&&he(e.y),he=e=>!isNaN(e)&&isFinite(e),id=(e,t)=>{},Nt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),_t=({x:e,y:t},[n,o,r],s=!1,i=[1,1])=>{const a={x:(e-n)/r,y:(t-o)/r};return s?Nt(a,i):a},Ut=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function Be(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function ad(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Be(e,n),r=Be(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=Be(e.top??e.y??0,n),r=Be(e.bottom??e.y??0,n),s=Be(e.left??e.x??0,t),i=Be(e.right??e.x??0,t);return{top:o,right:i,bottom:r,left:s,x:s+i,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function cd(e,t,n,o,r,s){const{x:i,y:a}=Ut(e,[t,n,o]),{x:c,y:l}=Ut({x:e.x+e.width,y:e.y+e.height},[t,n,o]),d=r-c,f=s-l;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(d),bottom:Math.floor(f)}}const Gn=(e,t,n,o,r,s)=>{const i=ad(s,t,n),a=(t-i.x)/e.width,c=(n-i.y)/e.height,l=Math.min(a,c),d=Ue(l,o,r),f=e.x+e.width/2,h=e.y+e.height/2,p=t/2-f*d,m=n/2-h*d,b=cd(e,p,m,d,t,n),v={left:Math.min(b.left-i.left,0),top:Math.min(b.top-i.top,0),right:Math.min(b.right-i.right,0),bottom:Math.min(b.bottom-i.bottom,0)};return{x:p-v.left+v.right,y:m-v.top+v.bottom,zoom:d}},mt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function Ke(e){return e!=null&&e!=="parent"}function Ee(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function ds(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function fs(e,t={width:0,height:0},n,o,r){const s={...e},i=o.get(n);if(i){const a=i.origin||r;s.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],s.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return s}function Po(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function ld(){let e,t;return{promise:new Promise((o,r)=>{e=o,t=r}),resolve:e,reject:t}}function ud(e){return{...os,...e||{}}}function ct(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:s,y:i}=ge(e),a=_t({x:s-(r?.left??0),y:i-(r?.top??0)},o),{x:c,y:l}=n?Nt(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const Kn=e=>({width:e.offsetWidth,height:e.offsetHeight}),hs=e=>e?.getRootNode?.()||window?.document,dd=["INPUT","SELECT","TEXTAREA"];function gs(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:dd.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ps=e=>"clientX"in e,ge=(e,t)=>{const n=ps(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},Do=(e,t,n,o,r)=>{const s=t.querySelectorAll(`.${e}`);return!s||!s.length?null:Array.from(s).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:r,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Kn(i)}})};function ms({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:s,targetControlX:i,targetControlY:a}){const c=e*.125+r*.375+i*.375+n*.125,l=t*.125+s*.375+a*.375+o*.125,d=Math.abs(c-e),f=Math.abs(l-t);return[c,l,d,f]}function At(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Lo({pos:e,x1:t,y1:n,x2:o,y2:r,c:s}){switch(e){case W.Left:return[t-At(t-o,s),n];case W.Right:return[t+At(o-t,s),n];case W.Top:return[t,n-At(n-r,s)];case W.Bottom:return[t,n+At(r-n,s)]}}function xs({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:r,targetPosition:s=W.Top,curvature:i=.25}){const[a,c]=Lo({pos:n,x1:e,y1:t,x2:o,y2:r,c:i}),[l,d]=Lo({pos:s,x1:o,y1:r,x2:e,y2:t,c:i}),[f,h,p,m]=ms({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:d});return[`M${e},${t} C${a},${c} ${l},${d} ${o},${r}`,f,h,p,m]}function ys({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,s=n<e?n+r:n-r,i=Math.abs(o-t)/2,a=o<t?o+i:o-i;return[s,a,r,i]}function fd({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1,zIndexMode:s="basic"}){if(s==="manual")return o;const i=r&&n?o+1e3:o,a=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return i+a}function hd({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const s=nn(qt(e),qt(t));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return pt(i,on(s))>0}const gd=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,pd=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Dn=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||gd;let r;return is(e)?r={...e}:r={...e,id:o(e)},pd(r,t)?t:(r.sourceHandle===null&&delete r.sourceHandle,r.targetHandle===null&&delete r.targetHandle,t.concat(r))};function ws({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,s,i,a]=ys({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,s,i,a]}const zo={[W.Left]:{x:-1,y:0},[W.Right]:{x:1,y:0},[W.Top]:{x:0,y:-1},[W.Bottom]:{x:0,y:1}},md=({source:e,sourcePosition:t=W.Bottom,target:n})=>t===W.Left||t===W.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Ho=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function xd({source:e,sourcePosition:t=W.Bottom,target:n,targetPosition:o=W.Top,center:r,offset:s,stepPosition:i}){const a=zo[t],c=zo[o],l={x:e.x+a.x*s,y:e.y+a.y*s},d={x:n.x+c.x*s,y:n.y+c.y*s},f=md({source:l,sourcePosition:t,target:d}),h=f.x!==0?"x":"y",p=f[h];let m=[],b,v;const x={x:0,y:0},w={x:0,y:0},[,,g,y]=ys({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[h]*c[h]===-1){h==="x"?(b=r.x??l.x+(d.x-l.x)*i,v=r.y??(l.y+d.y)/2):(b=r.x??(l.x+d.x)/2,v=r.y??l.y+(d.y-l.y)*i);const _=[{x:b,y:l.y},{x:b,y:d.y}],k=[{x:l.x,y:v},{x:d.x,y:v}];a[h]===p?m=h==="x"?_:k:m=h==="x"?k:_}else{const _=[{x:l.x,y:d.y}],k=[{x:d.x,y:l.y}];if(h==="x"?m=a.x===p?k:_:m=a.y===p?_:k,t===o){const L=Math.abs(e[h]-n[h]);if(L<=s){const D=Math.min(s-1,s-L);a[h]===p?x[h]=(l[h]>e[h]?-1:1)*D:w[h]=(d[h]>n[h]?-1:1)*D}}if(t!==o){const L=h==="x"?"y":"x",D=a[h]===c[L],N=l[L]>d[L],S=l[L]<d[L];(a[h]===1&&(!D&&N||D&&S)||a[h]!==1&&(!D&&S||D&&N))&&(m=h==="x"?_:k)}const P={x:l.x+x.x,y:l.y+x.y},T={x:d.x+w.x,y:d.y+w.y},B=Math.max(Math.abs(P.x-m[0].x),Math.abs(T.x-m[0].x)),A=Math.max(Math.abs(P.y-m[0].y),Math.abs(T.y-m[0].y));B>=A?(b=(P.x+T.x)/2,v=m[0].y):(b=m[0].x,v=(P.y+T.y)/2)}return[[e,{x:l.x+x.x,y:l.y+x.y},...m,{x:d.x+w.x,y:d.y+w.y},n],b,v,g,y]}function yd(e,t,n,o){const r=Math.min(Ho(e,t)/2,Ho(t,n)/2,o),{x:s,y:i}=t;if(e.x===s&&s===n.x||e.y===i&&i===n.y)return`L${s} ${i}`;if(e.y===i){const l=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${s+r*l},${i}Q ${s},${i} ${s},${i+r*d}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${i+r*c}Q ${s},${i} ${s+r*a},${i}`}function Ln({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:r,targetPosition:s=W.Top,borderRadius:i=5,centerX:a,centerY:c,offset:l=20,stepPosition:d=.5}){const[f,h,p,m,b]=xd({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:s,center:{x:a,y:c},offset:l,stepPosition:d});return[f.reduce((x,w,g)=>{let y="";return g>0&&g<f.length-1?y=yd(f[g-1],w,f[g+1],i):y=`${g===0?"M":"L"}${w.x} ${w.y}`,x+=y,x},""),h,p,m,b]}function Ro(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function wd(e){const{sourceNode:t,targetNode:n}=e;if(!Ro(t)||!Ro(n))return null;const o=t.internals.handleBounds||Bo(t.handles),r=n.internals.handleBounds||Bo(n.handles),s=Oo(o?.source??[],e.sourceHandle),i=Oo(e.connectionMode===qe.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!s||!i)return e.onError?.("008",ye.error008(s?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=s?.position||W.Bottom,c=i?.position||W.Top,l=He(t,s,a),d=He(n,i,c);return{sourceX:l.x,sourceY:l.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:c}}function Bo(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function He(e,t,n=W.Left,o=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,s=(t?.y??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??Ee(e);if(o)return{x:r+i/2,y:s+a/2};switch(t?.position??n){case W.Top:return{x:r+i/2,y:s};case W.Right:return{x:r+i,y:s+a/2};case W.Bottom:return{x:r+i/2,y:s+a};case W.Left:return{x:r,y:s+a/2}}}function Oo(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function zn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function bd(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const s=new Set;return e.reduce((i,a)=>([a.markerStart||o,a.markerEnd||r].forEach(c=>{if(c&&typeof c=="object"){const l=zn(c,t);s.has(l)||(i.push({id:l,color:c.color||n,...c}),s.add(l))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const bs=1e3,vd=10,Qn={nodeOrigin:[0,0],nodeExtent:ht,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},Nd={...Qn,checkEquality:!0};function Jn(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function _d(e,t,n){const o=Jn(Qn,n);for(const r of e.values())if(r.parentId)to(r,e,t,o);else{const s=bt(r,o.nodeOrigin),i=Ke(r.extent)?r.extent:o.nodeExtent,a=ze(s,i,Ee(r));r.internals.positionAbsolute=a}}function Cd(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],o=[];for(const r of e.handles){const s={id:r.id,width:r.width??1,height:r.height??1,nodeId:e.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(s):r.type==="target"&&o.push(s)}return{source:n,target:o}}function eo(e){return e==="manual"}function Hn(e,t,n,o={}){const r=Jn(Nd,o),s={i:0},i=new Map(t),a=r?.elevateNodesOnSelect&&!eo(r.zIndexMode)?bs:0;let c=e.length>0;t.clear(),n.clear();for(const l of e){let d=i.get(l.id);if(r.checkEquality&&l===d?.internals.userNode)t.set(l.id,d);else{const f=bt(l,r.nodeOrigin),h=Ke(l.extent)?l.extent:r.nodeExtent,p=ze(f,h,Ee(l));d={...r.defaults,...l,measured:{width:l.measured?.width,height:l.measured?.height},internals:{positionAbsolute:p,handleBounds:Cd(l,d),z:vs(l,a,r.zIndexMode),userNode:l}},t.set(l.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(c=!1),l.parentId&&to(d,t,n,o,s)}return c}function Ed(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function to(e,t,n,o,r){const{elevateNodesOnSelect:s,nodeOrigin:i,nodeExtent:a,zIndexMode:c}=Jn(Qn,o),l=e.parentId,d=t.get(l);if(!d){console.warn(`Parent node ${l} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Ed(e,n),r&&!d.parentId&&d.internals.rootParentIndex===void 0&&c==="auto"&&(d.internals.rootParentIndex=++r.i,d.internals.z=d.internals.z+r.i*vd),r&&d.internals.rootParentIndex!==void 0&&(r.i=d.internals.rootParentIndex);const f=s&&!eo(c)?bs:0,{x:h,y:p,z:m}=Sd(e,d,i,a,f,c),{positionAbsolute:b}=e.internals,v=h!==b.x||p!==b.y;(v||m!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:v?{x:h,y:p}:b,z:m}})}function vs(e,t,n){const o=he(e.zIndex)?e.zIndex:0;return eo(n)?o:o+(e.selected?t:0)}function Sd(e,t,n,o,r,s){const{x:i,y:a}=t.internals.positionAbsolute,c=Ee(e),l=bt(e,n),d=Ke(e.extent)?ze(l,e.extent,c):l;let f=ze({x:i+d.x,y:a+d.y},o,c);e.extent==="parent"&&(f=cs(f,c,t));const h=vs(e,r,s),p=t.internals.z??0;return{x:f.x,y:f.y,z:p>=h?p+1:h}}function no(e,t,n,o=[0,0]){const r=[],s=new Map;for(const i of e){const a=t.get(i.parentId);if(!a)continue;const c=s.get(i.parentId)?.expandedRect??Ge(a),l=us(c,i.rect);s.set(i.parentId,{expandedRect:l,parent:a})}return s.size>0&&s.forEach(({expandedRect:i,parent:a},c)=>{const l=a.internals.positionAbsolute,d=Ee(a),f=a.origin??o,h=i.x<l.x?Math.round(Math.abs(l.x-i.x)):0,p=i.y<l.y?Math.round(Math.abs(l.y-i.y)):0,m=Math.max(d.width,Math.round(i.width)),b=Math.max(d.height,Math.round(i.height)),v=(m-d.width)*f[0],x=(b-d.height)*f[1];(h>0||p>0||v||x)&&(r.push({id:c,type:"position",position:{x:a.position.x-h+v,y:a.position.y-p+x}}),n.get(c)?.forEach(w=>{e.some(g=>g.id===w.id)||r.push({id:w.id,type:"position",position:{x:w.position.x+h,y:w.position.y+p}})})),(d.width<i.width||d.height<i.height||h||p)&&r.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?f[0]*h-v:0),height:b+(p?f[1]*p-x:0)}})}),r}function kd(e,t,n,o,r,s,i){const a=o?.querySelector(".xyflow__viewport");let c=!1;if(!a)return{changes:[],updatedInternals:c};const l=[],d=window.getComputedStyle(a),{m22:f}=new window.DOMMatrixReadOnly(d.transform),h=[];for(const p of e.values()){const m=t.get(p.id);if(!m)continue;if(m.hidden){t.set(m.id,{...m,internals:{...m.internals,handleBounds:void 0}}),c=!0;continue}const b=Kn(p.nodeElement),v=m.measured.width!==b.width||m.measured.height!==b.height;if(!!(b.width&&b.height&&(v||!m.internals.handleBounds||p.force))){const w=p.nodeElement.getBoundingClientRect(),g=Ke(m.extent)?m.extent:s;let{positionAbsolute:y}=m.internals;m.parentId&&m.extent==="parent"?y=cs(y,b,t.get(m.parentId)):g&&(y=ze(y,g,b));const E={...m,measured:b,internals:{...m.internals,positionAbsolute:y,handleBounds:{source:Do("source",p.nodeElement,w,f,m.id),target:Do("target",p.nodeElement,w,f,m.id)}}};t.set(m.id,E),m.parentId&&to(E,t,n,{nodeOrigin:r,zIndexMode:i}),c=!0,v&&(l.push({id:m.id,type:"dimensions",dimensions:b}),m.expandParent&&m.parentId&&h.push({id:m.id,parentId:m.parentId,rect:Ge(E,r)}))}}if(h.length>0){const p=no(h,t,n,r);l.push(...p)}return{changes:l,updatedInternals:c}}async function jd({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:s}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,s]],o),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function Vo(e,t,n,o,r,s){let i=r;const a=o.get(i)||new Map;o.set(i,a.set(n,t)),i=`${r}-${e}`;const c=o.get(i)||new Map;if(o.set(i,c.set(n,t)),s){i=`${r}-${e}-${s}`;const l=o.get(i)||new Map;o.set(i,l.set(n,t))}}function Ns(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:s,sourceHandle:i=null,targetHandle:a=null}=o,c={edgeId:o.id,source:r,target:s,sourceHandle:i,targetHandle:a},l=`${r}-${i}--${s}-${a}`,d=`${s}-${a}--${r}-${i}`;Vo("source",c,d,e,r,i),Vo("target",c,l,e,s,a),t.set(o.id,o)}}function _s(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:_s(n,t):!1}function Fo(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function Md(e,t,n,o){const r=new Map;for(const[s,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!_s(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(s);a&&r.set(s,{id:s,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function xn({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const r=[];for(const[i,a]of t){const c=n.get(i)?.internals.userNode;c&&r.push({...c,position:a.position,dragging:o})}if(!e)return[r[0],r];const s=n.get(e)?.internals.userNode;return[s?{...s,position:t.get(e)?.position||s.position,dragging:o}:r[0],r]}function Id({dragItems:e,snapGrid:t,x:n,y:o}){const r=e.values().next().value;if(!r)return null;const s={x:n-r.distance.x,y:o-r.distance.y},i=Nt(s,t);return{x:i.x-s.x,y:i.y-s.y}}function Ad({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let s={x:null,y:null},i=0,a=new Map,c=!1,l={x:0,y:0},d=null,f=!1,h=null,p=!1,m=!1,b=null;function v({noDragClassName:w,handleSelector:g,domNode:y,isSelectable:E,nodeId:_,nodeClickDistance:k=0}){h=le(y);function P({x:L,y:D}){const{nodeLookup:N,nodeExtent:S,snapGrid:C,snapToGrid:I,nodeOrigin:M,onNodeDrag:$,onSelectionDrag:z,onError:R,updateNodePositions:H}=t();s={x:L,y:D};let V=!1;const F=a.size>1,Z=F&&S?Pn(vt(a)):null,G=F&&I?Id({dragItems:a,snapGrid:C,x:L,y:D}):null;for(const[X,O]of a){if(!N.has(X))continue;let Y={x:L-O.distance.x,y:D-O.distance.y};I&&(Y=G?{x:Math.round(Y.x+G.x),y:Math.round(Y.y+G.y)}:Nt(Y,C));let Q=null;if(F&&S&&!O.extent&&Z){const{positionAbsolute:U}=O.internals,ee=U.x-Z.x+S[0][0],ne=U.x+O.measured.width-Z.x2+S[1][0],te=U.y-Z.y+S[0][1],ie=U.y+O.measured.height-Z.y2+S[1][1];Q=[[ee,te],[ne,ie]]}const{position:K,positionAbsolute:q}=as({nodeId:X,nextPosition:Y,nodeLookup:N,nodeExtent:Q||S,nodeOrigin:M,onError:R});V=V||O.position.x!==K.x||O.position.y!==K.y,O.position=K,O.internals.positionAbsolute=q}if(m=m||V,!!V&&(H(a,!0),b&&(o||$||!_&&z))){const[X,O]=xn({nodeId:_,dragItems:a,nodeLookup:N});o?.(b,a,X,O),$?.(b,X,O),_||z?.(b,O)}}async function T(){if(!d)return;const{transform:L,panBy:D,autoPanSpeed:N,autoPanOnNodeDrag:S}=t();if(!S){c=!1,cancelAnimationFrame(i);return}const[C,I]=ls(l,d,N);(C!==0||I!==0)&&(s.x=(s.x??0)-C/L[2],s.y=(s.y??0)-I/L[2],await D({x:C,y:I})&&P(s)),i=requestAnimationFrame(T)}function B(L){const{nodeLookup:D,multiSelectionActive:N,nodesDraggable:S,transform:C,snapGrid:I,snapToGrid:M,selectNodesOnDrag:$,onNodeDragStart:z,onSelectionDragStart:R,unselectNodesAndEdges:H}=t();f=!0,(!$||!E)&&!N&&_&&(D.get(_)?.selected||H()),E&&$&&_&&e?.(_);const V=ct(L.sourceEvent,{transform:C,snapGrid:I,snapToGrid:M,containerBounds:d});if(s=V,a=Md(D,S,V,_),a.size>0&&(n||z||!_&&R)){const[F,Z]=xn({nodeId:_,dragItems:a,nodeLookup:D});n?.(L.sourceEvent,a,F,Z),z?.(L.sourceEvent,F,Z),_||R?.(L.sourceEvent,Z)}}const A=Br().clickDistance(k).on("start",L=>{const{domNode:D,nodeDragThreshold:N,transform:S,snapGrid:C,snapToGrid:I}=t();d=D?.getBoundingClientRect()||null,p=!1,m=!1,b=L.sourceEvent,N===0&&B(L),s=ct(L.sourceEvent,{transform:S,snapGrid:C,snapToGrid:I,containerBounds:d}),l=ge(L.sourceEvent,d)}).on("drag",L=>{const{autoPanOnNodeDrag:D,transform:N,snapGrid:S,snapToGrid:C,nodeDragThreshold:I,nodeLookup:M}=t(),$=ct(L.sourceEvent,{transform:N,snapGrid:S,snapToGrid:C,containerBounds:d});if(b=L.sourceEvent,(L.sourceEvent.type==="touchmove"&&L.sourceEvent.touches.length>1||_&&!M.has(_))&&(p=!0),!p){if(!c&&D&&f&&(c=!0,T()),!f){const z=ge(L.sourceEvent,d),R=z.x-l.x,H=z.y-l.y;Math.sqrt(R*R+H*H)>I&&B(L)}(s.x!==$.xSnapped||s.y!==$.ySnapped)&&a&&f&&(l=ge(L.sourceEvent,d),P($))}}).on("end",L=>{if(!(!f||p)&&(c=!1,f=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:D,updateNodePositions:N,onNodeDragStop:S,onSelectionDragStop:C}=t();if(m&&(N(a,!1),m=!1),r||S||!_&&C){const[I,M]=xn({nodeId:_,dragItems:a,nodeLookup:D,dragging:!1});r?.(L.sourceEvent,a,I,M),S?.(L.sourceEvent,I,M),_||C?.(L.sourceEvent,M)}}}).filter(L=>{const D=L.target;return!L.button&&(!w||!Fo(D,`.${w}`,y))&&(!g||Fo(D,g,y))});h.call(A)}function x(){h?.on(".drag",null)}return{update:v,destroy:x}}function $d(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const s of t.values())pt(r,Ge(s))>0&&o.push(s);return o}const Td=250;function Pd(e,t,n,o){let r=[],s=1/0;const i=$d(e,n,t+Td);for(const a of i){const c=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(const l of c){if(o.nodeId===l.nodeId&&o.type===l.type&&o.id===l.id)continue;const{x:d,y:f}=He(a,l,l.position,!0),h=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(f-e.y,2));h>t||(h<s?(r=[{...l,x:d,y:f}],s=h):h===s&&r.push({...l,x:d,y:f}))}}if(!r.length)return null;if(r.length>1){const a=o.type==="source"?"target":"source";return r.find(c=>c.type===a)??r[0]}return r[0]}function Cs(e,t,n,o,r,s=!1){const i=o.get(e);if(!i)return null;const a=r==="strict"?i.internals.handleBounds?.[t]:[...i.internals.handleBounds?.source??[],...i.internals.handleBounds?.target??[]],c=(n?a?.find(l=>l.id===n):a?.[0])??null;return c&&s?{...c,...He(i,c,c.position,!0)}:c}function Es(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Dd(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Ss=()=>!0;function Ld(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:s,isTarget:i,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:d,flowId:f,panBy:h,cancelConnection:p,onConnectStart:m,onConnect:b,onConnectEnd:v,isValidConnection:x=Ss,onReconnectEnd:w,updateConnection:g,getTransform:y,getFromHandle:E,autoPanSpeed:_,dragThreshold:k=1,handleDomNode:P}){const T=hs(e.target);let B=0,A;const{x:L,y:D}=ge(e),N=Es(s,P),S=a?.getBoundingClientRect();let C=!1;if(!S||!N)return;const I=Cs(r,N,o,c,t);if(!I)return;let M=ge(e,S),$=!1,z=null,R=!1,H=null;function V(){if(!d||!S)return;const[K,q]=ls(M,S,_);h({x:K,y:q}),B=requestAnimationFrame(V)}const F={...I,nodeId:r,type:N,position:I.position},Z=c.get(r);let X={inProgress:!0,isValid:null,from:He(Z,F,W.Left,!0),fromHandle:F,fromPosition:F.position,fromNode:Z,to:M,toHandle:null,toPosition:Ao[F.position],toNode:null,pointer:M};function O(){C=!0,g(X),m?.(e,{nodeId:r,handleId:o,handleType:N})}k===0&&O();function Y(K){if(!C){const{x:ie,y:Se}=ge(K),be=ie-L,Ie=Se-D;if(!(be*be+Ie*Ie>k*k))return;O()}if(!E()||!F){Q(K);return}const q=y();M=ge(K,S),A=Pd(_t(M,q,!1,[1,1]),n,c,F),$||(V(),$=!0);const U=ks(K,{handle:A,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:i?"target":"source",isValidConnection:x,doc:T,lib:l,flowId:f,nodeLookup:c});H=U.handleDomNode,z=U.connection,R=Dd(!!A,U.isValid);const ee=c.get(r),ne=ee?He(ee,F,W.Left,!0):X.from,te={...X,from:ne,isValid:R,to:U.toHandle&&R?Ut({x:U.toHandle.x,y:U.toHandle.y},q):M,toHandle:U.toHandle,toPosition:R&&U.toHandle?U.toHandle.position:Ao[F.position],toNode:U.toHandle?c.get(U.toHandle.nodeId):null,pointer:M};g(te),X=te}function Q(K){if(!("touches"in K&&K.touches.length>0)){if(C){(A||H)&&z&&R&&b?.(z);const{inProgress:q,...U}=X,ee={...U,toPosition:X.toHandle?X.toPosition:null};v?.(K,ee),s&&w?.(K,ee)}p(),cancelAnimationFrame(B),$=!1,R=!1,z=null,H=null,T.removeEventListener("mousemove",Y),T.removeEventListener("mouseup",Q),T.removeEventListener("touchmove",Y),T.removeEventListener("touchend",Q)}}T.addEventListener("mousemove",Y),T.addEventListener("mouseup",Q),T.addEventListener("touchmove",Y),T.addEventListener("touchend",Q)}function ks(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:s,doc:i,lib:a,flowId:c,isValidConnection:l=Ss,nodeLookup:d}){const f=s==="target",h=t?i.querySelector(`.${a}-flow__handle[data-id="${c}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:m}=ge(e),b=i.elementFromPoint(p,m),v=b?.classList.contains(`${a}-flow__handle`)?b:h,x={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=Es(void 0,v),g=v.getAttribute("data-nodeid"),y=v.getAttribute("data-handleid"),E=v.classList.contains("connectable"),_=v.classList.contains("connectableend");if(!g||!w)return x;const k={source:f?g:o,sourceHandle:f?y:r,target:f?o:g,targetHandle:f?r:y};x.connection=k;const T=E&&_&&(n===qe.Strict?f&&w==="source"||!f&&w==="target":g!==o||y!==r);x.isValid=T&&l(k),x.toHandle=Cs(g,w,y,d,n,!0)}return x}const Rn={onPointerDown:Ld,isValid:ks};function zd({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=le(e);function s({translateExtent:a,width:c,height:l,zoomStep:d=1,pannable:f=!0,zoomable:h=!0,inversePan:p=!1}){const m=g=>{if(g.sourceEvent.type!=="wheel"||!t)return;const y=n(),E=g.sourceEvent.ctrlKey&&mt()?10:1,_=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*d,k=y[2]*Math.pow(2,_*E);t.scaleTo(k)};let b=[0,0];const v=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(b=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},x=g=>{const y=n();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const E=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],_=[E[0]-b[0],E[1]-b[1]];b=E;const k=o()*Math.max(y[2],Math.log(y[2]))*(p?-1:1),P={x:y[0]-_[0]*k,y:y[1]-_[1]*k},T=[[0,0],[c,l]];t.setViewportConstrained({x:P.x,y:P.y,zoom:y[2]},T,a)},w=ts().on("start",v).on("zoom",f?x:null).on("zoom.wheel",h?m:null);r.call(w,{})}function i(){r.on("zoom",null)}return{update:s,destroy:i,pointer:de}}const rn=e=>({x:e.x,y:e.y,zoom:e.k}),yn=({x:e,y:t,zoom:n})=>tn.translate(e,t).scale(n),Ve=(e,t)=>e.target.closest(`.${t}`),js=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Hd=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,wn=(e,t=0,n=Hd,o=()=>{})=>{const r=typeof t=="number"&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},Ms=e=>{const t=e.ctrlKey&&mt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Rd({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return d=>{if(Ve(d,t))return d.ctrlKey&&d.preventDefault(),!1;d.preventDefault(),d.stopImmediatePropagation();const f=n.property("__zoom").k||1;if(d.ctrlKey&&i){const v=de(d),x=Ms(d),w=f*Math.pow(2,x);o.scaleTo(n,w,v,d);return}const h=d.deltaMode===1?20:1;let p=r===Pe.Vertical?0:d.deltaX*h,m=r===Pe.Horizontal?0:d.deltaY*h;!mt()&&d.shiftKey&&r!==Pe.Vertical&&(p=d.deltaY*h,m=0),o.translateBy(n,-(p/f)*s,-(m/f)*s,{internal:!0});const b=rn(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c?.(d,b),e.panScrollTimeout=setTimeout(()=>{l?.(d,b),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,a?.(d,b))}}function Bd({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const s=o.type==="wheel",i=!t&&s&&!o.ctrlKey,a=Ve(o,e);if(o.ctrlKey&&s&&a&&o.preventDefault(),i||a)return null;o.preventDefault(),n.call(this,o,r)}}function Od({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=rn(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function Vd({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return s=>{e.usedRightMouseButton=!!(n&&js(t,e.mouseButton??0)),s.sourceEvent?.sync||o([s.transform.x,s.transform.y,s.transform.k]),r&&!s.sourceEvent?.internal&&r?.(s.sourceEvent,rn(s.transform))}}function Fd({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:s}){return i=>{if(!i.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,s&&js(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),r)){const a=rn(i.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(i.sourceEvent,a)},n?150:0)}}}function Wd({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:a,noPanClassName:c,lib:l,connectionInProgress:d}){return f=>{const h=e||t,p=n&&f.ctrlKey,m=f.type==="wheel";if(f.button===1&&f.type==="mousedown"&&(Ve(f,`${l}-flow__node`)||Ve(f,`${l}-flow__edge`)))return!0;if(!o&&!h&&!r&&!s&&!n||i||d&&!m||Ve(f,a)&&m||Ve(f,c)&&(!m||r&&m&&!e)||!n&&f.ctrlKey&&m)return!1;if(!n&&f.type==="touchstart"&&f.touches?.length>1)return f.preventDefault(),!1;if(!h&&!r&&!p&&m||!o&&(f.type==="mousedown"||f.type==="touchstart")||Array.isArray(o)&&!o.includes(f.button)&&f.type==="mousedown")return!1;const b=Array.isArray(o)&&o.includes(f.button)||!f.button||f.button<=1;return(!f.ctrlKey||m)&&b}}function Yd({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:r,onPanZoom:s,onPanZoomStart:i,onPanZoomEnd:a,onDraggingChange:c}){const l={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=ts().scaleExtent([t,n]).translateExtent(o),h=le(e).call(f);w({x:r.x,y:r.y,zoom:Ue(r.zoom,t,n)},[[0,0],[d.width,d.height]],o);const p=h.on("wheel.zoom"),m=h.on("dblclick.zoom");f.wheelDelta(Ms);function b(A,L){return h?new Promise(D=>{f?.interpolate(L?.interpolate==="linear"?at:Lt).transform(wn(h,L?.duration,L?.ease,()=>D(!0)),A)}):Promise.resolve(!1)}function v({noWheelClassName:A,noPanClassName:L,onPaneContextMenu:D,userSelectionActive:N,panOnScroll:S,panOnDrag:C,panOnScrollMode:I,panOnScrollSpeed:M,preventScrolling:$,zoomOnPinch:z,zoomOnScroll:R,zoomOnDoubleClick:H,zoomActivationKeyPressed:V,lib:F,onTransformChange:Z,connectionInProgress:G,paneClickDistance:X,selectionOnDrag:O}){N&&!l.isZoomingOrPanning&&x();const Y=S&&!V&&!N;f.clickDistance(O?1/0:!he(X)||X<0?0:X);const Q=Y?Rd({zoomPanValues:l,noWheelClassName:A,d3Selection:h,d3Zoom:f,panOnScrollMode:I,panOnScrollSpeed:M,zoomOnPinch:z,onPanZoomStart:i,onPanZoom:s,onPanZoomEnd:a}):Bd({noWheelClassName:A,preventScrolling:$,d3ZoomHandler:p});if(h.on("wheel.zoom",Q,{passive:!1}),!N){const q=Od({zoomPanValues:l,onDraggingChange:c,onPanZoomStart:i});f.on("start",q);const U=Vd({zoomPanValues:l,panOnDrag:C,onPaneContextMenu:!!D,onPanZoom:s,onTransformChange:Z});f.on("zoom",U);const ee=Fd({zoomPanValues:l,panOnDrag:C,panOnScroll:S,onPaneContextMenu:D,onPanZoomEnd:a,onDraggingChange:c});f.on("end",ee)}const K=Wd({zoomActivationKeyPressed:V,panOnDrag:C,zoomOnScroll:R,panOnScroll:S,zoomOnDoubleClick:H,zoomOnPinch:z,userSelectionActive:N,noPanClassName:L,noWheelClassName:A,lib:F,connectionInProgress:G});f.filter(K),H?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function x(){f.on("zoom",null)}async function w(A,L,D){const N=yn(A),S=f?.constrain()(N,L,D);return S&&await b(S),new Promise(C=>C(S))}async function g(A,L){const D=yn(A);return await b(D,L),new Promise(N=>N(D))}function y(A){if(h){const L=yn(A),D=h.property("__zoom");(D.k!==A.zoom||D.x!==A.x||D.y!==A.y)&&f?.transform(h,L,null,{sync:!0})}}function E(){const A=h?es(h.node()):{x:0,y:0,k:1};return{x:A.x,y:A.y,zoom:A.k}}function _(A,L){return h?new Promise(D=>{f?.interpolate(L?.interpolate==="linear"?at:Lt).scaleTo(wn(h,L?.duration,L?.ease,()=>D(!0)),A)}):Promise.resolve(!1)}function k(A,L){return h?new Promise(D=>{f?.interpolate(L?.interpolate==="linear"?at:Lt).scaleBy(wn(h,L?.duration,L?.ease,()=>D(!0)),A)}):Promise.resolve(!1)}function P(A){f?.scaleExtent(A)}function T(A){f?.translateExtent(A)}function B(A){const L=!he(A)||A<0?0:A;f?.clickDistance(L)}return{update:v,destroy:x,setViewport:g,setViewportConstrained:w,getViewport:E,scaleTo:_,scaleBy:k,setScaleExtent:P,setTranslateExtent:T,syncViewport:y,setClickDistance:B}}var Qe;(function(e){e.Line="line",e.Handle="handle"})(Qe||(Qe={}));function Xd({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:s}){const i=e-t,a=n-o,c=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&r&&(c[0]=c[0]*-1),a&&s&&(c[1]=c[1]*-1),c}function Wo(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function ke(e,t){return Math.max(0,t-e)}function je(e,t){return Math.max(0,e-t)}function $t(e,t,n){return Math.max(0,t-e,e-n)}function Yo(e,t){return e?!t:t}function Zd(e,t,n,o,r,s,i,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:d,isVertical:f}=t,h=d&&f,{xSnapped:p,ySnapped:m}=n,{minWidth:b,maxWidth:v,minHeight:x,maxHeight:w}=o,{x:g,y,width:E,height:_,aspectRatio:k}=e;let P=Math.floor(d?p-e.pointerX:0),T=Math.floor(f?m-e.pointerY:0);const B=E+(c?-P:P),A=_+(l?-T:T),L=-s[0]*E,D=-s[1]*_;let N=$t(B,b,v),S=$t(A,x,w);if(i){let M=0,$=0;c&&P<0?M=ke(g+P+L,i[0][0]):!c&&P>0&&(M=je(g+B+L,i[1][0])),l&&T<0?$=ke(y+T+D,i[0][1]):!l&&T>0&&($=je(y+A+D,i[1][1])),N=Math.max(N,M),S=Math.max(S,$)}if(a){let M=0,$=0;c&&P>0?M=je(g+P,a[0][0]):!c&&P<0&&(M=ke(g+B,a[1][0])),l&&T>0?$=je(y+T,a[0][1]):!l&&T<0&&($=ke(y+A,a[1][1])),N=Math.max(N,M),S=Math.max(S,$)}if(r){if(d){const M=$t(B/k,x,w)*k;if(N=Math.max(N,M),i){let $=0;!c&&!l||c&&!l&&h?$=je(y+D+B/k,i[1][1])*k:$=ke(y+D+(c?P:-P)/k,i[0][1])*k,N=Math.max(N,$)}if(a){let $=0;!c&&!l||c&&!l&&h?$=ke(y+B/k,a[1][1])*k:$=je(y+(c?P:-P)/k,a[0][1])*k,N=Math.max(N,$)}}if(f){const M=$t(A*k,b,v)/k;if(S=Math.max(S,M),i){let $=0;!c&&!l||l&&!c&&h?$=je(g+A*k+L,i[1][0])/k:$=ke(g+(l?T:-T)*k+L,i[0][0])/k,S=Math.max(S,$)}if(a){let $=0;!c&&!l||l&&!c&&h?$=ke(g+A*k,a[1][0])/k:$=je(g+(l?T:-T)*k,a[0][0])/k,S=Math.max(S,$)}}}T=T+(T<0?S:-S),P=P+(P<0?N:-N),r&&(h?B>A*k?T=(Yo(c,l)?-P:P)/k:P=(Yo(c,l)?-T:T)*k:d?(T=P/k,l=c):(P=T*k,c=l));const C=c?g+P:g,I=l?y+T:y;return{width:E+(c?-P:P),height:_+(l?-T:T),x:s[0]*P*(c?-1:1)+C,y:s[1]*T*(l?-1:1)+I}}const Is={width:0,height:0,x:0,y:0},qd={...Is,pointerX:0,pointerY:0,aspectRatio:1};function Ud(e){return[[0,0],[e.measured.width,e.measured.height]]}function Gd(e,t,n){const o=t.position.x+e.position.x,r=t.position.y+e.position.y,s=e.measured.width??0,i=e.measured.height??0,a=n[0]*s,c=n[1]*i;return[[o-a,r-c],[o+s-a,r+i-c]]}function Kd({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){const s=le(e);let i={controlDirection:Wo("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function a({controlPosition:l,boundaries:d,keepAspectRatio:f,resizeDirection:h,onResizeStart:p,onResize:m,onResizeEnd:b,shouldResize:v}){let x={...Is},w={...qd};i={boundaries:d,resizeDirection:h,keepAspectRatio:f,controlDirection:Wo(l)};let g,y=null,E=[],_,k,P,T=!1;const B=Br().on("start",A=>{const{nodeLookup:L,transform:D,snapGrid:N,snapToGrid:S,nodeOrigin:C,paneDomNode:I}=n();if(g=L.get(t),!g)return;y=I?.getBoundingClientRect()??null;const{xSnapped:M,ySnapped:$}=ct(A.sourceEvent,{transform:D,snapGrid:N,snapToGrid:S,containerBounds:y});x={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},w={...x,pointerX:M,pointerY:$,aspectRatio:x.width/x.height},_=void 0,g.parentId&&(g.extent==="parent"||g.expandParent)&&(_=L.get(g.parentId),k=_&&g.extent==="parent"?Ud(_):void 0),E=[],P=void 0;for(const[z,R]of L)if(R.parentId===t&&(E.push({id:z,position:{...R.position},extent:R.extent}),R.extent==="parent"||R.expandParent)){const H=Gd(R,g,R.origin??C);P?P=[[Math.min(H[0][0],P[0][0]),Math.min(H[0][1],P[0][1])],[Math.max(H[1][0],P[1][0]),Math.max(H[1][1],P[1][1])]]:P=H}p?.(A,{...x})}).on("drag",A=>{const{transform:L,snapGrid:D,snapToGrid:N,nodeOrigin:S}=n(),C=ct(A.sourceEvent,{transform:L,snapGrid:D,snapToGrid:N,containerBounds:y}),I=[];if(!g)return;const{x:M,y:$,width:z,height:R}=x,H={},V=g.origin??S,{width:F,height:Z,x:G,y:X}=Zd(w,i.controlDirection,C,i.boundaries,i.keepAspectRatio,V,k,P),O=F!==z,Y=Z!==R,Q=G!==M&&O,K=X!==$&&Y;if(!Q&&!K&&!O&&!Y)return;if((Q||K||V[0]===1||V[1]===1)&&(H.x=Q?G:x.x,H.y=K?X:x.y,x.x=H.x,x.y=H.y,E.length>0)){const ne=G-M,te=X-$;for(const ie of E)ie.position={x:ie.position.x-ne+V[0]*(F-z),y:ie.position.y-te+V[1]*(Z-R)},I.push(ie)}if((O||Y)&&(H.width=O&&(!i.resizeDirection||i.resizeDirection==="horizontal")?F:x.width,H.height=Y&&(!i.resizeDirection||i.resizeDirection==="vertical")?Z:x.height,x.width=H.width,x.height=H.height),_&&g.expandParent){const ne=V[0]*(H.width??0);H.x&&H.x<ne&&(x.x=ne,w.x=w.x-(H.x-ne));const te=V[1]*(H.height??0);H.y&&H.y<te&&(x.y=te,w.y=w.y-(H.y-te))}const q=Xd({width:x.width,prevWidth:z,height:x.height,prevHeight:R,affectsX:i.controlDirection.affectsX,affectsY:i.controlDirection.affectsY}),U={...x,direction:q};v?.(A,U)!==!1&&(T=!0,m?.(A,U),o(H,I))}).on("end",A=>{T&&(b?.(A,{...x}),r?.({...x}),T=!1)});s.call(B)}function c(){s.on(".drag",null)}return{update:a,destroy:c}}var bn={exports:{}},vn={},Nn={exports:{}},_n={};var Xo;function Qd(){if(Xo)return _n;Xo=1;var e=Cr();function t(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var n=typeof Object.is=="function"?Object.is:t,o=e.useState,r=e.useEffect,s=e.useLayoutEffect,i=e.useDebugValue;function a(f,h){var p=h(),m=o({inst:{value:p,getSnapshot:h}}),b=m[0].inst,v=m[1];return s(function(){b.value=p,b.getSnapshot=h,c(b)&&v({inst:b})},[f,p,h]),r(function(){return c(b)&&v({inst:b}),f(function(){c(b)&&v({inst:b})})},[f]),i(p),p}function c(f){var h=f.getSnapshot;f=f.value;try{var p=h();return!n(f,p)}catch{return!0}}function l(f,h){return h()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:a;return _n.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,_n}var Zo;function Jd(){return Zo||(Zo=1,Nn.exports=Qd()),Nn.exports}var qo;function ef(){if(qo)return vn;qo=1;var e=Cr(),t=Jd();function n(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var o=typeof Object.is=="function"?Object.is:n,r=t.useSyncExternalStore,s=e.useRef,i=e.useEffect,a=e.useMemo,c=e.useDebugValue;return vn.useSyncExternalStoreWithSelector=function(l,d,f,h,p){var m=s(null);if(m.current===null){var b={hasValue:!1,value:null};m.current=b}else b=m.current;m=a(function(){function x(_){if(!w){if(w=!0,g=_,_=h(_),p!==void 0&&b.hasValue){var k=b.value;if(p(k,_))return y=k}return y=_}if(k=y,o(g,_))return k;var P=h(_);return p!==void 0&&p(k,P)?(g=_,k):(g=_,y=P)}var w=!1,g,y,E=f===void 0?null:f;return[function(){return x(d())},E===null?void 0:function(){return x(E())}]},[d,f,h,p]);var v=r(l,m[0],m[1]);return i(function(){b.hasValue=!0,b.value=v},[v]),c(v),v},vn}var Uo;function tf(){return Uo||(Uo=1,bn.exports=ef()),bn.exports}var nf=tf();const of=ya(nf),rf={},Go=e=>{let t;const n=new Set,o=(d,f)=>{const h=typeof d=="function"?d(t):d;if(!Object.is(h,t)){const p=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(m=>m(t,p))}},r=()=>t,c={setState:o,getState:r,getInitialState:()=>l,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(rf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(o,r,c);return c},sf=e=>e?Go(e):Go,{useDebugValue:af}=Er,{useSyncExternalStoreWithSelector:cf}=of,lf=e=>e;function As(e,t=lf,n){const o=cf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return af(o),o}const Ko=(e,t)=>{const n=sf(e),o=(r,s=t)=>As(n,r,s);return Object.assign(o,n),o},uf=(e,t)=>e?Ko(e,t):Ko;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}wa();const sn=j.createContext(null),df=sn.Provider,$s=ye.error001();function J(e,t){const n=j.useContext(sn);if(n===null)throw new Error($s);return As(n,e,t)}function re(){const e=j.useContext(sn);if(e===null)throw new Error($s);return j.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Qo={display:"none"},ff={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ts="react-flow__node-desc",Ps="react-flow__edge-desc",hf="react-flow__aria-live",gf=e=>e.ariaLiveMessage,pf=e=>e.ariaLabelConfig;function mf({rfId:e}){const t=J(gf);return u.jsx("div",{id:`${hf}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ff,children:t})}function xf({rfId:e,disableKeyboardA11y:t}){const n=J(pf);return u.jsxs(u.Fragment,{children:[u.jsx("div",{id:`${Ts}-${e}`,style:Qo,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),u.jsx("div",{id:`${Ps}-${e}`,style:Qo,children:n["edge.a11yDescription.default"]}),!t&&u.jsx(mf,{rfId:e})]})}const Ct=j.forwardRef(({position:e="top-left",children:t,className:n,style:o,...r},s)=>{const i=`${e}`.split("-");return u.jsx("div",{className:se(["react-flow__panel",n,...i]),style:o,ref:s,...r,children:t})});Ct.displayName="Panel";function yf({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:u.jsx(Ct,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:u.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const wf=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},Tt=e=>e.id;function bf(e,t){return oe(e.selectedNodes.map(Tt),t.selectedNodes.map(Tt))&&oe(e.selectedEdges.map(Tt),t.selectedEdges.map(Tt))}function vf({onSelectionChange:e}){const t=re(),{selectedNodes:n,selectedEdges:o}=J(wf,bf);return j.useEffect(()=>{const r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(s=>s(r))},[n,o,e]),null}const Nf=e=>!!e.onSelectionChangeHandlers;function _f({onSelectionChange:e}){const t=J(Nf);return e||t?u.jsx(vf,{onSelectionChange:e}):null}const Ds=[0,0],Cf={x:0,y:0,zoom:1},Ef=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Jo=[...Ef,"rfId"],Sf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),er={translateExtent:ht,nodeOrigin:Ds,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function kf(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:s,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:c}=J(Sf,oe),l=re();j.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=er,a()}),[]);const d=j.useRef(er);return j.useEffect(()=>{for(const f of Jo){const h=e[f],p=d.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?o(h):f==="maxZoom"?r(h):f==="translateExtent"?s(h):f==="nodeExtent"?i(h):f==="ariaLabelConfig"?l.setState({ariaLabelConfig:ud(h)}):f==="fitView"?l.setState({fitViewQueued:h}):f==="fitViewOptions"?l.setState({fitViewOptions:h}):l.setState({[f]:h})))}d.current=e},Jo.map(f=>e[f])),null}function tr(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function jf(e){const[t,n]=j.useState(e==="system"?null:e);return j.useEffect(()=>{if(e!=="system"){n(e);return}const o=tr(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[e]),t!==null?t:tr()?.matches?"dark":"light"}const nr=typeof document<"u"?document:null;function xt(e=null,t={target:nr,actInsideInputWithModifier:!0}){const[n,o]=j.useState(!1),r=j.useRef(!1),s=j.useRef(new Set([])),[i,a]=j.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=l.reduce((f,h)=>f.concat(...h),[]);return[l,d]}return[[],[]]},[e]);return j.useEffect(()=>{const c=t?.target??nr,l=t?.actInsideInputWithModifier??!0;if(e!==null){const d=p=>{if(r.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!r.current||r.current&&!l)&&gs(p))return!1;const b=rr(p.code,a);if(s.current.add(p[b]),or(i,s.current,!1)){const v=p.composedPath?.()?.[0]||p.target,x=v?.nodeName==="BUTTON"||v?.nodeName==="A";t.preventDefault!==!1&&(r.current||!x)&&p.preventDefault(),o(!0)}},f=p=>{const m=rr(p.code,a);or(i,s.current,!0)?(o(!1),s.current.clear()):s.current.delete(p[m]),p.key==="Meta"&&s.current.clear(),r.current=!1},h=()=>{s.current.clear(),o(!1)};return c?.addEventListener("keydown",d),c?.addEventListener("keyup",f),window.addEventListener("blur",h),window.addEventListener("contextmenu",h),()=>{c?.removeEventListener("keydown",d),c?.removeEventListener("keyup",f),window.removeEventListener("blur",h),window.removeEventListener("contextmenu",h)}}},[e,o]),n}function or(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function rr(e,t){return t.includes(e)?"code":"key"}const Mf=()=>{const e=re();return j.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,r,s],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??s},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:r,minZoom:s,maxZoom:i,panZoom:a}=e.getState(),c=Gn(t,o,r,s,i,n?.padding??.1);return a?(await a.setViewport(c,{duration:n?.duration,ease:n?.ease,interpolate:n?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:r,snapToGrid:s,domNode:i}=e.getState();if(!i)return t;const{x:a,y:c}=i.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},d=n.snapGrid??r,f=n.snapToGrid??s;return _t(l,o,f,d)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:r,y:s}=o.getBoundingClientRect(),i=Ut(t,n);return{x:i.x+r,y:i.y+s}}}),[])};function Ls(e,t){const n=[],o=new Map,r=[];for(const s of e)if(s.type==="add"){r.push(s);continue}else if(s.type==="remove"||s.type==="replace")o.set(s.id,[s]);else{const i=o.get(s.id);i?i.push(s):o.set(s.id,[s])}for(const s of t){const i=o.get(s.id);if(!i){n.push(s);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...s};for(const c of i)If(c,a);n.push(a)}return r.length&&r.forEach(s=>{s.index!==void 0?n.splice(s.index,0,{...s.item}):n.push({...s.item})}),n}function If(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function zs(e,t){return Ls(e,t)}function Hs(e,t){return Ls(e,t)}function Ae(e,t){return{id:e,type:"select",selected:t}}function Fe(e,t=new Set,n=!1){const o=[];for(const[r,s]of e){const i=t.has(r);!(s.selected===void 0&&!i)&&s.selected!==i&&(n&&(s.selected=i),o.push(Ae(s.id,i)))}return o}function sr({items:e=[],lookup:t}){const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,s]of e.entries()){const i=t.get(s.id),a=i?.internals?.userNode??i;a!==void 0&&a!==s&&n.push({id:s.id,item:s,type:"replace"}),a===void 0&&n.push({item:s,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function ir(e){return{id:e.id,type:"remove"}}const ar=e=>ed(e),Af=e=>is(e);function Rs(e){return j.forwardRef(e)}const $f=typeof window<"u"?j.useLayoutEffect:j.useEffect;function cr(e){const[t,n]=j.useState(BigInt(0)),[o]=j.useState(()=>Tf(()=>n(r=>r+BigInt(1))));return $f(()=>{const r=o.get();r.length&&(e(r),o.reset())},[t]),o}function Tf(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Bs=j.createContext(null);function Pf({children:e}){const t=re(),n=j.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:d,onNodesChange:f,nodeLookup:h,fitViewQueued:p,onNodesChangeMiddlewareMap:m}=t.getState();let b=c;for(const x of a)b=typeof x=="function"?x(b):x;let v=sr({items:b,lookup:h});for(const x of m.values())v=x(v);d&&l(b),v.length>0?f?.(v):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:w,setNodes:g}=t.getState();x&&g(w)})},[]),o=cr(n),r=j.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:d,onEdgesChange:f,edgeLookup:h}=t.getState();let p=c;for(const m of a)p=typeof m=="function"?m(p):m;d?l(p):f&&f(sr({items:p,lookup:h}))},[]),s=cr(r),i=j.useMemo(()=>({nodeQueue:o,edgeQueue:s}),[]);return u.jsx(Bs.Provider,{value:i,children:e})}function Df(){const e=j.useContext(Bs);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Lf=e=>!!e.panZoom;function an(){const e=Mf(),t=re(),n=Df(),o=J(Lf),r=j.useMemo(()=>{const s=f=>t.getState().nodeLookup.get(f),i=f=>{n.nodeQueue.push(f)},a=f=>{n.edgeQueue.push(f)},c=f=>{const{nodeLookup:h,nodeOrigin:p}=t.getState(),m=ar(f)?f:h.get(f.id),b=m.parentId?fs(m.position,m.measured,m.parentId,h,p):m.position,v={...m,position:b,width:m.measured?.width??m.width,height:m.measured?.height??m.height};return Ge(v)},l=(f,h,p={replace:!1})=>{i(m=>m.map(b=>{if(b.id===f){const v=typeof h=="function"?h(b):h;return p.replace&&ar(v)?v:{...b,...v}}return b}))},d=(f,h,p={replace:!1})=>{a(m=>m.map(b=>{if(b.id===f){const v=typeof h=="function"?h(b):h;return p.replace&&Af(v)?v:{...b,...v}}return b}))};return{getNodes:()=>t.getState().nodes.map(f=>({...f})),getNode:f=>s(f)?.internals.userNode,getInternalNode:s,getEdges:()=>{const{edges:f=[]}=t.getState();return f.map(h=>({...h}))},getEdge:f=>t.getState().edgeLookup.get(f),setNodes:i,setEdges:a,addNodes:f=>{const h=Array.isArray(f)?f:[f];n.nodeQueue.push(p=>[...p,...h])},addEdges:f=>{const h=Array.isArray(f)?f:[f];n.edgeQueue.push(p=>[...p,...h])},toObject:()=>{const{nodes:f=[],edges:h=[],transform:p}=t.getState(),[m,b,v]=p;return{nodes:f.map(x=>({...x})),edges:h.map(x=>({...x})),viewport:{x:m,y:b,zoom:v}}},deleteElements:async({nodes:f=[],edges:h=[]})=>{const{nodes:p,edges:m,onNodesDelete:b,onEdgesDelete:v,triggerNodeChanges:x,triggerEdgeChanges:w,onDelete:g,onBeforeDelete:y}=t.getState(),{nodes:E,edges:_}=await sd({nodesToRemove:f,edgesToRemove:h,nodes:p,edges:m,onBeforeDelete:y}),k=_.length>0,P=E.length>0;if(k){const T=_.map(ir);v?.(_),w(T)}if(P){const T=E.map(ir);b?.(E),x(T)}return(P||k)&&g?.({nodes:E,edges:_}),{deletedNodes:E,deletedEdges:_}},getIntersectingNodes:(f,h=!0,p)=>{const m=To(f),b=m?f:c(f),v=p!==void 0;return b?(p||t.getState().nodes).filter(x=>{const w=t.getState().nodeLookup.get(x.id);if(w&&!m&&(x.id===f.id||!w.internals.positionAbsolute))return!1;const g=Ge(v?x:w),y=pt(g,b);return h&&y>0||y>=g.width*g.height||y>=b.width*b.height}):[]},isNodeIntersecting:(f,h,p=!0)=>{const b=To(f)?f:c(f);if(!b)return!1;const v=pt(b,h);return p&&v>0||v>=h.width*h.height||v>=b.width*b.height},updateNode:l,updateNodeData:(f,h,p={replace:!1})=>{l(f,m=>{const b=typeof h=="function"?h(m):h;return p.replace?{...m,data:b}:{...m,data:{...m.data,...b}}},p)},updateEdge:d,updateEdgeData:(f,h,p={replace:!1})=>{d(f,m=>{const b=typeof h=="function"?h(m):h;return p.replace?{...m,data:b}:{...m,data:{...m.data,...b}}},p)},getNodesBounds:f=>{const{nodeLookup:h,nodeOrigin:p}=t.getState();return td(f,{nodeLookup:h,nodeOrigin:p})},getHandleConnections:({type:f,id:h,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}-${f}${h?`-${h}`:""}`)?.values()??[]),getNodeConnections:({type:f,handleId:h,nodeId:p})=>Array.from(t.getState().connectionLookup.get(`${p}${f?h?`-${f}-${h}`:`-${f}`:""}`)?.values()??[]),fitView:async f=>{const h=t.getState().fitViewResolver??ld();return t.setState({fitViewQueued:!0,fitViewOptions:f,fitViewResolver:h}),n.nodeQueue.push(p=>[...p]),h.promise}}},[]);return j.useMemo(()=>({...r,...e,viewportInitialized:o}),[o])}const lr=e=>e.selected,zf=typeof window<"u"?window:void 0;function Hf({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=re(),{deleteElements:o}=an(),r=xt(e,{actInsideInputWithModifier:!1}),s=xt(t,{target:zf});j.useEffect(()=>{if(r){const{edges:i,nodes:a}=n.getState();o({nodes:a.filter(lr),edges:i.filter(lr)}),n.setState({nodesSelectionActive:!1})}},[r]),j.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])}function Rf(e){const t=re();j.useEffect(()=>{const n=()=>{if(!e.current||!(e.current.checkVisibility?.()??!0))return!1;const o=Kn(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",ye.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const cn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Bf=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Of({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:s=Pe.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:d,maxZoom:f,zoomActivationKeyCode:h,preventScrolling:p=!0,children:m,noWheelClassName:b,noPanClassName:v,onViewportChange:x,isControlledViewport:w,paneClickDistance:g,selectionOnDrag:y}){const E=re(),_=j.useRef(null),{userSelectionActive:k,lib:P,connectionInProgress:T}=J(Bf,oe),B=xt(h),A=j.useRef();Rf(_);const L=j.useCallback(D=>{x?.({x:D[0],y:D[1],zoom:D[2]}),w||E.setState({transform:D})},[x,w]);return j.useEffect(()=>{if(_.current){A.current=Yd({domNode:_.current,minZoom:d,maxZoom:f,translateExtent:l,viewport:c,onDraggingChange:C=>E.setState({paneDragging:C}),onPanZoomStart:(C,I)=>{const{onViewportChangeStart:M,onMoveStart:$}=E.getState();$?.(C,I),M?.(I)},onPanZoom:(C,I)=>{const{onViewportChange:M,onMove:$}=E.getState();$?.(C,I),M?.(I)},onPanZoomEnd:(C,I)=>{const{onViewportChangeEnd:M,onMoveEnd:$}=E.getState();$?.(C,I),M?.(I)}});const{x:D,y:N,zoom:S}=A.current.getViewport();return E.setState({panZoom:A.current,transform:[D,N,S],domNode:_.current.closest(".react-flow")}),()=>{A.current?.destroy()}}},[]),j.useEffect(()=>{A.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:s,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:B,preventScrolling:p,noPanClassName:v,userSelectionActive:k,noWheelClassName:b,lib:P,onTransformChange:L,connectionInProgress:T,selectionOnDrag:y,paneClickDistance:g})},[e,t,n,o,r,s,i,a,B,p,v,k,b,P,L,T,y,g]),u.jsx("div",{className:"react-flow__renderer",ref:_,style:cn,children:m})}const Vf=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Ff(){const{userSelectionActive:e,userSelectionRect:t}=J(Vf,oe);return e&&t?u.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Cn=(e,t)=>n=>{n.target===t.current&&e?.(n)},Wf=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Yf({isSelecting:e,selectionKeyPressed:t,selectionMode:n=gt.Full,panOnDrag:o,paneClickDistance:r,selectionOnDrag:s,onSelectionStart:i,onSelectionEnd:a,onPaneClick:c,onPaneContextMenu:l,onPaneScroll:d,onPaneMouseEnter:f,onPaneMouseMove:h,onPaneMouseLeave:p,children:m}){const b=re(),{userSelectionActive:v,elementsSelectable:x,dragging:w,connectionInProgress:g}=J(Wf,oe),y=x&&(e||v),E=j.useRef(null),_=j.useRef(),k=j.useRef(new Set),P=j.useRef(new Set),T=j.useRef(!1),B=M=>{if(T.current||g){T.current=!1;return}c?.(M),b.getState().resetSelectedElements(),b.setState({nodesSelectionActive:!1})},A=M=>{if(Array.isArray(o)&&o?.includes(2)){M.preventDefault();return}l?.(M)},L=d?M=>d(M):void 0,D=M=>{T.current&&(M.stopPropagation(),T.current=!1)},N=M=>{const{domNode:$}=b.getState();if(_.current=$?.getBoundingClientRect(),!_.current)return;const z=M.target===E.current;if(!z&&!!M.target.closest(".nokey")||!e||!(s&&z||t)||M.button!==0||!M.isPrimary)return;M.target?.setPointerCapture?.(M.pointerId),T.current=!1;const{x:V,y:F}=ge(M.nativeEvent,_.current);b.setState({userSelectionRect:{width:0,height:0,startX:V,startY:F,x:V,y:F}}),z||(M.stopPropagation(),M.preventDefault())},S=M=>{const{userSelectionRect:$,transform:z,nodeLookup:R,edgeLookup:H,connectionLookup:V,triggerNodeChanges:F,triggerEdgeChanges:Z,defaultEdgeOptions:G,resetSelectedElements:X}=b.getState();if(!_.current||!$)return;const{x:O,y:Y}=ge(M.nativeEvent,_.current),{startX:Q,startY:K}=$;if(!T.current){const te=t?0:r;if(Math.hypot(O-Q,Y-K)<=te)return;X(),i?.(M)}T.current=!0;const q={startX:Q,startY:K,x:O<Q?O:Q,y:Y<K?Y:K,width:Math.abs(O-Q),height:Math.abs(Y-K)},U=k.current,ee=P.current;k.current=new Set(Un(R,q,z,n===gt.Partial,!0).map(te=>te.id)),P.current=new Set;const ne=G?.selectable??!0;for(const te of k.current){const ie=V.get(te);if(ie)for(const{edgeId:Se}of ie.values()){const be=H.get(Se);be&&(be.selectable??ne)&&P.current.add(Se)}}if(!Po(U,k.current)){const te=Fe(R,k.current,!0);F(te)}if(!Po(ee,P.current)){const te=Fe(H,P.current);Z(te)}b.setState({userSelectionRect:q,userSelectionActive:!0,nodesSelectionActive:!1})},C=M=>{M.button===0&&(M.target?.releasePointerCapture?.(M.pointerId),!v&&M.target===E.current&&b.getState().userSelectionRect&&B?.(M),b.setState({userSelectionActive:!1,userSelectionRect:null}),T.current&&(a?.(M),b.setState({nodesSelectionActive:k.current.size>0})))},I=o===!0||Array.isArray(o)&&o.includes(0);return u.jsxs("div",{className:se(["react-flow__pane",{draggable:I,dragging:w,selection:e}]),onClick:y?void 0:Cn(B,E),onContextMenu:Cn(A,E),onWheel:Cn(L,E),onPointerEnter:y?void 0:f,onPointerMove:y?S:h,onPointerUp:y?C:void 0,onPointerDownCapture:y?N:void 0,onClickCapture:y?D:void 0,onPointerLeave:p,ref:E,style:cn,children:[m,u.jsx(Ff,{})]})}function Bn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:s,multiSelectionActive:i,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c?.("012",ye.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&i)&&(s({nodes:[l],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function Os({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:s,nodeClickDistance:i}){const a=re(),[c,l]=j.useState(!1),d=j.useRef();return j.useEffect(()=>{d.current=Ad({getStoreItems:()=>a.getState(),onNodeMouseDown:f=>{Bn({id:f,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),j.useEffect(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:s,nodeId:r,nodeClickDistance:i}),()=>{d.current?.destroy()}},[n,o,t,s,e,r]),c}const Xf=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Vs(){const e=re();return j.useCallback(n=>{const{nodeExtent:o,snapToGrid:r,snapGrid:s,nodesDraggable:i,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:d}=e.getState(),f=new Map,h=Xf(i),p=r?s[0]:5,m=r?s[1]:5,b=n.direction.x*p*n.factor,v=n.direction.y*m*n.factor;for(const[,x]of l){if(!h(x))continue;let w={x:x.internals.positionAbsolute.x+b,y:x.internals.positionAbsolute.y+v};r&&(w=Nt(w,s));const{position:g,positionAbsolute:y}=as({nodeId:x.id,nextPosition:w,nodeLookup:l,nodeExtent:o,nodeOrigin:d,onError:a});x.position=g,x.internals.positionAbsolute=y,f.set(x.id,x)}c(f)},[])}const oo=j.createContext(null),Zf=oo.Provider;oo.Consumer;const Fs=()=>j.useContext(oo),qf=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Uf=(e,t,n)=>o=>{const{connectionClickStartHandle:r,connectionMode:s,connection:i}=o,{fromHandle:a,toHandle:c,isValid:l}=i,d=c?.nodeId===e&&c?.id===t&&c?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:d,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:s===qe.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:d&&l}};function Gf({type:e="source",position:t=W.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:s=!0,id:i,onConnect:a,children:c,className:l,onMouseDown:d,onTouchStart:f,...h},p){const m=i||null,b=e==="target",v=re(),x=Fs(),{connectOnClick:w,noPanClassName:g,rfId:y}=J(qf,oe),{connectingFrom:E,connectingTo:_,clickConnecting:k,isPossibleEndHandle:P,connectionInProcess:T,clickConnectionInProcess:B,valid:A}=J(Uf(x,m,e),oe);x||v.getState().onError?.("010",ye.error010());const L=S=>{const{defaultEdgeOptions:C,onConnect:I,hasDefaultEdges:M}=v.getState(),$={...C,...S};if(M){const{edges:z,setEdges:R}=v.getState();R(Dn($,z))}I?.($),a?.($)},D=S=>{if(!x)return;const C=ps(S.nativeEvent);if(r&&(C&&S.button===0||!C)){const I=v.getState();Rn.onPointerDown(S.nativeEvent,{handleDomNode:S.currentTarget,autoPanOnConnect:I.autoPanOnConnect,connectionMode:I.connectionMode,connectionRadius:I.connectionRadius,domNode:I.domNode,nodeLookup:I.nodeLookup,lib:I.lib,isTarget:b,handleId:m,nodeId:x,flowId:I.rfId,panBy:I.panBy,cancelConnection:I.cancelConnection,onConnectStart:I.onConnectStart,onConnectEnd:I.onConnectEnd,updateConnection:I.updateConnection,onConnect:L,isValidConnection:n||I.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:I.autoPanSpeed,dragThreshold:I.connectionDragThreshold})}C?d?.(S):f?.(S)},N=S=>{const{onClickConnectStart:C,onClickConnectEnd:I,connectionClickStartHandle:M,connectionMode:$,isValidConnection:z,lib:R,rfId:H,nodeLookup:V,connection:F}=v.getState();if(!x||!M&&!r)return;if(!M){C?.(S.nativeEvent,{nodeId:x,handleId:m,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:x,type:e,id:m}});return}const Z=hs(S.target),G=n||z,{connection:X,isValid:O}=Rn.isValid(S.nativeEvent,{handle:{nodeId:x,id:m,type:e},connectionMode:$,fromNodeId:M.nodeId,fromHandleId:M.id||null,fromType:M.type,isValidConnection:G,flowId:H,doc:Z,lib:R,nodeLookup:V});O&&X&&L(X);const Y=structuredClone(F);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,I?.(S,Y),v.setState({connectionClickStartHandle:null})};return u.jsx("div",{"data-handleid":m,"data-nodeid":x,"data-handlepos":t,"data-id":`${y}-${x}-${m}-${e}`,className:se(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,l,{source:!b,target:b,connectable:o,connectablestart:r,connectableend:s,clickconnecting:k,connectingfrom:E,connectingto:_,valid:A,connectionindicator:o&&(!T||P)&&(T||B?s:r)}]),onMouseDown:D,onTouchStart:D,onClick:w?N:void 0,ref:p,...h,children:c})}const ce=j.memo(Rs(Gf));function Kf({data:e,isConnectable:t,sourcePosition:n=W.Bottom}){return u.jsxs(u.Fragment,{children:[e?.label,u.jsx(ce,{type:"source",position:n,isConnectable:t})]})}function Qf({data:e,isConnectable:t,targetPosition:n=W.Top,sourcePosition:o=W.Bottom}){return u.jsxs(u.Fragment,{children:[u.jsx(ce,{type:"target",position:n,isConnectable:t}),e?.label,u.jsx(ce,{type:"source",position:o,isConnectable:t})]})}function Jf(){return null}function eh({data:e,isConnectable:t,targetPosition:n=W.Top}){return u.jsxs(u.Fragment,{children:[u.jsx(ce,{type:"target",position:n,isConnectable:t}),e?.label]})}const Gt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ur={input:Kf,default:Qf,output:eh,group:Jf};function th(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}const nh=e=>{const{width:t,height:n,x:o,y:r}=vt(e.nodeLookup,{filter:s=>!!s.selected});return{width:he(t)?t:null,height:he(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function oh({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=re(),{width:r,height:s,transformString:i,userSelectionActive:a}=J(nh,oe),c=Vs(),l=j.useRef(null);if(j.useEffect(()=>{n||l.current?.focus({preventScroll:!0})},[n]),Os({nodeRef:l}),a||!r||!s)return null;const d=e?h=>{const p=o.getState().nodes.filter(m=>m.selected);e(h,p)}:void 0,f=h=>{Object.prototype.hasOwnProperty.call(Gt,h.key)&&(h.preventDefault(),c({direction:Gt[h.key],factor:h.shiftKey?4:1}))};return u.jsx("div",{className:se(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:u.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:r,height:s}})})}const dr=typeof window<"u"?window:void 0,rh=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Ws({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:d,selectionMode:f,onSelectionStart:h,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:b,zoomActivationKeyCode:v,elementsSelectable:x,zoomOnScroll:w,zoomOnPinch:g,panOnScroll:y,panOnScrollSpeed:E,panOnScrollMode:_,zoomOnDoubleClick:k,panOnDrag:P,defaultViewport:T,translateExtent:B,minZoom:A,maxZoom:L,preventScrolling:D,onSelectionContextMenu:N,noWheelClassName:S,noPanClassName:C,disableKeyboardA11y:I,onViewportChange:M,isControlledViewport:$}){const{nodesSelectionActive:z,userSelectionActive:R}=J(rh,oe),H=xt(l,{target:dr}),V=xt(b,{target:dr}),F=V||P,Z=V||y,G=d&&F!==!0,X=H||R||G;return Hf({deleteKeyCode:c,multiSelectionKeyCode:m}),u.jsx(Of,{onPaneContextMenu:s,elementsSelectable:x,zoomOnScroll:w,zoomOnPinch:g,panOnScroll:Z,panOnScrollSpeed:E,panOnScrollMode:_,zoomOnDoubleClick:k,panOnDrag:!H&&F,defaultViewport:T,translateExtent:B,minZoom:A,maxZoom:L,zoomActivationKeyCode:v,preventScrolling:D,noWheelClassName:S,noPanClassName:C,onViewportChange:M,isControlledViewport:$,paneClickDistance:a,selectionOnDrag:G,children:u.jsxs(Yf,{onSelectionStart:h,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:s,onPaneScroll:i,panOnDrag:F,isSelecting:!!X,selectionMode:f,selectionKeyPressed:H,paneClickDistance:a,selectionOnDrag:G,children:[e,z&&u.jsx(oh,{onSelectionContextMenu:N,noPanClassName:C,disableKeyboardA11y:I})]})})}Ws.displayName="FlowRenderer";const sh=j.memo(Ws),ih=e=>t=>e?Un(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function ah(e){return J(j.useCallback(ih(e),[e]),oe)}const ch=e=>e.updateNodeInternals;function lh(){const e=J(ch),[t]=j.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(r=>{const s=r.target.getAttribute("data-id");o.set(s,{id:s,nodeElement:r.target,force:!0})}),e(o)}));return j.useEffect(()=>()=>{t?.disconnect()},[t]),t}function uh({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const r=re(),s=j.useRef(null),i=j.useRef(null),a=j.useRef(e.sourcePosition),c=j.useRef(e.targetPosition),l=j.useRef(t),d=n&&!!e.internals.handleBounds;return j.useEffect(()=>{s.current&&!e.hidden&&(!d||i.current!==s.current)&&(i.current&&o?.unobserve(i.current),o?.observe(s.current),i.current=s.current)},[d,e.hidden]),j.useEffect(()=>()=>{i.current&&(o?.unobserve(i.current),i.current=null)},[]),j.useEffect(()=>{if(s.current){const f=l.current!==t,h=a.current!==e.sourcePosition,p=c.current!==e.targetPosition;(f||h||p)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:s.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),s}function dh({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:s,onDoubleClick:i,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:d,resizeObserver:f,noDragClassName:h,noPanClassName:p,disableKeyboardA11y:m,rfId:b,nodeTypes:v,nodeClickDistance:x,onError:w}){const{node:g,internals:y,isParent:E}=J(O=>{const Y=O.nodeLookup.get(e),Q=O.parentLookup.has(e);return{node:Y,internals:Y.internals,isParent:Q}},oe);let _=g.type||"default",k=v?.[_]||ur[_];k===void 0&&(w?.("003",ye.error003(_)),_="default",k=v?.default||ur.default);const P=!!(g.draggable||a&&typeof g.draggable>"u"),T=!!(g.selectable||c&&typeof g.selectable>"u"),B=!!(g.connectable||l&&typeof g.connectable>"u"),A=!!(g.focusable||d&&typeof g.focusable>"u"),L=re(),D=ds(g),N=uh({node:g,nodeType:_,hasDimensions:D,resizeObserver:f}),S=Os({nodeRef:N,disabled:g.hidden||!P,noDragClassName:h,handleSelector:g.dragHandle,nodeId:e,isSelectable:T,nodeClickDistance:x}),C=Vs();if(g.hidden)return null;const I=Ee(g),M=th(g),$=T||P||t||n||o||r,z=n?O=>n(O,{...y.userNode}):void 0,R=o?O=>o(O,{...y.userNode}):void 0,H=r?O=>r(O,{...y.userNode}):void 0,V=s?O=>s(O,{...y.userNode}):void 0,F=i?O=>i(O,{...y.userNode}):void 0,Z=O=>{const{selectNodesOnDrag:Y,nodeDragThreshold:Q}=L.getState();T&&(!Y||!P||Q>0)&&Bn({id:e,store:L,nodeRef:N}),t&&t(O,{...y.userNode})},G=O=>{if(!(gs(O.nativeEvent)||m)){if(ns.includes(O.key)&&T){const Y=O.key==="Escape";Bn({id:e,store:L,unselect:Y,nodeRef:N})}else if(P&&g.selected&&Object.prototype.hasOwnProperty.call(Gt,O.key)){O.preventDefault();const{ariaLabelConfig:Y}=L.getState();L.setState({ariaLiveMessage:Y["node.a11yDescription.ariaLiveMessage"]({direction:O.key.replace("Arrow","").toLowerCase(),x:~~y.positionAbsolute.x,y:~~y.positionAbsolute.y})}),C({direction:Gt[O.key],factor:O.shiftKey?4:1})}}},X=()=>{if(m||!N.current?.matches(":focus-visible"))return;const{transform:O,width:Y,height:Q,autoPanOnNodeFocus:K,setCenter:q}=L.getState();if(!K)return;Un(new Map([[e,g]]),{x:0,y:0,width:Y,height:Q},O,!0).length>0||q(g.position.x+I.width/2,g.position.y+I.height/2,{zoom:O[2]})};return u.jsx("div",{className:se(["react-flow__node",`react-flow__node-${_}`,{[p]:P},g.className,{selected:g.selected,selectable:T,parent:E,draggable:P,dragging:S}]),ref:N,style:{zIndex:y.z,transform:`translate(${y.positionAbsolute.x}px,${y.positionAbsolute.y}px)`,pointerEvents:$?"all":"none",visibility:D?"visible":"hidden",...g.style,...M},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:z,onMouseMove:R,onMouseLeave:H,onContextMenu:V,onClick:Z,onDoubleClick:F,onKeyDown:A?G:void 0,tabIndex:A?0:void 0,onFocus:A?X:void 0,role:g.ariaRole??(A?"group":void 0),"aria-roledescription":"node","aria-describedby":m?void 0:`${Ts}-${b}`,"aria-label":g.ariaLabel,...g.domAttributes,children:u.jsx(Zf,{value:e,children:u.jsx(k,{id:e,data:g.data,type:_,positionAbsoluteX:y.positionAbsolute.x,positionAbsoluteY:y.positionAbsolute.y,selected:g.selected??!1,selectable:T,draggable:P,deletable:g.deletable??!0,isConnectable:B,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:S,dragHandle:g.dragHandle,zIndex:y.z,parentId:g.parentId,...I})})})}var fh=j.memo(dh);const hh=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ys(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:s}=J(hh,oe),i=ah(e.onlyRenderVisibleElements),a=lh();return u.jsx("div",{className:"react-flow__nodes",style:cn,children:i.map(c=>u.jsx(fh,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:s},c))})}Ys.displayName="NodeRenderer";const gh=j.memo(Ys);function ph(e){return J(j.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const o=[];if(n.width&&n.height)for(const r of n.edges){const s=n.nodeLookup.get(r.source),i=n.nodeLookup.get(r.target);s&&i&&hd({sourceNode:s,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),oe)}const mh=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return u.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},xh=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return u.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},fr={[Zt.Arrow]:mh,[Zt.ArrowClosed]:xh};function yh(e){const t=re();return j.useMemo(()=>Object.prototype.hasOwnProperty.call(fr,e)?fr[e]:(t.getState().onError?.("009",ye.error009(e)),null),[e])}const wh=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:s="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=yh(t);return c?u.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0",children:u.jsx(c,{color:n,strokeWidth:i})}):null},Xs=({defaultColor:e,rfId:t})=>{const n=J(s=>s.edges),o=J(s=>s.defaultEdgeOptions),r=j.useMemo(()=>bd(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?u.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:u.jsx("defs",{children:r.map(s=>u.jsx(wh,{id:s.id,type:s.type,color:s.color,width:s.width,height:s.height,markerUnits:s.markerUnits,strokeWidth:s.strokeWidth,orient:s.orient},s.id))})}):null};Xs.displayName="MarkerDefinitions";var bh=j.memo(Xs);function Zs({x:e,y:t,label:n,labelStyle:o,labelShowBg:r=!0,labelBgStyle:s,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...d}){const[f,h]=j.useState({x:1,y:0,width:0,height:0}),p=se(["react-flow__edge-textwrapper",l]),m=j.useRef(null);return j.useEffect(()=>{if(m.current){const b=m.current.getBBox();h({x:b.x,y:b.y,width:b.width,height:b.height})}},[n]),n?u.jsxs("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:p,visibility:f.width?"visible":"hidden",...d,children:[r&&u.jsx("rect",{width:f.width+2*i[0],x:-i[0],y:-i[1],height:f.height+2*i[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),u.jsx("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:m,style:o,children:n}),c]}):null}Zs.displayName="EdgeText";const vh=j.memo(Zs);function ln({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...d}){return u.jsxs(u.Fragment,{children:[u.jsx("path",{...d,d:e,fill:"none",className:se(["react-flow__edge-path",d.className])}),l?u.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}):null,o&&he(t)&&he(n)?u.jsx(vh,{x:t,y:n,label:o,labelStyle:r,labelShowBg:s,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function hr({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===W.Left||e===W.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function qs({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:r,targetPosition:s=W.Top}){const[i,a]=hr({pos:n,x1:e,y1:t,x2:o,y2:r}),[c,l]=hr({pos:s,x1:o,y1:r,x2:e,y2:t}),[d,f,h,p]=ms({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${i},${a} ${c},${l} ${o},${r}`,d,f,h,p]}function Us(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i,targetPosition:a,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:b,markerStart:v,interactionWidth:x})=>{const[w,g,y]=qs({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a}),E=e.isInternal?void 0:t;return u.jsx(ln,{id:E,path:w,labelX:g,labelY:y,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:b,markerStart:v,interactionWidth:x})})}const Nh=Us({isInternal:!1}),Gs=Us({isInternal:!0});Nh.displayName="SimpleBezierEdge";Gs.displayName="SimpleBezierEdgeInternal";function Ks(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:h,sourcePosition:p=W.Bottom,targetPosition:m=W.Top,markerEnd:b,markerStart:v,pathOptions:x,interactionWidth:w})=>{const[g,y,E]=Ln({sourceX:n,sourceY:o,sourcePosition:p,targetX:r,targetY:s,targetPosition:m,borderRadius:x?.borderRadius,offset:x?.offset,stepPosition:x?.stepPosition}),_=e.isInternal?void 0:t;return u.jsx(ln,{id:_,path:g,labelX:y,labelY:E,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:b,markerStart:v,interactionWidth:w})})}const Qs=Ks({isInternal:!1}),Js=Ks({isInternal:!0});Qs.displayName="SmoothStepEdge";Js.displayName="SmoothStepEdgeInternal";function ei(e){return j.memo(({id:t,...n})=>{const o=e.isInternal?void 0:t;return u.jsx(Qs,{...n,id:o,pathOptions:j.useMemo(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}const _h=ei({isInternal:!1}),ti=ei({isInternal:!0});_h.displayName="StepEdge";ti.displayName="StepEdgeInternal";function ni(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:m,interactionWidth:b})=>{const[v,x,w]=ws({sourceX:n,sourceY:o,targetX:r,targetY:s}),g=e.isInternal?void 0:t;return u.jsx(ln,{id:g,path:v,labelX:x,labelY:w,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:f,style:h,markerEnd:p,markerStart:m,interactionWidth:b})})}const Ch=ni({isInternal:!1}),oi=ni({isInternal:!0});Ch.displayName="StraightEdge";oi.displayName="StraightEdgeInternal";function ri(e){return j.memo(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:s,sourcePosition:i=W.Bottom,targetPosition:a=W.Top,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:b,markerStart:v,pathOptions:x,interactionWidth:w})=>{const[g,y,E]=xs({sourceX:n,sourceY:o,sourcePosition:i,targetX:r,targetY:s,targetPosition:a,curvature:x?.curvature}),_=e.isInternal?void 0:t;return u.jsx(ln,{id:_,path:g,labelX:y,labelY:E,label:c,labelStyle:l,labelShowBg:d,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:b,markerStart:v,interactionWidth:w})})}const Eh=ri({isInternal:!1}),si=ri({isInternal:!0});Eh.displayName="BezierEdge";si.displayName="BezierEdgeInternal";const gr={default:si,straight:oi,step:ti,smoothstep:Js,simplebezier:Gs},pr={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Sh=(e,t,n)=>n===W.Left?e-t:n===W.Right?e+t:e,kh=(e,t,n)=>n===W.Top?e-t:n===W.Bottom?e+t:e,mr="react-flow__edgeupdater";function xr({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:s,onMouseOut:i,type:a}){return u.jsx("circle",{onMouseDown:r,onMouseEnter:s,onMouseOut:i,className:se([mr,`${mr}-${a}`]),cx:Sh(t,o,e),cy:kh(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function jh({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:s,targetY:i,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:d,onReconnectEnd:f,setReconnecting:h,setUpdateHover:p}){const m=re(),b=(y,E)=>{if(y.button!==0)return;const{autoPanOnConnect:_,domNode:k,isValidConnection:P,connectionMode:T,connectionRadius:B,lib:A,onConnectStart:L,onConnectEnd:D,cancelConnection:N,nodeLookup:S,rfId:C,panBy:I,updateConnection:M}=m.getState(),$=E.type==="target",z=(V,F)=>{h(!1),f?.(V,n,E.type,F)},R=V=>l?.(n,V),H=(V,F)=>{h(!0),d?.(y,n,E.type),L?.(V,F)};Rn.onPointerDown(y.nativeEvent,{autoPanOnConnect:_,connectionMode:T,connectionRadius:B,domNode:k,handleId:E.id,nodeId:E.nodeId,nodeLookup:S,isTarget:$,edgeUpdaterType:E.type,lib:A,flowId:C,cancelConnection:N,panBy:I,isValidConnection:P,onConnect:R,onConnectStart:H,onConnectEnd:D,onReconnectEnd:z,updateConnection:M,getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,dragThreshold:m.getState().connectionDragThreshold,handleDomNode:y.currentTarget})},v=y=>b(y,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=y=>b(y,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>p(!0),g=()=>p(!1);return u.jsxs(u.Fragment,{children:[(e===!0||e==="source")&&u.jsx(xr,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&u.jsx(xr,{position:c,centerX:s,centerY:i,radius:t,onMouseDown:x,onMouseEnter:w,onMouseOut:g,type:"target"})]})}function Mh({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:p,rfId:m,edgeTypes:b,noPanClassName:v,onError:x,disableKeyboardA11y:w}){let g=J(q=>q.edgeLookup.get(e));const y=J(q=>q.defaultEdgeOptions);g=y?{...y,...g}:g;let E=g.type||"default",_=b?.[E]||gr[E];_===void 0&&(x?.("011",ye.error011(E)),E="default",_=b?.default||gr.default);const k=!!(g.focusable||t&&typeof g.focusable>"u"),P=typeof f<"u"&&(g.reconnectable||n&&typeof g.reconnectable>"u"),T=!!(g.selectable||o&&typeof g.selectable>"u"),B=j.useRef(null),[A,L]=j.useState(!1),[D,N]=j.useState(!1),S=re(),{zIndex:C,sourceX:I,sourceY:M,targetX:$,targetY:z,sourcePosition:R,targetPosition:H}=J(j.useCallback(q=>{const U=q.nodeLookup.get(g.source),ee=q.nodeLookup.get(g.target);if(!U||!ee)return{zIndex:g.zIndex,...pr};const ne=wd({id:e,sourceNode:U,targetNode:ee,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:q.connectionMode,onError:x});return{zIndex:fd({selected:g.selected,zIndex:g.zIndex,sourceNode:U,targetNode:ee,elevateOnSelect:q.elevateEdgesOnSelect,zIndexMode:q.zIndexMode}),...ne||pr}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),oe),V=j.useMemo(()=>g.markerStart?`url('#${zn(g.markerStart,m)}')`:void 0,[g.markerStart,m]),F=j.useMemo(()=>g.markerEnd?`url('#${zn(g.markerEnd,m)}')`:void 0,[g.markerEnd,m]);if(g.hidden||I===null||M===null||$===null||z===null)return null;const Z=q=>{const{addSelectedEdges:U,unselectNodesAndEdges:ee,multiSelectionActive:ne}=S.getState();T&&(S.setState({nodesSelectionActive:!1}),g.selected&&ne?(ee({nodes:[],edges:[g]}),B.current?.blur()):U([e])),r&&r(q,g)},G=s?q=>{s(q,{...g})}:void 0,X=i?q=>{i(q,{...g})}:void 0,O=a?q=>{a(q,{...g})}:void 0,Y=c?q=>{c(q,{...g})}:void 0,Q=l?q=>{l(q,{...g})}:void 0,K=q=>{if(!w&&ns.includes(q.key)&&T){const{unselectNodesAndEdges:U,addSelectedEdges:ee}=S.getState();q.key==="Escape"?(B.current?.blur(),U({edges:[g]})):ee([e])}};return u.jsx("svg",{style:{zIndex:C},children:u.jsxs("g",{className:se(["react-flow__edge",`react-flow__edge-${E}`,g.className,v,{selected:g.selected,animated:g.animated,inactive:!T&&!r,updating:A,selectable:T}]),onClick:Z,onDoubleClick:G,onContextMenu:X,onMouseEnter:O,onMouseMove:Y,onMouseLeave:Q,onKeyDown:k?K:void 0,tabIndex:k?0:void 0,role:g.ariaRole??(k?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":k?`${Ps}-${m}`:void 0,ref:B,...g.domAttributes,children:[!D&&u.jsx(_,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:T,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:I,sourceY:M,targetX:$,targetY:z,sourcePosition:R,targetPosition:H,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:V,markerEnd:F,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),P&&u.jsx(jh,{edge:g,isReconnectable:P,reconnectRadius:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:p,sourceX:I,sourceY:M,targetX:$,targetY:z,sourcePosition:R,targetPosition:H,setUpdateHover:L,setReconnecting:N})]})})}var Ih=j.memo(Mh);const Ah=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function ii({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:s,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:d,reconnectRadius:f,onEdgeDoubleClick:h,onReconnectStart:p,onReconnectEnd:m,disableKeyboardA11y:b}){const{edgesFocusable:v,edgesReconnectable:x,elementsSelectable:w,onError:g}=J(Ah,oe),y=ph(t);return u.jsxs("div",{className:"react-flow__edges",children:[u.jsx(bh,{defaultColor:e,rfId:n}),y.map(E=>u.jsx(Ih,{id:E,edgesFocusable:v,edgesReconnectable:x,elementsSelectable:w,noPanClassName:r,onReconnect:s,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:d,reconnectRadius:f,onDoubleClick:h,onReconnectStart:p,onReconnectEnd:m,rfId:n,onError:g,edgeTypes:o,disableKeyboardA11y:b},E))]})}ii.displayName="EdgeRenderer";const $h=j.memo(ii),Th=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Ph({children:e}){const t=J(Th);return u.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Dh(e){const t=an(),n=j.useRef(!1);j.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Lh=e=>e.panZoom?.syncViewport;function zh(e){const t=J(Lh),n=re();return j.useEffect(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Hh(e){return e.connection.inProgress?{...e.connection,to:_t(e.connection.to,e.transform)}:{...e.connection}}function Rh(e){return Hh}function Bh(e){const t=Rh();return J(t,oe)}const Oh=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Vh({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:r,width:s,height:i,isValid:a,inProgress:c}=J(Oh,oe);return!(s&&r&&c)?null:u.jsx("svg",{style:e,width:s,height:i,className:"react-flow__connectionline react-flow__container",children:u.jsx("g",{className:se(["react-flow__connection",ss(a)]),children:u.jsx(ai,{style:t,type:n,CustomComponent:o,isValid:a})})})}const ai=({style:e,type:t=Me.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:r,from:s,fromNode:i,fromHandle:a,fromPosition:c,to:l,toNode:d,toHandle:f,toPosition:h,pointer:p}=Bh();if(!r)return;if(n)return u.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:s.x,fromY:s.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:h,connectionStatus:ss(o),toNode:d,toHandle:f,pointer:p});let m="";const b={sourceX:s.x,sourceY:s.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:h};switch(t){case Me.Bezier:[m]=xs(b);break;case Me.SimpleBezier:[m]=qs(b);break;case Me.Step:[m]=Ln({...b,borderRadius:0});break;case Me.SmoothStep:[m]=Ln(b);break;default:[m]=ws(b)}return u.jsx("path",{d:m,fill:"none",className:"react-flow__connection-path",style:e})};ai.displayName="ConnectionLine";const Fh={};function yr(e=Fh){j.useRef(e),re(),j.useEffect(()=>{},[e])}function Wh(){re(),j.useRef(!1),j.useEffect(()=>{},[])}function ci({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:s,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:d,onSelectionContextMenu:f,onSelectionStart:h,onSelectionEnd:p,connectionLineType:m,connectionLineStyle:b,connectionLineComponent:v,connectionLineContainerStyle:x,selectionKeyCode:w,selectionOnDrag:g,selectionMode:y,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:k,deleteKeyCode:P,onlyRenderVisibleElements:T,elementsSelectable:B,defaultViewport:A,translateExtent:L,minZoom:D,maxZoom:N,preventScrolling:S,defaultMarkerColor:C,zoomOnScroll:I,zoomOnPinch:M,panOnScroll:$,panOnScrollSpeed:z,panOnScrollMode:R,zoomOnDoubleClick:H,panOnDrag:V,onPaneClick:F,onPaneMouseEnter:Z,onPaneMouseMove:G,onPaneMouseLeave:X,onPaneScroll:O,onPaneContextMenu:Y,paneClickDistance:Q,nodeClickDistance:K,onEdgeContextMenu:q,onEdgeMouseEnter:U,onEdgeMouseMove:ee,onEdgeMouseLeave:ne,reconnectRadius:te,onReconnect:ie,onReconnectStart:Se,onReconnectEnd:be,noDragClassName:Ie,noWheelClassName:Je,noPanClassName:et,disableKeyboardA11y:tt,nodeExtent:un,rfId:Et,viewport:Re,onViewportChange:nt}){return yr(e),yr(t),Wh(),Dh(n),zh(Re),u.jsx(sh,{onPaneClick:F,onPaneMouseEnter:Z,onPaneMouseMove:G,onPaneMouseLeave:X,onPaneContextMenu:Y,onPaneScroll:O,paneClickDistance:Q,deleteKeyCode:P,selectionKeyCode:w,selectionOnDrag:g,selectionMode:y,onSelectionStart:h,onSelectionEnd:p,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:k,elementsSelectable:B,zoomOnScroll:I,zoomOnPinch:M,zoomOnDoubleClick:H,panOnScroll:$,panOnScrollSpeed:z,panOnScrollMode:R,panOnDrag:V,defaultViewport:A,translateExtent:L,minZoom:D,maxZoom:N,onSelectionContextMenu:f,preventScrolling:S,noDragClassName:Ie,noWheelClassName:Je,noPanClassName:et,disableKeyboardA11y:tt,onViewportChange:nt,isControlledViewport:!!Re,children:u.jsxs(Ph,{children:[u.jsx($h,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:i,onReconnect:ie,onReconnectStart:Se,onReconnectEnd:be,onlyRenderVisibleElements:T,onEdgeContextMenu:q,onEdgeMouseEnter:U,onEdgeMouseMove:ee,onEdgeMouseLeave:ne,reconnectRadius:te,defaultMarkerColor:C,noPanClassName:et,disableKeyboardA11y:tt,rfId:Et}),u.jsx(Vh,{style:b,type:m,component:v,containerStyle:x}),u.jsx("div",{className:"react-flow__edgelabel-renderer"}),u.jsx(gh,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:d,nodeClickDistance:K,onlyRenderVisibleElements:T,noPanClassName:et,noDragClassName:Ie,disableKeyboardA11y:tt,nodeExtent:un,rfId:Et}),u.jsx("div",{className:"react-flow__viewport-portal"})]})})}ci.displayName="GraphView";const Yh=j.memo(ci),wr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:c=.5,maxZoom:l=2,nodeOrigin:d,nodeExtent:f,zIndexMode:h="basic"}={})=>{const p=new Map,m=new Map,b=new Map,v=new Map,x=o??t??[],w=n??e??[],g=d??[0,0],y=f??ht;Ns(b,v,x);const E=Hn(w,p,m,{nodeOrigin:g,nodeExtent:y,zIndexMode:h});let _=[0,0,1];if(i&&r&&s){const k=vt(p,{filter:A=>!!((A.width||A.initialWidth)&&(A.height||A.initialHeight))}),{x:P,y:T,zoom:B}=Gn(k,r,s,c,l,a?.padding??.1);_=[P,T,B]}return{rfId:"1",width:r??0,height:s??0,transform:_,nodes:w,nodesInitialized:E,nodeLookup:p,parentLookup:m,edges:x,edgeLookup:v,connectionLookup:b,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:ht,nodeExtent:y,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:qe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...rs},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:id,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:os,zIndexMode:h,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},Xh=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:d,nodeExtent:f,zIndexMode:h})=>uf((p,m)=>{async function b(){const{nodeLookup:v,panZoom:x,fitViewOptions:w,fitViewResolver:g,width:y,height:E,minZoom:_,maxZoom:k}=m();x&&(await rd({nodes:v,width:y,height:E,panZoom:x,minZoom:_,maxZoom:k},w),g?.resolve(!0),p({fitViewResolver:null}))}return{...wr({nodes:e,edges:t,width:r,height:s,fitView:i,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:d,nodeExtent:f,defaultNodes:n,defaultEdges:o,zIndexMode:h}),setNodes:v=>{const{nodeLookup:x,parentLookup:w,nodeOrigin:g,elevateNodesOnSelect:y,fitViewQueued:E,zIndexMode:_}=m(),k=Hn(v,x,w,{nodeOrigin:g,nodeExtent:f,elevateNodesOnSelect:y,checkEquality:!0,zIndexMode:_});E&&k?(b(),p({nodes:v,nodesInitialized:k,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:v,nodesInitialized:k})},setEdges:v=>{const{connectionLookup:x,edgeLookup:w}=m();Ns(x,w,v),p({edges:v})},setDefaultNodesAndEdges:(v,x)=>{if(v){const{setNodes:w}=m();w(v),p({hasDefaultNodes:!0})}if(x){const{setEdges:w}=m();w(x),p({hasDefaultEdges:!0})}},updateNodeInternals:v=>{const{triggerNodeChanges:x,nodeLookup:w,parentLookup:g,domNode:y,nodeOrigin:E,nodeExtent:_,debug:k,fitViewQueued:P,zIndexMode:T}=m(),{changes:B,updatedInternals:A}=kd(v,w,g,y,E,_,T);A&&(_d(w,g,{nodeOrigin:E,nodeExtent:_,zIndexMode:T}),P?(b(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),B?.length>0&&(k&&console.log("React Flow: trigger node changes",B),x?.(B)))},updateNodePositions:(v,x=!1)=>{const w=[];let g=[];const{nodeLookup:y,triggerNodeChanges:E,connection:_,updateConnection:k,onNodesChangeMiddlewareMap:P}=m();for(const[T,B]of v){const A=y.get(T),L=!!(A?.expandParent&&A?.parentId&&B?.position),D={id:T,type:"position",position:L?{x:Math.max(0,B.position.x),y:Math.max(0,B.position.y)}:B.position,dragging:x};if(A&&_.inProgress&&_.fromNode.id===A.id){const N=He(A,_.fromHandle,W.Left,!0);k({..._,from:N})}L&&A.parentId&&w.push({id:T,parentId:A.parentId,rect:{...B.internals.positionAbsolute,width:B.measured.width??0,height:B.measured.height??0}}),g.push(D)}if(w.length>0){const{parentLookup:T,nodeOrigin:B}=m(),A=no(w,y,T,B);g.push(...A)}for(const T of P.values())g=T(g);E(g)},triggerNodeChanges:v=>{const{onNodesChange:x,setNodes:w,nodes:g,hasDefaultNodes:y,debug:E}=m();if(v?.length){if(y){const _=zs(v,g);w(_)}E&&console.log("React Flow: trigger node changes",v),x?.(v)}},triggerEdgeChanges:v=>{const{onEdgesChange:x,setEdges:w,edges:g,hasDefaultEdges:y,debug:E}=m();if(v?.length){if(y){const _=Hs(v,g);w(_)}E&&console.log("React Flow: trigger edge changes",v),x?.(v)}},addSelectedNodes:v=>{const{multiSelectionActive:x,edgeLookup:w,nodeLookup:g,triggerNodeChanges:y,triggerEdgeChanges:E}=m();if(x){const _=v.map(k=>Ae(k,!0));y(_);return}y(Fe(g,new Set([...v]),!0)),E(Fe(w))},addSelectedEdges:v=>{const{multiSelectionActive:x,edgeLookup:w,nodeLookup:g,triggerNodeChanges:y,triggerEdgeChanges:E}=m();if(x){const _=v.map(k=>Ae(k,!0));E(_);return}E(Fe(w,new Set([...v]))),y(Fe(g,new Set,!0))},unselectNodesAndEdges:({nodes:v,edges:x}={})=>{const{edges:w,nodes:g,nodeLookup:y,triggerNodeChanges:E,triggerEdgeChanges:_}=m(),k=v||g,P=x||w,T=k.map(A=>{const L=y.get(A.id);return L&&(L.selected=!1),Ae(A.id,!1)}),B=P.map(A=>Ae(A.id,!1));E(T),_(B)},setMinZoom:v=>{const{panZoom:x,maxZoom:w}=m();x?.setScaleExtent([v,w]),p({minZoom:v})},setMaxZoom:v=>{const{panZoom:x,minZoom:w}=m();x?.setScaleExtent([w,v]),p({maxZoom:v})},setTranslateExtent:v=>{m().panZoom?.setTranslateExtent(v),p({translateExtent:v})},resetSelectedElements:()=>{const{edges:v,nodes:x,triggerNodeChanges:w,triggerEdgeChanges:g,elementsSelectable:y}=m();if(!y)return;const E=x.reduce((k,P)=>P.selected?[...k,Ae(P.id,!1)]:k,[]),_=v.reduce((k,P)=>P.selected?[...k,Ae(P.id,!1)]:k,[]);w(E),g(_)},setNodeExtent:v=>{const{nodes:x,nodeLookup:w,parentLookup:g,nodeOrigin:y,elevateNodesOnSelect:E,nodeExtent:_,zIndexMode:k}=m();v[0][0]===_[0][0]&&v[0][1]===_[0][1]&&v[1][0]===_[1][0]&&v[1][1]===_[1][1]||(Hn(x,w,g,{nodeOrigin:y,nodeExtent:v,elevateNodesOnSelect:E,checkEquality:!1,zIndexMode:k}),p({nodeExtent:v}))},panBy:v=>{const{transform:x,width:w,height:g,panZoom:y,translateExtent:E}=m();return jd({delta:v,panZoom:y,transform:x,translateExtent:E,width:w,height:g})},setCenter:async(v,x,w)=>{const{width:g,height:y,maxZoom:E,panZoom:_}=m();if(!_)return Promise.resolve(!1);const k=typeof w?.zoom<"u"?w.zoom:E;return await _.setViewport({x:g/2-v*k,y:y/2-x*k,zoom:k},{duration:w?.duration,ease:w?.ease,interpolate:w?.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...rs}})},updateConnection:v=>{p({connection:v})},reset:()=>p({...wr()})}},Object.is);function li({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:s,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:c,fitView:l,nodeOrigin:d,nodeExtent:f,zIndexMode:h,children:p}){const[m]=j.useState(()=>Xh({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:s,fitView:l,minZoom:i,maxZoom:a,fitViewOptions:c,nodeOrigin:d,nodeExtent:f,zIndexMode:h}));return u.jsx(df,{value:m,children:u.jsx(Pf,{children:p})})}function Zh({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:s,height:i,fitView:a,fitViewOptions:c,minZoom:l,maxZoom:d,nodeOrigin:f,nodeExtent:h,zIndexMode:p}){return j.useContext(sn)?u.jsx(u.Fragment,{children:e}):u.jsx(li,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:s,initialHeight:i,fitView:a,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:d,nodeOrigin:f,nodeExtent:h,zIndexMode:p,children:e})}const qh={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Uh({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:s,edgeTypes:i,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:d,onMoveStart:f,onMoveEnd:h,onConnect:p,onConnectStart:m,onConnectEnd:b,onClickConnectStart:v,onClickConnectEnd:x,onNodeMouseEnter:w,onNodeMouseMove:g,onNodeMouseLeave:y,onNodeContextMenu:E,onNodeDoubleClick:_,onNodeDragStart:k,onNodeDrag:P,onNodeDragStop:T,onNodesDelete:B,onEdgesDelete:A,onDelete:L,onSelectionChange:D,onSelectionDragStart:N,onSelectionDrag:S,onSelectionDragStop:C,onSelectionContextMenu:I,onSelectionStart:M,onSelectionEnd:$,onBeforeDelete:z,connectionMode:R,connectionLineType:H=Me.Bezier,connectionLineStyle:V,connectionLineComponent:F,connectionLineContainerStyle:Z,deleteKeyCode:G="Backspace",selectionKeyCode:X="Shift",selectionOnDrag:O=!1,selectionMode:Y=gt.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:K=mt()?"Meta":"Control",zoomActivationKeyCode:q=mt()?"Meta":"Control",snapToGrid:U,snapGrid:ee,onlyRenderVisibleElements:ne=!1,selectNodesOnDrag:te,nodesDraggable:ie,autoPanOnNodeFocus:Se,nodesConnectable:be,nodesFocusable:Ie,nodeOrigin:Je=Ds,edgesFocusable:et,edgesReconnectable:tt,elementsSelectable:un=!0,defaultViewport:Et=Cf,minZoom:Re=.5,maxZoom:nt=2,translateExtent:ro=ht,preventScrolling:pi=!0,nodeExtent:dn,defaultMarkerColor:mi="#b1b1b7",zoomOnScroll:xi=!0,zoomOnPinch:yi=!0,panOnScroll:wi=!1,panOnScrollSpeed:bi=.5,panOnScrollMode:vi=Pe.Free,zoomOnDoubleClick:Ni=!0,panOnDrag:_i=!0,onPaneClick:Ci,onPaneMouseEnter:Ei,onPaneMouseMove:Si,onPaneMouseLeave:ki,onPaneScroll:ji,onPaneContextMenu:Mi,paneClickDistance:Ii=1,nodeClickDistance:Ai=0,children:$i,onReconnect:Ti,onReconnectStart:Pi,onReconnectEnd:Di,onEdgeContextMenu:Li,onEdgeDoubleClick:zi,onEdgeMouseEnter:Hi,onEdgeMouseMove:Ri,onEdgeMouseLeave:Bi,reconnectRadius:Oi=10,onNodesChange:Vi,onEdgesChange:Fi,noDragClassName:Wi="nodrag",noWheelClassName:Yi="nowheel",noPanClassName:so="nopan",fitView:io,fitViewOptions:ao,connectOnClick:Xi,attributionPosition:Zi,proOptions:qi,defaultEdgeOptions:Ui,elevateNodesOnSelect:Gi=!0,elevateEdgesOnSelect:Ki=!1,disableKeyboardA11y:co=!1,autoPanOnConnect:Qi,autoPanOnNodeDrag:Ji,autoPanSpeed:ea,connectionRadius:ta,isValidConnection:na,onError:oa,style:ra,id:lo,nodeDragThreshold:sa,connectionDragThreshold:ia,viewport:aa,onViewportChange:ca,width:la,height:ua,colorMode:da="light",debug:fa,onScroll:uo,ariaLabelConfig:ha,zIndexMode:fo="basic",...ga},pa){const fn=lo||"1",ma=jf(da),xa=j.useCallback(ho=>{ho.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),uo?.(ho)},[uo]);return u.jsx("div",{"data-testid":"rf__wrapper",...ga,onScroll:xa,style:{...ra,...qh},ref:pa,className:se(["react-flow",r,ma]),id:lo,role:"application",children:u.jsxs(Zh,{nodes:e,edges:t,width:la,height:ua,fitView:io,fitViewOptions:ao,minZoom:Re,maxZoom:nt,nodeOrigin:Je,nodeExtent:dn,zIndexMode:fo,children:[u.jsx(Yh,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:g,onNodeMouseLeave:y,onNodeContextMenu:E,onNodeDoubleClick:_,nodeTypes:s,edgeTypes:i,connectionLineType:H,connectionLineStyle:V,connectionLineComponent:F,connectionLineContainerStyle:Z,selectionKeyCode:X,selectionOnDrag:O,selectionMode:Y,deleteKeyCode:G,multiSelectionKeyCode:K,panActivationKeyCode:Q,zoomActivationKeyCode:q,onlyRenderVisibleElements:ne,defaultViewport:Et,translateExtent:ro,minZoom:Re,maxZoom:nt,preventScrolling:pi,zoomOnScroll:xi,zoomOnPinch:yi,zoomOnDoubleClick:Ni,panOnScroll:wi,panOnScrollSpeed:bi,panOnScrollMode:vi,panOnDrag:_i,onPaneClick:Ci,onPaneMouseEnter:Ei,onPaneMouseMove:Si,onPaneMouseLeave:ki,onPaneScroll:ji,onPaneContextMenu:Mi,paneClickDistance:Ii,nodeClickDistance:Ai,onSelectionContextMenu:I,onSelectionStart:M,onSelectionEnd:$,onReconnect:Ti,onReconnectStart:Pi,onReconnectEnd:Di,onEdgeContextMenu:Li,onEdgeDoubleClick:zi,onEdgeMouseEnter:Hi,onEdgeMouseMove:Ri,onEdgeMouseLeave:Bi,reconnectRadius:Oi,defaultMarkerColor:mi,noDragClassName:Wi,noWheelClassName:Yi,noPanClassName:so,rfId:fn,disableKeyboardA11y:co,nodeExtent:dn,viewport:aa,onViewportChange:ca}),u.jsx(kf,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:p,onConnectStart:m,onConnectEnd:b,onClickConnectStart:v,onClickConnectEnd:x,nodesDraggable:ie,autoPanOnNodeFocus:Se,nodesConnectable:be,nodesFocusable:Ie,edgesFocusable:et,edgesReconnectable:tt,elementsSelectable:un,elevateNodesOnSelect:Gi,elevateEdgesOnSelect:Ki,minZoom:Re,maxZoom:nt,nodeExtent:dn,onNodesChange:Vi,onEdgesChange:Fi,snapToGrid:U,snapGrid:ee,connectionMode:R,translateExtent:ro,connectOnClick:Xi,defaultEdgeOptions:Ui,fitView:io,fitViewOptions:ao,onNodesDelete:B,onEdgesDelete:A,onDelete:L,onNodeDragStart:k,onNodeDrag:P,onNodeDragStop:T,onSelectionDrag:S,onSelectionDragStart:N,onSelectionDragStop:C,onMove:d,onMoveStart:f,onMoveEnd:h,noPanClassName:so,nodeOrigin:Je,rfId:fn,autoPanOnConnect:Qi,autoPanOnNodeDrag:Ji,autoPanSpeed:ea,onError:oa,connectionRadius:ta,isValidConnection:na,selectNodesOnDrag:te,nodeDragThreshold:sa,connectionDragThreshold:ia,onBeforeDelete:z,debug:fa,ariaLabelConfig:ha,zIndexMode:fo}),u.jsx(_f,{onSelectionChange:D}),$i,u.jsx(yf,{proOptions:qi,position:Zi}),u.jsx(xf,{rfId:fn,disableKeyboardA11y:co})]})})}var Gh=Rs(Uh);function Kh(e){const[t,n]=j.useState(e),o=j.useCallback(r=>n(s=>zs(r,s)),[]);return[t,n,o]}function Qh(e){const[t,n]=j.useState(e),o=j.useCallback(r=>n(s=>Hs(r,s)),[]);return[t,n,o]}function Jh({dimensions:e,lineWidth:t,variant:n,className:o}){return u.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:se(["react-flow__background-pattern",n,o])})}function eg({radius:e,className:t}){return u.jsx("circle",{cx:e,cy:e,r:e,className:se(["react-flow__background-pattern","dots",t])})}var _e;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(_e||(_e={}));const tg={[_e.Dots]:1,[_e.Lines]:1,[_e.Cross]:6},ng=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ui({id:e,variant:t=_e.Dots,gap:n=20,size:o,lineWidth:r=1,offset:s=0,color:i,bgColor:a,style:c,className:l,patternClassName:d}){const f=j.useRef(null),{transform:h,patternId:p}=J(ng,oe),m=o||tg[t],b=t===_e.Dots,v=t===_e.Cross,x=Array.isArray(n)?n:[n,n],w=[x[0]*h[2]||1,x[1]*h[2]||1],g=m*h[2],y=Array.isArray(s)?s:[s,s],E=v?[g,g]:w,_=[y[0]*h[2]||1+E[0]/2,y[1]*h[2]||1+E[1]/2],k=`${p}${e||""}`;return u.jsxs("svg",{className:se(["react-flow__background",l]),style:{...c,...cn,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:f,"data-testid":"rf__background",children:[u.jsx("pattern",{id:k,x:h[0]%w[0],y:h[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${_[0]},-${_[1]})`,children:b?u.jsx(eg,{radius:g/2,className:d}):u.jsx(Jh,{dimensions:E,lineWidth:r,variant:t,className:d})}),u.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${k})`})]})}ui.displayName="Background";const og=j.memo(ui);function rg(){return u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:u.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function sg(){return u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:u.jsx("path",{d:"M0 0h32v4.2H0z"})})}function ig(){return u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:u.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function ag(){return u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:u.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function cg(){return u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:u.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Pt({children:e,className:t,...n}){return u.jsx("button",{type:"button",className:se(["react-flow__controls-button",t]),...n,children:e})}const lg=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function di({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:s,onZoomOut:i,onFitView:a,onInteractiveChange:c,className:l,children:d,position:f="bottom-left",orientation:h="vertical","aria-label":p}){const m=re(),{isInteractive:b,minZoomReached:v,maxZoomReached:x,ariaLabelConfig:w}=J(lg,oe),{zoomIn:g,zoomOut:y,fitView:E}=an(),_=()=>{g(),s?.()},k=()=>{y(),i?.()},P=()=>{E(r),a?.()},T=()=>{m.setState({nodesDraggable:!b,nodesConnectable:!b,elementsSelectable:!b}),c?.(!b)},B=h==="horizontal"?"horizontal":"vertical";return u.jsxs(Ct,{className:se(["react-flow__controls",B,l]),position:f,style:e,"data-testid":"rf__controls","aria-label":p??w["controls.ariaLabel"],children:[t&&u.jsxs(u.Fragment,{children:[u.jsx(Pt,{onClick:_,className:"react-flow__controls-zoomin",title:w["controls.zoomIn.ariaLabel"],"aria-label":w["controls.zoomIn.ariaLabel"],disabled:x,children:u.jsx(rg,{})}),u.jsx(Pt,{onClick:k,className:"react-flow__controls-zoomout",title:w["controls.zoomOut.ariaLabel"],"aria-label":w["controls.zoomOut.ariaLabel"],disabled:v,children:u.jsx(sg,{})})]}),n&&u.jsx(Pt,{className:"react-flow__controls-fitview",onClick:P,title:w["controls.fitView.ariaLabel"],"aria-label":w["controls.fitView.ariaLabel"],children:u.jsx(ig,{})}),o&&u.jsx(Pt,{className:"react-flow__controls-interactive",onClick:T,title:w["controls.interactive.ariaLabel"],"aria-label":w["controls.interactive.ariaLabel"],children:b?u.jsx(cg,{}):u.jsx(ag,{})}),d]})}di.displayName="Controls";const ug=j.memo(di);function dg({id:e,x:t,y:n,width:o,height:r,style:s,color:i,strokeColor:a,strokeWidth:c,className:l,borderRadius:d,shapeRendering:f,selected:h,onClick:p}){const{background:m,backgroundColor:b}=s||{},v=i||m||b;return u.jsx("rect",{className:se(["react-flow__minimap-node",{selected:h},l]),x:t,y:n,rx:d,ry:d,width:o,height:r,style:{fill:v,stroke:a,strokeWidth:c},shapeRendering:f,onClick:p?x=>p(x,e):void 0})}const fg=j.memo(dg),hg=e=>e.nodes.map(t=>t.id),En=e=>e instanceof Function?e:()=>e;function gg({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:s=fg,onClick:i}){const a=J(hg,oe),c=En(t),l=En(e),d=En(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return u.jsx(u.Fragment,{children:a.map(h=>u.jsx(mg,{id:h,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:d,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:s,onClick:i,shapeRendering:f},h))})}function pg({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:s,shapeRendering:i,NodeComponent:a,onClick:c}){const{node:l,x:d,y:f,width:h,height:p}=J(m=>{const{internals:b}=m.nodeLookup.get(e),v=b.userNode,{x,y:w}=b.positionAbsolute,{width:g,height:y}=Ee(v);return{node:v,x,y:w,width:g,height:y}},oe);return!l||l.hidden||!ds(l)?null:u.jsx(a,{x:d,y:f,width:h,height:p,style:l.style,selected:!!l.selected,className:o(l),color:t(l),borderRadius:r,strokeColor:n(l),strokeWidth:s,shapeRendering:i,onClick:c,id:l.id})}const mg=j.memo(pg);var xg=j.memo(gg);const yg=200,wg=150,bg=e=>!e.hidden,vg=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?us(vt(e.nodeLookup,{filter:bg}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Ng="react-flow__minimap-desc";function fi({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:s=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:d,maskStrokeWidth:f,position:h="bottom-right",onClick:p,onNodeClick:m,pannable:b=!1,zoomable:v=!1,ariaLabel:x,inversePan:w,zoomStep:g=1,offsetScale:y=5}){const E=re(),_=j.useRef(null),{boundingRect:k,viewBB:P,rfId:T,panZoom:B,translateExtent:A,flowWidth:L,flowHeight:D,ariaLabelConfig:N}=J(vg,oe),S=e?.width??yg,C=e?.height??wg,I=k.width/S,M=k.height/C,$=Math.max(I,M),z=$*S,R=$*C,H=y*$,V=k.x-(z-k.width)/2-H,F=k.y-(R-k.height)/2-H,Z=z+H*2,G=R+H*2,X=`${Ng}-${T}`,O=j.useRef(0),Y=j.useRef();O.current=$,j.useEffect(()=>{if(_.current&&B)return Y.current=zd({domNode:_.current,panZoom:B,getTransform:()=>E.getState().transform,getViewScale:()=>O.current}),()=>{Y.current?.destroy()}},[B]),j.useEffect(()=>{Y.current?.update({translateExtent:A,width:L,height:D,inversePan:w,pannable:b,zoomStep:g,zoomable:v})},[b,v,w,g,A,L,D]);const Q=p?U=>{const[ee,ne]=Y.current?.pointer(U)||[0,0];p(U,{x:ee,y:ne})}:void 0,K=m?j.useCallback((U,ee)=>{const ne=E.getState().nodeLookup.get(ee).internals.userNode;m(U,ne)},[]):void 0,q=x??N["minimap.ariaLabel"];return u.jsx(Ct,{position:h,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof f=="number"?f*$:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:se(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:u.jsxs("svg",{width:S,height:C,viewBox:`${V} ${F} ${Z} ${G}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":X,ref:_,onClick:Q,children:[q&&u.jsx("title",{id:X,children:q}),u.jsx(xg,{onClick:K,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:r,nodeStrokeWidth:i,nodeComponent:a}),u.jsx("path",{className:"react-flow__minimap-mask",d:`M${V-H},${F-H}h${Z+H*2}v${G+H*2}h${-Z-H*2}z
        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}fi.displayName="MiniMap";const _g=j.memo(fi),Cg=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Eg={[Qe.Line]:"right",[Qe.Handle]:"bottom-right"};function Sg({nodeId:e,position:t,variant:n=Qe.Handle,className:o,style:r=void 0,children:s,color:i,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:f=!1,resizeDirection:h,autoScale:p=!0,shouldResize:m,onResizeStart:b,onResize:v,onResizeEnd:x}){const w=Fs(),g=typeof e=="string"?e:w,y=re(),E=j.useRef(null),_=n===Qe.Handle,k=J(j.useCallback(Cg(_&&p),[_,p]),oe),P=j.useRef(null),T=t??Eg[n];j.useEffect(()=>{if(!(!E.current||!g))return P.current||(P.current=Kd({domNode:E.current,nodeId:g,getStoreItems:()=>{const{nodeLookup:A,transform:L,snapGrid:D,snapToGrid:N,nodeOrigin:S,domNode:C}=y.getState();return{nodeLookup:A,transform:L,snapGrid:D,snapToGrid:N,nodeOrigin:S,paneDomNode:C}},onChange:(A,L)=>{const{triggerNodeChanges:D,nodeLookup:N,parentLookup:S,nodeOrigin:C}=y.getState(),I=[],M={x:A.x,y:A.y},$=N.get(g);if($&&$.expandParent&&$.parentId){const z=$.origin??C,R=A.width??$.measured.width??0,H=A.height??$.measured.height??0,V={id:$.id,parentId:$.parentId,rect:{width:R,height:H,...fs({x:A.x??$.position.x,y:A.y??$.position.y},{width:R,height:H},$.parentId,N,z)}},F=no([V],N,S,C);I.push(...F),M.x=A.x?Math.max(z[0]*R,A.x):void 0,M.y=A.y?Math.max(z[1]*H,A.y):void 0}if(M.x!==void 0&&M.y!==void 0){const z={id:g,type:"position",position:{...M}};I.push(z)}if(A.width!==void 0&&A.height!==void 0){const R={id:g,type:"dimensions",resizing:!0,setAttributes:h?h==="horizontal"?"width":"height":!0,dimensions:{width:A.width,height:A.height}};I.push(R)}for(const z of L){const R={...z,type:"position"};I.push(R)}D(I)},onEnd:({width:A,height:L})=>{const D={id:g,type:"dimensions",resizing:!1,dimensions:{width:A,height:L}};y.getState().triggerNodeChanges([D])}})),P.current.update({controlPosition:T,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:d},keepAspectRatio:f,resizeDirection:h,onResizeStart:b,onResize:v,onResizeEnd:x,shouldResize:m}),()=>{P.current?.destroy()}},[T,a,c,l,d,f,b,v,x,m]);const B=T.split("-");return u.jsx("div",{className:se(["react-flow__resize-control","nodrag",...B,n,o]),ref:E,style:{...r,scale:k,...i&&{[_?"backgroundColor":"borderColor"]:i}},children:s})}j.memo(Sg);const hi={metric_threshold:{label:"Metric Threshold",icon:"chart-bar"},metric_change:{label:"Metric Change",icon:"arrow-trending-up"},survey_response:{label:"Survey Response",icon:"clipboard-document-list"},survey_answer:{label:"Survey Answer",icon:"chat-bubble-left"},attendance:{label:"Attendance",icon:"calendar"},schedule:{label:"Schedule",icon:"clock"},manual:{label:"Manual",icon:"hand-raised"}},kg={send_sms:{label:"Send SMS",icon:"chat-bubble-left",color:"#3B82F6"},send_email:{label:"Send Email",icon:"envelope",color:"#10B981"},send_whatsapp:{label:"Send WhatsApp",icon:"chat-bubble-oval-left",color:"#25D366"},make_call:{label:"Make Call",icon:"phone",color:"#8B5CF6"},in_app_notification:{label:"In-App Notification",icon:"bell",color:"#F59E0B"},webhook:{label:"Webhook",icon:"arrow-top-right-on-square",color:"#6366F1"},create_task:{label:"Create Task",icon:"clipboard-document-check",color:"#EC4899"},assign_resource:{label:"Assign Resource",icon:"user-plus",color:"#14B8A6"},trigger_workflow:{label:"Trigger Workflow",icon:"bolt",color:"#F97316"}},gi={equals:"Equals",not_equals:"Not Equals",greater_than:"Greater Than",less_than:"Less Than",greater_or_equal:"Greater or Equal",less_or_equal:"Less or Equal",contains:"Contains",not_contains:"Not Contains",is_empty:"Is Empty",is_not_empty:"Is Not Empty",in:"In List",not_in:"Not In List"},jg=[{type:"condition",label:"Condition",color:"purple"},{type:"delay",label:"Delay",color:"indigo"},{type:"action",label:"Action",color:"emerald"},{type:"branch",label:"Split",color:"orange"}];function Mg({id:e,data:t,selected:n}){const[o,r]=j.useState(!1),i=(()=>{if(!t?.trigger_type||typeof t.trigger_type!="string")return"Unknown Trigger";const c=hi[t.trigger_type];return c&&typeof c.label=="string"?c.label:"Unknown Trigger"})(),a=c=>{const l=new CustomEvent("addNodeFromBranch",{detail:{sourceNodeId:e,branchIndex:0,branchId:"default",nodeType:c}});window.dispatchEvent(l),r(!1)};return u.jsxs("div",{className:`
                px-4 py-3 rounded-lg border-2 bg-white shadow-sm min-w-[200px]
                ${n?"border-amber-500 ring-2 ring-amber-200":"border-amber-300"}
            `,children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-100 flex items-center justify-center",children:u.jsx("svg",{className:"w-4 h-4 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-semibold uppercase text-amber-600 tracking-wide",children:"Trigger"}),u.jsx("div",{className:"text-sm font-medium text-gray-900",children:i})]})]}),t?.conditions&&t.conditions.length>0&&u.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:u.jsxs("div",{className:"text-xs text-gray-500",children:[t.conditions.length," condition",t.conditions.length!==1?"s":""," (",(t.logic||"and").toUpperCase(),")"]})}),u.jsx(ce,{type:"source",position:W.Bottom,className:"!w-3 !h-3 !bg-amber-500 !border-2 !border-white"}),u.jsxs("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2",children:[u.jsx("button",{onClick:c=>{c.stopPropagation(),r(!o)},className:"w-5 h-5 rounded-full bg-amber-100 hover:bg-amber-200 flex items-center justify-center text-amber-600 transition-colors shadow-sm border border-amber-200",title:"Add next node",children:u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),o&&u.jsx("div",{className:"absolute top-full mt-1 left-1/2 -translate-x-1/2 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[100px]",children:jg.map(c=>u.jsxs("button",{onClick:l=>{l.stopPropagation(),a(c.type)},className:"w-full px-3 py-1.5 text-left text-xs hover:bg-gray-50 flex items-center gap-2",children:[u.jsx("span",{className:`w-2 h-2 rounded-full bg-${c.color}-500`}),c.label]},c.type))})]})]})}const Ig=j.memo(Mg),br=[{type:"condition",label:"Condition",color:"purple"},{type:"delay",label:"Delay",color:"indigo"},{type:"action",label:"Action",color:"emerald"},{type:"branch",label:"Split",color:"orange"}];function Ag({id:e,data:t,selected:n}){const[o,r]=j.useState(!1),[s,i]=j.useState(!1),a=(c,l)=>{const d=new CustomEvent("addNodeFromBranch",{detail:{sourceNodeId:e,branchIndex:l==="true"?0:1,branchId:l,nodeType:c}});window.dispatchEvent(d),r(!1),i(!1)};return u.jsxs("div",{className:`
                px-4 py-3 rounded-lg border-2 bg-white shadow-sm min-w-[180px]
                ${n?"border-purple-500 ring-2 ring-purple-200":"border-purple-300"}
            `,children:[u.jsx(ce,{type:"target",position:W.Top,className:"!w-3 !h-3 !bg-purple-500 !border-2 !border-white"}),u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center",children:u.jsx("svg",{className:"w-4 h-4 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-semibold uppercase text-purple-600 tracking-wide",children:"Condition"}),u.jsx("div",{className:"text-sm font-medium text-gray-900",children:"IF / ELSE"})]})]}),t?.conditions&&t.conditions.length>0&&u.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:u.jsxs("div",{className:"text-xs text-gray-500",children:[t.conditions.length," condition",t.conditions.length!==1?"s":""," (",(t.logic||"and").toUpperCase(),")"]})}),u.jsx(ce,{type:"source",position:W.Bottom,id:"true",style:{left:"30%"},className:"!w-3 !h-3 !bg-green-500 !border-2 !border-white"}),u.jsx(ce,{type:"source",position:W.Bottom,id:"false",style:{left:"70%"},className:"!w-3 !h-3 !bg-red-500 !border-2 !border-white"}),u.jsxs("div",{className:"flex justify-between mt-2 text-xs",children:[u.jsxs("div",{className:"relative flex flex-col items-center",children:[u.jsx("span",{className:"text-green-600 mb-1",children:"Yes"}),u.jsx("button",{onClick:c=>{c.stopPropagation(),r(!o),i(!1)},className:"w-4 h-4 rounded-full bg-green-100 hover:bg-green-200 flex items-center justify-center text-green-600 transition-colors",title:"Add node to Yes path",children:u.jsx("svg",{className:"w-2.5 h-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),o&&u.jsx("div",{className:"absolute top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[100px]",children:br.map(c=>u.jsxs("button",{onClick:l=>{l.stopPropagation(),a(c.type,"true")},className:"w-full px-3 py-1.5 text-left text-xs hover:bg-gray-50 flex items-center gap-2",children:[u.jsx("span",{className:`w-2 h-2 rounded-full bg-${c.color}-500`}),c.label]},c.type))})]}),u.jsxs("div",{className:"relative flex flex-col items-center",children:[u.jsx("span",{className:"text-red-600 mb-1",children:"No"}),u.jsx("button",{onClick:c=>{c.stopPropagation(),i(!s),r(!1)},className:"w-4 h-4 rounded-full bg-red-100 hover:bg-red-200 flex items-center justify-center text-red-600 transition-colors",title:"Add node to No path",children:u.jsx("svg",{className:"w-2.5 h-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),s&&u.jsx("div",{className:"absolute top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[100px]",children:br.map(c=>u.jsxs("button",{onClick:l=>{l.stopPropagation(),a(c.type,"false")},className:"w-full px-3 py-1.5 text-left text-xs hover:bg-gray-50 flex items-center gap-2",children:[u.jsx("span",{className:`w-2 h-2 rounded-full bg-${c.color}-500`}),c.label]},c.type))})]})]})]})}const $g=j.memo(Ag),Tg=[{type:"condition",label:"Condition",color:"purple"},{type:"delay",label:"Delay",color:"indigo"},{type:"action",label:"Action",color:"emerald"},{type:"branch",label:"Split",color:"orange"}];function Pg({id:e,data:t,selected:n}){const[o,r]=j.useState(!1),s=()=>{const a=t?.duration||1,c=t?.unit||"hours";return`${a} ${c}`},i=a=>{const c=new CustomEvent("addNodeFromBranch",{detail:{sourceNodeId:e,branchIndex:0,branchId:"default",nodeType:a}});window.dispatchEvent(c),r(!1)};return u.jsxs("div",{className:`
                px-4 py-3 rounded-lg border-2 bg-white shadow-sm min-w-[160px]
                ${n?"border-indigo-500 ring-2 ring-indigo-200":"border-indigo-300"}
            `,children:[u.jsx(ce,{type:"target",position:W.Top,className:"!w-3 !h-3 !bg-indigo-500 !border-2 !border-white"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-100 flex items-center justify-center",children:u.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-semibold uppercase text-indigo-600 tracking-wide",children:"Delay"}),u.jsx("div",{className:"text-sm font-medium text-gray-900",children:s()})]})]}),u.jsx(ce,{type:"source",position:W.Bottom,className:"!w-3 !h-3 !bg-indigo-500 !border-2 !border-white"}),u.jsxs("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2",children:[u.jsx("button",{onClick:a=>{a.stopPropagation(),r(!o)},className:"w-5 h-5 rounded-full bg-indigo-100 hover:bg-indigo-200 flex items-center justify-center text-indigo-600 transition-colors shadow-sm border border-indigo-200",title:"Add next node",children:u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),o&&u.jsx("div",{className:"absolute top-full mt-1 left-1/2 -translate-x-1/2 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[100px]",children:Tg.map(a=>u.jsxs("button",{onClick:c=>{c.stopPropagation(),i(a.type)},className:"w-full px-3 py-1.5 text-left text-xs hover:bg-gray-50 flex items-center gap-2",children:[u.jsx("span",{className:`w-2 h-2 rounded-full bg-${a.color}-500`}),a.label]},a.type))})]})]})}const Dg=j.memo(Pg),Lg=[{type:"condition",label:"Condition",color:"purple"},{type:"delay",label:"Delay",color:"indigo"},{type:"action",label:"Action",color:"emerald"},{type:"branch",label:"Split",color:"orange"}],vr={send_email:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),send_sms:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})}),send_whatsapp:u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),make_call:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),webhook:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),create_task:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),assign_resource:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),in_app_notification:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),trigger_workflow:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},Nr={send_email:"Send Email",send_sms:"Send SMS",send_whatsapp:"WhatsApp",make_call:"Voice Call",webhook:"Webhook",create_task:"Create Task",assign_resource:"Assign Resource",in_app_notification:"Notification",trigger_workflow:"Sub-workflow"};function zg({id:e,data:t,selected:n}){const[o,r]=j.useState(!1),s=typeof t?.action_type=="string"?t.action_type:"send_sms",i=vr[s]||vr.send_sms,a=typeof Nr[s]=="string"?Nr[s]:"Action",c=d=>{const f=new CustomEvent("addNodeFromBranch",{detail:{sourceNodeId:e,branchIndex:0,branchId:"default",nodeType:d}});window.dispatchEvent(f),r(!1)},l=()=>{if(!t?.config)return"Not configured";try{switch(s){case"send_email":case"send_sms":case"send_whatsapp":const d=t.config.recipients?.length||0;return d>0?`${d} recipient${d>1?"s":""}`:"No recipients";case"webhook":if(!t.config.url)return"No URL";try{return new URL(t.config.url).hostname}catch{return"Invalid URL"}case"create_task":return t.config.title||"Untitled task";case"trigger_workflow":return t.config.workflow_name||"Select workflow";default:return"Configured"}}catch{return"Not configured"}};return u.jsxs("div",{className:`
                px-4 py-3 rounded-lg border-2 bg-white shadow-sm min-w-[160px]
                ${n?"border-emerald-500 ring-2 ring-emerald-200":"border-emerald-300"}
            `,children:[u.jsx(ce,{type:"target",position:W.Top,className:"!w-3 !h-3 !bg-emerald-500 !border-2 !border-white"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center text-emerald-600",children:i}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-xs font-semibold uppercase text-emerald-600 tracking-wide",children:a}),u.jsx("div",{className:"text-sm text-gray-500 truncate",children:l()})]})]}),u.jsx(ce,{type:"source",position:W.Bottom,className:"!w-3 !h-3 !bg-emerald-500 !border-2 !border-white"}),u.jsxs("div",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2",children:[u.jsx("button",{onClick:d=>{d.stopPropagation(),r(!o)},className:"w-5 h-5 rounded-full bg-emerald-100 hover:bg-emerald-200 flex items-center justify-center text-emerald-600 transition-colors shadow-sm border border-emerald-200",title:"Add next node",children:u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),o&&u.jsx("div",{className:"absolute top-full mt-1 left-1/2 -translate-x-1/2 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[100px]",children:Lg.map(d=>u.jsxs("button",{onClick:f=>{f.stopPropagation(),c(d.type)},className:"w-full px-3 py-1.5 text-left text-xs hover:bg-gray-50 flex items-center gap-2",children:[u.jsx("span",{className:`w-2 h-2 rounded-full bg-${d.color}-500`}),d.label]},d.type))})]})]})}const Hg=j.memo(zg),Rg=[{type:"condition",label:"Condition",color:"purple"},{type:"delay",label:"Delay",color:"indigo"},{type:"action",label:"Action",color:"emerald"},{type:"branch",label:"Split",color:"orange"}];function Bg({id:e,data:t,selected:n}){const[o,r]=j.useState(null),s=t.branches||[{id:"1",name:"Yes"},{id:"2",name:"No"}],i=(a,c)=>{const l=new CustomEvent("addNodeFromBranch",{detail:{sourceNodeId:e,branchIndex:a,branchId:`branch-${a}`,nodeType:c}});window.dispatchEvent(l),r(null)};return u.jsxs("div",{className:`
                px-4 py-3 rounded-lg border-2 bg-white shadow-sm min-w-[200px]
                ${n?"border-orange-500 ring-2 ring-orange-200":"border-orange-300"}
            `,children:[u.jsx(ce,{type:"target",position:W.Top,className:"!w-3 !h-3 !bg-orange-500 !border-2 !border-white"}),u.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-100 flex items-center justify-center",children:u.jsx("svg",{className:"w-4 h-4 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-semibold uppercase text-orange-600 tracking-wide",children:"Split"}),u.jsxs("div",{className:"text-sm text-gray-500",children:[s.length," paths"]})]})]}),u.jsx("div",{className:"flex justify-around gap-2 mt-2",children:s.map((a,c)=>u.jsxs("div",{className:"relative flex flex-col items-center",children:[u.jsx("span",{className:"text-xs font-medium text-gray-600 mb-1",children:a.name||a.label||`Path ${c+1}`}),u.jsx("button",{onClick:l=>{l.stopPropagation(),r(o===c?null:c)},className:"w-5 h-5 rounded-full bg-orange-100 hover:bg-orange-200 flex items-center justify-center text-orange-600 transition-colors",title:`Add node to ${a.name||`Path ${c+1}`}`,children:u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),o===c&&u.jsx("div",{className:"absolute top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50 min-w-[120px]",children:Rg.map(l=>u.jsxs("button",{onClick:d=>{d.stopPropagation(),i(c,l.type)},className:"w-full px-3 py-1.5 text-left text-xs hover:bg-gray-50 flex items-center gap-2",children:[u.jsx("span",{className:`w-2 h-2 rounded-full bg-${l.color}-500`}),l.label]},l.type))})]},c))}),s.map((a,c)=>{const f=100/(s.length+1)*(c+1);return u.jsx(ce,{type:"source",position:W.Bottom,id:`branch-${c}`,className:"!w-3 !h-3 !bg-orange-500 !border-2 !border-white",style:{left:`${f}%`}},a.id||c)})]})}const Og=j.memo(Bg),Vg=[{type:"trigger",label:"Trigger",description:"Start the workflow",color:"amber",borderColor:"#F59E0B",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})},{type:"condition",label:"Condition",description:"IF/ELSE logic",color:"purple",borderColor:"#8B5CF6",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},{type:"delay",label:"Delay",description:"Wait before continuing",color:"indigo",borderColor:"#6366F1",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})},{type:"action",label:"Action",description:"Send notification, call API",color:"emerald",borderColor:"#10B981",icon:u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})},{type:"branch",label:"Split",description:"Parallel execution paths",color:"orange",borderColor:"#F97316",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}],Fg={amber:{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-600",hover:"hover:border-amber-400 hover:bg-amber-100"},purple:{bg:"bg-purple-50",border:"border-purple-200",text:"text-purple-600",hover:"hover:border-purple-400 hover:bg-purple-100"},indigo:{bg:"bg-indigo-50",border:"border-indigo-200",text:"text-indigo-600",hover:"hover:border-indigo-400 hover:bg-indigo-100"},emerald:{bg:"bg-emerald-50",border:"border-emerald-200",text:"text-emerald-600",hover:"hover:border-emerald-400 hover:bg-emerald-100"},orange:{bg:"bg-orange-50",border:"border-orange-200",text:"text-orange-600",hover:"hover:border-orange-400 hover:bg-orange-100"}};function Wg({className:e="",onAddNode:t}){const n=(r,s)=>{console.log("[NodePalette] Drag started for:",s.type),r.dataTransfer.setData("application/reactflow",s.type),r.dataTransfer.effectAllowed="move";const i=document.createElement("div");i.textContent=s.label,Object.assign(i.style,{position:"fixed",top:"-9999px",left:"-9999px",display:"block",width:"auto",height:"auto",maxWidth:"80px",padding:"3px 8px",margin:"0",background:"#ffffff",border:`1px solid ${s.borderColor}`,borderRadius:"4px",fontSize:"11px",fontWeight:"500",fontFamily:"-apple-system, BlinkMacSystemFont, sans-serif",color:s.borderColor,boxShadow:"0 1px 2px rgba(0,0,0,0.1)",whiteSpace:"nowrap",lineHeight:"1.2",textAlign:"center",boxSizing:"border-box",transform:"none",zoom:"1",opacity:"1",pointerEvents:"none"}),document.body.appendChild(i),r.dataTransfer.setDragImage(i,i.offsetWidth/2,i.offsetHeight/2),requestAnimationFrame(()=>{document.body.removeChild(i)})},o=r=>{t&&t(r)};return u.jsxs("div",{className:`bg-white p-4 ${e}`,children:[u.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Add Nodes"}),u.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Click or drag onto canvas"}),u.jsx("div",{className:"space-y-2",children:Vg.map(r=>{const s=Fg[r.color];return u.jsxs("div",{draggable:!0,onDragStart:i=>n(i,r),onClick:()=>o(r.type),className:`
                                flex items-center gap-3 p-3 rounded-lg border cursor-grab
                                transition-all duration-150
                                ${s.bg} ${s.border} ${s.hover}
                                active:scale-95 active:cursor-grabbing
                            `,children:[u.jsx("div",{className:`flex-shrink-0 ${s.text}`,children:r.icon}),u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsx("div",{className:`text-sm font-medium ${s.text}`,children:r.label}),u.jsx("div",{className:"text-xs text-gray-500 truncate",children:r.description})]}),u.jsx("svg",{className:`w-4 h-4 ${s.text} opacity-50`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})]},r.type)})}),u.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:u.jsx("p",{className:"text-xs text-gray-400",children:"Tip: Connect nodes by dragging from handles."})})]})}function Yg({node:e,onUpdate:t,onClose:n,onDelete:o}){const[r,s]=j.useState(e.data);j.useEffect(()=>{s(e.data)},[e.id,e.data]);const i=(x,w)=>{const g={...r,[x]:w};s(g),t(g)},a=(x,w,g)=>{const E={...r[x]||{},[w]:g};i(x,E)},c=()=>{const x=r;return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trigger Type"}),u.jsxs("select",{value:x.trigger_type||"",onChange:w=>i("trigger_type",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[u.jsx("option",{value:"",children:"Select trigger..."}),Object.entries(hi).map(([w,g])=>u.jsx("option",{value:w,children:g.label},w))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condition Logic"}),u.jsxs("select",{value:x.logic||"and",onChange:w=>i("logic",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[u.jsx("option",{value:"and",children:"ALL conditions must match (AND)"}),u.jsx("option",{value:"or",children:"ANY condition can match (OR)"})]})]}),u.jsx(Xg,{conditions:x.conditions||[],onChange:w=>i("conditions",w)})]})},l=()=>{const x=r;return u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-500",children:'Define when the workflow should take the "Yes" or "No" path.'}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field"}),u.jsx("input",{type:"text",value:x.field||"",onChange:w=>i("field",w.target.value),placeholder:"e.g., contact.gpa, metric.value",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operator"}),u.jsxs("select",{value:x.operator||"",onChange:w=>i("operator",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[u.jsx("option",{value:"",children:"Select operator..."}),Object.entries(gi).map(([w,g])=>u.jsx("option",{value:w,children:g},w))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Value"}),u.jsx("input",{type:"text",value:x.value!==void 0?String(x.value):"",onChange:w=>i("value",w.target.value),placeholder:"Comparison value",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})]})},d=()=>{const x=r;return u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Pause the workflow for a specified duration before continuing."}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),u.jsx("input",{type:"number",min:"1",value:x.duration||1,onChange:w=>i("duration",parseInt(w.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),u.jsxs("select",{value:x.unit||"hours",onChange:w=>i("unit",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[u.jsx("option",{value:"minutes",children:"Minutes"}),u.jsx("option",{value:"hours",children:"Hours"}),u.jsx("option",{value:"days",children:"Days"})]})]})]})]})},f=()=>{const x=r;return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Type"}),u.jsxs("select",{value:x.action_type||"",onChange:w=>i("action_type",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",children:[u.jsx("option",{value:"",children:"Select action..."}),Object.entries(kg).map(([w,g])=>u.jsx("option",{value:w,children:g.label},w))]})]}),x.action_type&&h(x)]})},h=x=>{const w=x.config||{};switch(x.action_type){case"send_email":case"send_sms":case"send_whatsapp":return u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recipients"}),u.jsx("input",{type:"text",value:(w.recipients||[]).join(", "),onChange:g=>a("config","recipients",g.target.value.split(",").map(y=>y.trim()).filter(Boolean)),placeholder:"Enter user IDs or roles, comma-separated",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Use: user IDs, role:admin, context:contact_id"})]}),x.action_type==="send_email"&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),u.jsx("input",{type:"text",value:w.subject||"",onChange:g=>a("config","subject",g.target.value),placeholder:"Email subject line",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),u.jsx("textarea",{value:w.message||w.body||"",onChange:g=>a("config",x.action_type==="send_email"?"body":"message",g.target.value),placeholder:"Message content. Use {{contact.name}} for variables.",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),u.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Variables: ","{{contact.name}}",", ","{{metric.value}}",", ","{{trigger.field}}"]})]})]});case"webhook":return u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"URL"}),u.jsx("input",{type:"url",value:w.url||"",onChange:g=>a("config","url",g.target.value),placeholder:"https://api.example.com/webhook",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Method"}),u.jsxs("select",{value:w.method||"POST",onChange:g=>a("config","method",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",children:[u.jsx("option",{value:"POST",children:"POST"}),u.jsx("option",{value:"PUT",children:"PUT"}),u.jsx("option",{value:"PATCH",children:"PATCH"})]})]})]});case"create_task":return u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title"}),u.jsx("input",{type:"text",value:w.title||"",onChange:g=>a("config","title",g.target.value),placeholder:"Follow up with {{contact.name}}",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),u.jsx("textarea",{value:w.description||"",onChange:g=>a("config","description",g.target.value),placeholder:"Task details...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assign To"}),u.jsx("input",{type:"text",value:w.assignee||"",onChange:g=>a("config","assignee",g.target.value),placeholder:"User ID or role",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]});case"in_app_notification":return u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Recipients"}),u.jsx("input",{type:"text",value:(w.recipients||[]).join(", "),onChange:g=>a("config","recipients",g.target.value.split(",").map(y=>y.trim()).filter(Boolean)),placeholder:"Enter user IDs or roles, comma-separated",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Use: user IDs, role:admin, context:contact_id"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),u.jsx("input",{type:"text",value:w.title||"",onChange:g=>a("config","title",g.target.value),placeholder:"{{contact.name}} needs attention",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),u.jsx("textarea",{value:w.message||"",onChange:g=>a("config","message",g.target.value),placeholder:"Notification message content...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),u.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Variables: ","{{contact.name}}",", ","{{metric.value}}"]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),u.jsxs("select",{value:w.priority||"normal",onChange:g=>a("config","priority",g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",children:[u.jsx("option",{value:"low",children:"Low"}),u.jsx("option",{value:"normal",children:"Normal"}),u.jsx("option",{value:"high",children:"High"}),u.jsx("option",{value:"urgent",children:"Urgent"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action URL (optional)"}),u.jsx("input",{type:"text",value:w.url||"",onChange:g=>a("config","url",g.target.value),placeholder:"/students/{{contact_id}}",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Deep link when notification is clicked"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Label (optional)"}),u.jsx("input",{type:"text",value:w.action_label||"",onChange:g=>a("config","action_label",g.target.value),placeholder:"View Details",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]});default:return u.jsx("p",{className:"text-sm text-gray-500 italic",children:"Configuration options will appear here based on the selected action type."})}},p=()=>{const w=r.branches||[{id:"1",label:"Path 1"},{id:"2",label:"Path 2"}];return u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-500",children:"Split the workflow into multiple parallel paths."}),u.jsx("div",{className:"space-y-3",children:w.map((g,y)=>u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:g.label||"",onChange:E=>{const _=[...w];_[y]={...g,label:E.target.value},i("branches",_)},placeholder:`Path ${y+1} label`,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-orange-500 focus:border-orange-500"}),w.length>2&&u.jsx("button",{onClick:()=>{const E=w.filter((_,k)=>k!==y);i("branches",E)},className:"px-2 text-gray-400 hover:text-red-500",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},g.id))}),w.length<5&&u.jsx("button",{onClick:()=>{const g={id:String(Date.now()),label:`Path ${w.length+1}`};i("branches",[...w,g])},className:"w-full px-3 py-2 border border-dashed border-gray-300 rounded-lg text-sm text-gray-500 hover:border-orange-400 hover:text-orange-600 transition-colors",children:"+ Add Branch"})]})},m=()=>{switch(e.type){case"trigger":return c();case"condition":return l();case"delay":return d();case"action":return f();case"branch":return p();default:return u.jsx("p",{className:"text-gray-500",children:"Unknown node type"})}},b=()=>{switch(e.type){case"trigger":return"Configure Trigger";case"condition":return"Configure Condition";case"delay":return"Configure Delay";case"action":return"Configure Action";case"branch":return"Configure Split";default:return"Node Configuration"}},v=()=>{switch(e.type){case"trigger":return"text-amber-600";case"condition":return"text-purple-600";case"delay":return"text-indigo-600";case"action":return"text-emerald-600";case"branch":return"text-orange-600";default:return"text-gray-600"}};return u.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg w-80 max-h-[calc(100vh-200px)] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[u.jsx("h3",{className:`font-semibold ${v()}`,children:b()}),u.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:m()}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50 rounded-b-xl",children:u.jsx("button",{onClick:o,className:"w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"Delete Node"})})]})}function Xg({conditions:e,onChange:t}){const n=()=>{t([...e,{field:"",operator:"equals",value:""}])},o=(s,i,a)=>{const c=[...e];c[s]={...c[s],[i]:a},t(c)},r=s=>{t(e.filter((i,a)=>a!==s))};return u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Conditions"}),e.length===0&&u.jsx("p",{className:"text-sm text-gray-400 italic",children:"No conditions set. Add one below."}),e.map((s,i)=>u.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg space-y-2",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["Condition ",i+1]}),u.jsx("button",{onClick:()=>r(i),className:"text-gray-400 hover:text-red-500",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("input",{type:"text",value:s.field,onChange:a=>o(i,"field",a.target.value),placeholder:"Field (e.g., contact.gpa)",className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded focus:ring-1 focus:ring-amber-500"}),u.jsx("select",{value:s.operator,onChange:a=>o(i,"operator",a.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded focus:ring-1 focus:ring-amber-500",children:Object.entries(gi).map(([a,c])=>u.jsx("option",{value:a,children:c},a))}),u.jsx("input",{type:"text",value:String(s.value),onChange:a=>o(i,"value",a.target.value),placeholder:"Value",className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded focus:ring-1 focus:ring-amber-500"})]},i)),u.jsx("button",{onClick:n,className:"w-full px-3 py-2 border border-dashed border-gray-300 rounded-lg text-sm text-gray-500 hover:border-amber-400 hover:text-amber-600 transition-colors",children:"+ Add Condition"})]})}const Zg={trigger:Ig,condition:$g,delay:Dg,action:Hg,branch:Og};function qg({workflowId:e,initialNodes:t,initialEdges:n,workflowName:o}){const[r,s,i]=Kh(t),[a,c,l]=Qh(n),[d,f]=j.useState(null),[h,p]=j.useState(!1),[m,b]=j.useState(null),v=j.useRef(null),x=j.useRef(null),{screenToFlowPosition:w}=an(),g=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";j.useEffect(()=>{console.log("[WorkflowCanvas] Component mounted - version 2026-01-30-v2")},[]),j.useEffect(()=>{const D=N=>{const{sourceNodeId:S,branchIndex:C,branchId:I,nodeType:M}=N.detail,$=r.find(V=>V.id===S);if(!$)return;const z=C===0?-100:C===1?100:0,R={x:$.position.x+z,y:$.position.y+200},H={id:`${M}-${Date.now()}`,type:M,position:R,data:_r(M)};s(V=>[...V,H]),c(V=>Dn({id:`e${S}-${H.id}`,source:S,...I!=="default"?{sourceHandle:I}:{},target:H.id,animated:!0},V)),f(H)};return window.addEventListener("addNodeFromBranch",D),()=>{window.removeEventListener("addNodeFromBranch",D)}},[r,s,c]),j.useEffect(()=>(v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{y()},2e3),()=>{v.current&&clearTimeout(v.current)}),[r,a]);const y=async()=>{if(e){p(!0);try{(await fetch(`/alerts/${e}/save`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":g,Accept:"application/json"},body:JSON.stringify({nodes:r,edges:a})})).ok?b(new Date):console.error("Failed to save workflow")}catch(D){console.error("Error saving workflow:",D)}finally{p(!1)}}},E=j.useCallback(D=>{c(N=>Dn({...D,animated:!0},N))},[c]),_=j.useCallback((D,N)=>{f(N)},[]),k=j.useCallback(()=>{f(null)},[]),P=j.useCallback((D,N)=>{s(S=>S.map(C=>C.id===D?{...C,data:{...C.data,...N}}:C))},[s]),T=j.useCallback((D,N)=>{const S={x:350,y:50+r.length*150},C={id:`${D}-${Date.now()}`,type:D,position:N||S,data:_r(D)};s(I=>[...I,C]),f(C)},[r.length,s]),B=j.useCallback(D=>{s(N=>N.filter(S=>S.id!==D)),c(N=>N.filter(S=>S.source!==D&&S.target!==D)),d?.id===D&&f(null)},[d,s,c]),A=j.useCallback(D=>{D.preventDefault(),D.dataTransfer.dropEffect="move"},[]),L=j.useCallback(D=>{D.preventDefault(),console.log("[WorkflowCanvas] Drop event received");const N=D.dataTransfer.getData("application/reactflow");if(console.log("[WorkflowCanvas] Node type from drop:",N),!N){console.log("[WorkflowCanvas] No type found, ignoring drop");return}const S=w({x:D.clientX,y:D.clientY});console.log("[WorkflowCanvas] Adding node at position:",S),T(N,S)},[T,w]);return u.jsxs("div",{className:"h-full w-full flex",style:{minHeight:"500px"},children:[u.jsx("div",{className:"w-64 bg-white border-r border-gray-200 flex-shrink-0 overflow-y-auto",children:u.jsx(Wg,{onAddNode:D=>T(D)})}),u.jsx("div",{ref:x,className:"flex-1",style:{height:"100%"},onDragOver:A,onDrop:L,children:u.jsxs(Gh,{nodes:r,edges:a,onNodesChange:i,onEdgesChange:l,onConnect:E,onNodeClick:_,onPaneClick:k,nodeTypes:Zg,defaultViewport:{x:0,y:0,zoom:1},snapToGrid:!0,snapGrid:[15,15],deleteKeyCode:["Backspace","Delete"],selectionKeyCode:null,multiSelectionKeyCode:["Shift"],defaultEdgeOptions:{animated:!0,style:{strokeWidth:2},deletable:!0},proOptions:{hideAttribution:!0},children:[u.jsx(ug,{}),u.jsx(_g,{nodeColor:D=>{switch(D.type){case"trigger":return"#F59E0B";case"condition":return"#8B5CF6";case"delay":return"#6366F1";case"action":return"#10B981";case"branch":return"#EC4899";default:return"#9CA3AF"}}}),u.jsx(og,{variant:_e.Dots,gap:15,size:1}),u.jsx(Ct,{position:"top-right",className:"bg-white rounded-lg shadow-sm border border-gray-200 px-3 py-2",children:u.jsx("div",{className:"flex items-center gap-2 text-sm",children:h?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),u.jsx("span",{className:"text-gray-600",children:"Saving..."})]}):m?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),u.jsxs("span",{className:"text-gray-600",children:["Saved ",m.toLocaleTimeString()]})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-full"}),u.jsx("span",{className:"text-gray-400",children:"Not saved"})]})})})]})}),d&&u.jsx("div",{className:"w-80 bg-white border-l border-gray-200 flex-shrink-0 overflow-y-auto",children:u.jsx(Yg,{node:d,onUpdate:D=>P(d.id,D),onDelete:()=>B(d.id),onClose:()=>f(null)})})]})}function _r(e){switch(e){case"trigger":return{trigger_type:"metric_threshold",conditions:[],logic:"and"};case"condition":return{conditions:[],logic:"and"};case"delay":return{duration:1,unit:"hours"};case"action":return{action_type:"send_sms",config:{recipients:[],message:""}};case"branch":return{branches:[{id:"1",name:"Yes",conditions:[],logic:"and"},{id:"2",name:"No",conditions:[],logic:"and",is_default:!0}]};default:return{}}}function Ug(e){return u.jsx(li,{children:u.jsx(qg,{...e})})}const Oe=document.getElementById("workflow-canvas");if(Oe){const e=Oe.dataset.workflowId||"",t=JSON.parse(Oe.dataset.nodes||"[]"),n=JSON.parse(Oe.dataset.edges||"[]"),o=Oe.dataset.workflowName||"New Workflow";ba.createRoot(Oe).render(u.jsx(Er.StrictMode,{children:u.jsx(Ug,{workflowId:e,initialNodes:t,initialEdges:n,workflowName:o})}))}
